# SOME DESCRIPTIVE TITLE
# Copyright (C) YEAR Free Software Foundation, Inc.
# This file is distributed under the same license as the PACKAGE package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr "Project-Id-Version: PACKAGE VERSION\nPOT-Creation-Date: 2021-02-04 15:40+0000\nPO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\nLast-Translator: FULL NAME <EMAIL@ADDRESS>\nLanguage-Team: LANGUAGE <LL@li.org>\nLanguage: \nMIME-Version: 1.0\nContent-Type: text/plain; charset=UTF-8\nContent-Transfer-Encoding: 8bit\n"

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:1
#, no-wrap
msgid "---\n"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:8
#, no-wrap
msgid "layout: post\ntitle: Biased locking removed from Java - does it affect you ?\ndate: 2020-09-30\ntags: help\nsynopsis: In Java 15 *biased locking* is now disabled by default and is planned to be removed in the Java Virtual Machine as per JEP 374. We need your help seeing if it affects Quarkus performance in your application.\nauthor: maxandersen\n---\n"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:11
msgid "Last week we became aware that the OpenJDK team in Java 15 have disabled *biased locking* (https://openjdk.java.net/jeps/374[JEP 374]) in the Java virtual machine. This is a change from previous versions and could *potentially* have a negative impact on Java application's performance."
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:13
msgid "Red Hat's own performance teams are currently running performance tests to see how it affects our Java middleware, but no amount of generic testing can reveal how this change affects real-world applications."
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:15
msgid "That is where you come in."
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:17
msgid "We would like to get info from you on whether your application performance is affected by biased locking or not."
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:19
msgid "To do so please try the following in your application performance tests:"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:21
msgid "Run your Quarkus application performance tests as you normally would with the following command line flags on Java 11 (jdk11u) and if feasible Java 15 (jdk15):"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:23
#, no-wrap
msgid "*enabled*: -XX:+UseBiasedLocking -XX:BiasedLockingStartupDelay=0\n"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:25
#, no-wrap
msgid "*disabled*: -XX:-UseBiasedLocking\n"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:27
msgid "We would like to know the result of this no matter if you see a regression or not on the same Java Virtual Machine."
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:29
msgid "If you are able then running it with the following scenarios would be of great help too:"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:31
msgid "single-threaded"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:32
msgid "thread count ~= hardware core count"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:33
msgid "thread count ~= N * hardware core count where 8 < N < 16"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:35
msgid "The intent of these are to see how the level of concurrency affects the result."
msgstr ""

#. type: Title ==
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:36
#, no-wrap
msgid "Reporting the result"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:39
msgid "Please https://github.com/quarkusio/quarkus/issues/new?assignees=&labels=kind%2Fbug&template=bug_report.md&title=%28jep374%29[open a bug] with `[jep374]` in the title + your project. i.e. `[jep374] results for acme project crazy panda` containing the following information per run in the description:"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:47
msgid "``` jvm used: jdk11 or jdk15 thread-count: 1..N (if you know)  hardware-core count: N (if you know)  performance test result: with biased locking performance test result: without biased locking ```"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:49
msgid "This will help us immensely. Thank you!"
msgstr ""

#. type: Title ==
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:50
#, no-wrap
msgid "Background"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:53
msgid "Below is some background context on biased locking - all optional reading - you don't need to understand the details to help us by running your performance tests and let us know if anything changes."
msgstr ""

#. type: Title ===
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:54
#, no-wrap
msgid "What is biased locking?"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:57
msgid "Biased locking lowers the cost of /uncontended/ synchronization."
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:60
#, no-wrap
msgid "*Without biased locking*: a thread needs to set and clear a lock bit\nwhen it performs repeated synchronizations on the same object. It also needs to wait for those set/clear writes to be drained to local cache before proceeding to execute further memory operations.\n"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:62
#, no-wrap
msgid "*With biased locking*: the first time a thread synchronizes on an object it does a bit more work to acquire synchronized ('bias' it to the thread). Subsequent syncrhonizations proceed via a simple read test with no need to  drain to cache.\n"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:65
msgid "Where's the trade off? Well, if a biased lock is contended then there is more work to do to bias and unbias the lock. However, it is known that many synchronized operations are uncontended."
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:71
msgid "Biasing can be big win when a potentially concurrent data structure is actually used sequentially. The case where it helps most is exemplified in the problem we already found in class `DataOutputStream`. Normally only one thread writes a `DataOutputStream` and it is often not read until the stream has been filled. All the same, every `putInt()` or `putLong()`` call invokes a syncrhonized method to increment the byte count by 4 or 8.  That's needed just in case some other thread might want to reliably locate the end of the valid buffer data but that rarely happens. So, the unbiased case suffers lock write and cache drain delays at every basic put operation."
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:73
msgid "A similar case occurs with class ByteOutput Stream. Method putByte is synchronized. So writing a single byte involves a lock and unlock. n.b. method putInt calls putByte 4 times, requiring 4 locks and unlocks. Method putLong calls it 8 times!"
msgstr ""

#. type: Title ===
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:74
#, no-wrap
msgid "Why is biased locking being removed?"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:78
msgid "The implementation of biased locking adds a great deal of complexity to the JVM and is understood by only a small subset of the most experienced engineers. The cost of maintaining it and designing around it is significantly slowing down progress on new features. It has been a long term goal to remove it if at all possible. Some OpenJDK contributors wanted to remove it right away in jdk15 others argue for a slower deprecation route in order to check that we could really dispense with it."
msgstr ""

#. type: Title ==
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:79
#, no-wrap
msgid "What happens next?"
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:82
msgid "We are collecting our own internal performance tests across multiple teams in Red Hat and will gather data from community reported tests too and see what the data indicates. At this stage we are making no assumption that the removal of biased locking will definitely make performance worse. We know that in some cases not having biased locks will improve performance. Our concern is to find cases, like the JDK examples above, where it might cause serious performance degradation and get an idea of how bad, and also how common, the worst cases might be."
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:84
msgid "Once processed we might reach out to those reporting scenarios with unexpected results and get more details."
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:87
msgid "Then we'll work with the larger OpenJDK community to aid in deciding if biased locking can be turned off completely or a longer graceful deprecation period is needed."
msgstr ""

#. type: Plain text
#: upstream/_posts/2020-09-30-biased-locking-help.adoc:88
msgid "In any case - Thank you for your help and interest in making Java better!"
msgstr ""
