(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7110],{4469:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/widget",function(){return t(9705)}])},9705:function(n,e,t){"use strict";t.r(e),t.d(e,{__N_SSP:function(){return V},default:function(){return K}});var o=t(8314),r=t(8450),i=t(8624),s=t.n(i),a=t(3205),c=t(1169),u=t(308),d=t(4595),l=t(5917),m=t(367),f=t(6753),p=t(4985),v=t(7405),h=t(6895),g=t(1147),b=t(54),y=t(6144),Z=t(7589),C=t(8353),N=t(5594),w=t(3139),k=t(4761),x=function(n){(0,C.Z)(t,n);var e=(0,w.Z)(t);function t(n,o,r){var i;return(0,y.Z)(this,t),(i=e.call(this,n)).status=o,i.data=r,i}return t}((0,N.Z)(Error));function S(n){return _.apply(this,arguments)}function _(){return(_=(0,c.Z)((function(n){var e,t,o,r,i;return(0,u.__generator)(this,(function(s){switch(s.label){case 0:return e=(0,v.Z)(n,2),t=e[0],o=e[1],[4,fetch(t,o)];case 1:return[4,(r=s.sent()).json()];case 2:if(i=s.sent(),!r.ok)throw new x((null===i||void 0===i?void 0:i.error)||r.statusText,r.status,i);return[2,i]}}))}))).apply(this,arguments)}function I(n){return Object.entries(n).reduce((function(n,e){var t=(0,v.Z)(e,2),r=t[0],i=t[1];return(0,k.xb)(i)?n:(0,p.Z)((0,o.Z)({},n),(0,Z.Z)({},r,i))}),{})}var R=t(8762),E=t(2646);function L(n,e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=(0,a.useState)(0),s=i[0],c=i[1],u=new URLSearchParams(I((0,o.Z)({},n,t))),d=(0,a.useMemo)((function(){return{headers:e?{Authorization:"Bearer ".concat(e)}:{}}}),[e]),l=function(e,r){if(0===t.first||0===t.last)return null;if(0===e)return["/api/discussions?".concat(u),d];if(!r.discussion.pageInfo.hasNextPage)return null;var i=new URLSearchParams(I((0,p.Z)((0,o.Z)({},n),{after:r.discussion.pageInfo.endCursor,before:t.before})));return["/api/discussions?".concat(i),d]},m=function(n){return![403,404,429].includes(n)},f=(0,b.ZP)(l,S,{onErrorRetry:function(n,e,t,o,r){m(null===n||void 0===n?void 0:n.status)&&g.J$.defaultValue.onErrorRetry(n,e,t,o,r)},revalidateFirstPage:r||E.E.revalidate_first_page,revalidateOnMount:m(s),revalidateOnFocus:m(s),revalidateOnReconnect:m(s)}),y=f.data,Z=f.size,C=f.setSize,N=f.error,w=f.mutate,k=f.isValidating;(null===N||void 0===N?void 0:N.status)&&N.status!==s?c(N.status):!(null===N||void 0===N?void 0:N.status)&&s&&c(0);var x=(0,a.useCallback)((function(n){var e;if(!y)return w();var t=y.slice(0,y.length-1),r=(0,v.Z)(y.slice(-1),1)[0];return w((0,h.Z)(t).concat([(0,p.Z)((0,o.Z)({},r),{discussion:(0,p.Z)((0,o.Z)({},r.discussion),{comments:(0,h.Z)((null===(e=r.discussion)||void 0===e?void 0:e.comments)||[]).concat([n])})})]),!1),w()}),[y,w]),_=(0,a.useCallback)((function(n){var e=y.map((function(e){return(0,p.Z)((0,o.Z)({},e),{discussion:(0,p.Z)((0,o.Z)({},e.discussion),{comments:e.discussion.comments.map((function(e){return e.id===n.replyToId?(0,p.Z)((0,o.Z)({},e),{replies:(0,h.Z)(e.replies).concat([n])}):e}))})})}));return w(e,!1),w()}),[y,w]),R=(0,a.useCallback)((function(n,e){return w(n,!e)&&(null===e||void 0===e?void 0:e.then((function(){return w()})))}),[w]),L=(0,a.useCallback)((function(n,e){return w(y.map((function(e){return(0,p.Z)((0,o.Z)({},e),{discussion:(0,p.Z)((0,o.Z)({},e.discussion),{comments:e.discussion.comments.map((function(e){return e.id===n.id?n:e}))})})})),!e)&&(null===e||void 0===e?void 0:e.then((function(){return w()})))}),[y,w]),B=(0,a.useCallback)((function(n,e){return w(y.map((function(e){return(0,p.Z)((0,o.Z)({},e),{discussion:(0,p.Z)((0,o.Z)({},e.discussion),{comments:e.discussion.comments.map((function(e){return e.id===n.replyToId?(0,p.Z)((0,o.Z)({},e),{replies:e.replies.map((function(e){return e.id===n.id?n:e}))}):e}))})})})),!e)&&(null===e||void 0===e?void 0:e.then((function(){return w()})))}),[y,w]);return{data:y,error:N,size:Z,setSize:C,isValidating:k,isLoading:!N&&!y,isError:!!N,mutators:{addNewComment:x,addNewReply:_,updateDiscussion:R,updateComment:L,updateReply:B,mutate:w}}}var B=t(5391),T=t(6105),A=t(6873),P=t(3494),M="\n  mutation($body: String!, $discussionId: ID!) {\n    addDiscussionComment(input: {body: $body, discussionId: $discussionId}) {\n      comment {\n        id\n        upvoteCount\n        viewerHasUpvoted\n        viewerCanUpvote\n        author {\n          avatarUrl\n          login\n          url\n        }\n        viewerDidAuthor\n        createdAt\n        url\n        authorAssociation\n        lastEditedAt\n        deletedAt\n        isMinimized\n        bodyHTML\n        reactionGroups {\n          content\n          users {\n            totalCount\n          }\n          viewerHasReacted\n        }\n        replies(first: 100) {\n          totalCount\n          nodes {\n            id\n            author {\n              avatarUrl\n              login\n              url\n            }\n            createdAt\n            url\n            authorAssociation\n            lastEditedAt\n            deletedAt\n            isMinimized\n            bodyHTML\n            reactionGroups {\n              content\n              users {\n                totalCount\n              }\n              viewerHasReacted\n            }\n          }\n        }\n      }\n    }\n  }";function O(){return(O=(0,c.Z)((function(n,e){return(0,u.__generator)(this,(function(t){return[2,fetch(P.Lp,{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({query:M,variables:n})}).then((function(n){return n.json()}))]}))}))).apply(this,arguments)}var D="\n  mutation($body: String!, $discussionId: ID!, $replyToId: ID!) {\n    addDiscussionReply: addDiscussionComment(input: {body: $body, discussionId: $discussionId, replyToId: $replyToId}) {\n      reply: comment {\n        id\n        author {\n          avatarUrl\n          login\n          url\n        }\n        viewerDidAuthor\n        createdAt\n        url\n        authorAssociation\n        lastEditedAt\n        deletedAt\n        isMinimized\n        bodyHTML\n        reactionGroups {\n          content\n          users {\n            totalCount\n          }\n          viewerHasReacted\n        }\n        replyTo {\n          id\n        }\n      }\n    }\n  }";function X(){return(X=(0,c.Z)((function(n,e){return(0,u.__generator)(this,(function(t){return[2,fetch(P.Lp,{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify({query:D,variables:n})}).then((function(n){return n.json()}))]}))}))).apply(this,arguments)}function z(){return(z=(0,c.Z)((function(n,e,t){return(0,u.__generator)(this,(function(r){return[2,fetch(P.Db,{method:"POST",headers:e?{Authorization:"token ".concat(e)}:{},body:JSON.stringify((0,o.Z)({mode:"gfm",text:n},t?{context:t}:{}))}).then((function(n){return n.text()}))]}))}))).apply(this,arguments)}function H(n){var e=n.discussionId,t=n.context,o=n.replyToId,i=n.className,s=void 0===i?"":i,d=n.onSubmit,f=n.onDiscussionCreateRequest,p=(0,m.$I)().t,v=(0,a.useState)(!1),h=v[0],g=v[1],b=(0,a.useState)(""),y=b[0],Z=b[1],C=(0,a.useState)(""),N=C[0],w=C[1],x=(0,a.useState)(""),S=x[0],_=x[1],I=(0,a.useState)(!1),R=I[0],E=I[1],L=(0,a.useState)(!1),B=L[0],P=L[1],M=(0,a.useState)(!1),D=M[0],H=M[1],j=(0,a.useState)(!1),U=j[0],$=j[1],G=(0,a.useState)(""),q=G[0],F=G[1],J=(0,a.useContext)(l.Vo),V=J.token,K=J.origin,W=J.getLoginUrl,Y=J.onSignOut,Q=(0,a.useRef)(null),nn=W(K),en=!!o,tn=p(en?"writeAReply":"writeAComment");(0,a.useEffect)((function(){h&&y!==N&&(y&&(E(!0),function(n,e,t){return z.apply(this,arguments)}(y,V,t).then((function(n){var e=(0,A.jd)(n);_(e),E(!1)}))),w(y))}),[h,y,N,V,t]);var on=(0,a.useCallback)((function(){Z(""),_(""),g(!1),P(!1),H(!1)}),[]),rn=(0,a.useCallback)((0,c.Z)((function(){var n,t;return(0,u.__generator)(this,(function(r){switch(r.label){case 0:return B||!e&&!f?[2]:(P(!0),e?(n=e,[3,3]):[3,1]);case 1:return[4,f()];case 2:n=r.sent(),r.label=3;case 3:return t={body:y,discussionId:n,replyToId:o},o?function(n,e){return X.apply(this,arguments)}(t,V).then((function(n){var e=n.data.addDiscussionReply.reply,t=(0,A.KF)(e);d(t),on()})):function(n,e){return O.apply(this,arguments)}(t,V).then((function(n){var e=n.data.addDiscussionComment.comment,t=(0,A.qw)(e);d(t),on()})),[2]}}))})),[B,e,y,o,f,V,d,on]),sn=(0,a.useCallback)((function(n){Z(n.target.value),q&&q!==Q.current.style.height||((0,k.p1)(Q.current),F(Q.current.style.height))}),[q]);return(0,a.useEffect)((function(){Q.current&&D&&Q.current.focus()}),[D]),!en||D?(0,r.BX)("form",{className:"color-bg-primary color-border-primary gsc-comment-box ".concat(en?"gsc-comment-box-is-reply":""," ").concat(s),onSubmit:function(n){n.preventDefault(),rn()},children:[(0,r.BX)("div",{className:"color-bg-tertiary color-border-primary gsc-comment-box-tabs",children:[(0,r.BX)("div",{className:"mx-2 mb-[-1px] mt-2",children:[(0,r.tZ)("button",{className:"rounded-t border border-b-0 px-4 py-2 ".concat(h?"color-text-secondary border-transparent":"color-text-primary color-bg-canvas color-border-primary"),onClick:function(){return g(!1)},type:"button",children:p("write")}),(0,r.tZ)("button",{className:"ml-1 rounded-t border border-b-0 px-4 py-2 ".concat(h?"color-text-primary color-bg-canvas color-border-primary":"color-text-secondary border-transparent"),onClick:function(){return g(!0)},type:"button",children:p("preview")})]}),h?null:(0,r.tZ)("div",{className:"gsc-comment-box-md-toolbar",children:(0,r.tZ)("button",{className:"gsc-toolbar-item",type:"button",title:p(U?"disableFixedWidth":"enableFixedWidth"),onClick:function(){$(!U),Q.current.focus()},tabIndex:-1,children:(0,r.tZ)(T.R1h,{})})})]}),(0,r.tZ)("div",{className:"gsc-comment-box-main",children:h?(0,r.tZ)("div",{className:"markdown color-border-primary gsc-comment-box-preview",dangerouslySetInnerHTML:R?void 0:{__html:S||p("nothingToPreview")},onClick:A.Cn,children:R?p("loadingPreview"):void 0}):(0,r.BX)("div",{className:"gsc-comment-box-write",children:[(0,r.tZ)("textarea",{className:"form-control input-contrast gsc-comment-box-textarea ".concat(U?"gsc-is-fixed-width":""),placeholder:V?tn:p("signInToComment"),onChange:sn,value:y,disabled:!V||B,ref:Q,onKeyDown:function(n){return(n.ctrlKey||n.metaKey)&&"Enter"===n.key&&rn()}}),(0,r.tZ)("div",{className:"form-control input-contrast gsc-comment-box-textarea-extras",children:(0,r.tZ)("a",{className:"link-secondary gsc-comment-box-markdown-hint flex gap-2",rel:"nofollow noopener noreferrer",target:"_blank",href:"https://guides.github.com/features/mastering-markdown/",title:p("stylingWithMarkdownIsSupported"),children:(0,r.tZ)(T.BuP,{className:"mr-1"})})})]})}),(0,r.BX)("div",{className:"gsc-comment-box-bottom",children:[V&&!en?(0,r.BX)("button",{type:"button",className:"link-secondary text-sm",onClick:Y,children:[(0,r.tZ)(T.E2Z,{className:"mr-2"}),p("signOut")]}):null,(0,r.BX)("div",{className:"gsc-comment-box-buttons",children:[en?(0,r.tZ)("button",{className:"btn ml-1 rounded-md border",onClick:function(){return H(!1)},type:"button",children:p("cancel")}):null,V?(0,r.tZ)("button",{className:"btn btn-primary items-center ml-1 rounded-md border",type:"submit",disabled:V&&!y.trim()||B,children:p(en?"reply":"comment")}):(0,r.BX)("a",{className:"btn btn-primary inline-flex items-center ml-1 rounded-md border hover:no-underline",target:"_top",href:nn,children:[(0,r.tZ)(T.g_Y,{className:"mr-2",fill:"currentColor"})," ",p("signInWithGitHub")]})]})]})]}):(0,r.tZ)("div",{className:"color-bg-tertiary gsc-reply-box",children:(0,r.tZ)("button",{className:"form-control color-text-secondary color-border-primary w-full cursor-text rounded border px-2 py-1 text-left focus:border-transparent",onClick:function(){H(!0)},type:"button",children:p("writeAReply")})})}var j=t(4457);function U(n){var e,i=n.onDiscussionCreateRequest,s=n.onError,v=(0,a.useContext)(l.Vo),h=v.token,g=v.origin,b=(0,m.$I)().t,y=(0,a.useContext)(l.E_),Z=y.repo,C=y.term,N=y.number,w=y.category,k=y.strict,x=y.reactionsEnabled,S=y.emitMetadata,_=y.inputPosition,I=y.defaultCommentOrder,E=(0,a.useState)(I),T=E[0],A=E[1],P=function(n,e){var t,r,i,s,c,u,d,l,m,f,v,h,g,b,y,Z,C,N,w=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"oldest",k=L(n,e,{last:15},!0),x=k.data,S=k.isLoading,_=k.mutators,I=k.error,E=x&&x[x.length-1],B=null===E||void 0===E||null===(t=E.discussion)||void 0===t||null===(r=t.comments)||void 0===r||null===(i=r[0])||void 0===i?void 0:i.id,T=L(n,e,{first:15}),A=T.data,P=T.isLoading,M=T.size,O=T.setSize,D=T.error,X=null===A||void 0===A?void 0:A.map((function(n){var e,t,r,i=!1,s=(0,p.Z)((0,o.Z)({},n),{discussion:(0,p.Z)((0,o.Z)({},null===n||void 0===n?void 0:n.discussion),{comments:null===n||void 0===n||null===(e=n.discussion)||void 0===e||null===(t=e.comments)||void 0===t?void 0:t.filter((function(n){return n.id===B&&(i=!0),!i}))})});return s.discussion.totalReplyCount=null===(r=s.discussion.comments)||void 0===r?void 0:r.reduce((function(n,e){return n+e.replyCount}),0),s})),z=(null===E||void 0===E||null===(s=E.discussion)||void 0===s?void 0:s.comments)||[],H=(null===X||void 0===X?void 0:X.flatMap((function(n){var e;return(null===n||void 0===n||null===(e=n.discussion)||void 0===e?void 0:e.comments)||[]})))||[],j=k.mutators,U=T.mutators;if("newest"===w){var $=H;H=z.slice().reverse(),z=$.slice().reverse(),U=k.mutators,j=T.mutators}var G=_.addNewComment,q=(0,a.useCallback)((function(n,e){return E?_.updateDiscussion([(0,R.aT)(E,n)],e):e.then((function(){return _.mutate()}))}),[E,_]),F=(0,a.useCallback)((function(){return O(M+1)}),[O,M]),J=(null===E||void 0===E||null===(c=E.discussion)||void 0===c?void 0:c.totalCommentCount)-(null===E||void 0===E||null===(u=E.discussion)||void 0===u||null===(d=u.comments)||void 0===d?void 0:d.length)-(null===X||void 0===X?void 0:X.reduce((function(n,e){var t;return n+(null===(t=e.discussion.comments)||void 0===t?void 0:t.length)}),0)),V=null===E||void 0===E||null===(l=E.discussion)||void 0===l?void 0:l.reactionCount,K=null===E||void 0===E||null===(m=E.discussion)||void 0===m?void 0:m.totalCommentCount,W=((null===E||void 0===E||null===(f=E.discussion)||void 0===f?void 0:f.totalReplyCount)||0)+((null===X||void 0===X?void 0:X.reduce((function(n,e){return n+e.discussion.totalReplyCount}),0))||0),Y=D||I,Q=(null===E||void 0===E||null===(v=E.discussion)||void 0===v||null===(h=v.pageInfo)||void 0===h?void 0:h.hasPreviousPage)&&P||S,nn=P||M>0&&!(null===X||void 0===X?void 0:X[M-1]),en=404===(null===Y||void 0===Y?void 0:Y.status),tn=429===(null===Y||void 0===Y?void 0:Y.status),on=null===E||void 0===E||null===(g=E.discussion)||void 0===g?void 0:g.locked,rn={id:null===E||void 0===E||null===(b=E.discussion)||void 0===b?void 0:b.id,url:null===E||void 0===E||null===(y=E.discussion)||void 0===y?void 0:y.url,locked:null===E||void 0===E||null===(Z=E.discussion)||void 0===Z?void 0:Z.locked,reactions:null===E||void 0===E||null===(C=E.discussion)||void 0===C?void 0:C.reactions,repository:null===E||void 0===E||null===(N=E.discussion)||void 0===N?void 0:N.repository,reactionCount:V,totalCommentCount:K,totalReplyCount:W},sn=null===E||void 0===E?void 0:E.viewer;return{addNewComment:G,updateReactions:q,increaseSize:F,frontData:X,frontComments:H,frontMutators:U,backData:E,backComments:z,backMutators:j,numHidden:J,reactionCount:V,totalCommentCount:K,totalReplyCount:W,error:Y,isLoading:Q,isLoadingMore:nn,isNotFound:en,isRateLimited:tn,isLocked:on,discussion:rn,viewer:sn}}({repo:Z,term:C,category:w,number:N,strict:k},h,T),M=P.addNewComment,O=P.updateReactions,D=P.increaseSize,X=P.backMutators,z=P.frontMutators,U=(0,d.Z)(P,["addNewComment","updateReactions","increaseSize","backMutators","frontMutators"]);(0,a.useEffect)((function(){var n;U.error&&s&&s(null===(n=U.error)||void 0===n?void 0:n.message)}),[U.error,s]),(0,a.useEffect)((function(){if(S&&U.discussion.id){var n={discussion:U.discussion,viewer:U.viewer};(0,f.A)(n,g)}}),[U.discussion,U.viewer,S,g]),(0,a.useEffect)((function(){t.e(2429).then(t.bind(t,2429))}),[]);var $=function(){var n=(0,c.Z)((function(){var n;return(0,u.__generator)(this,(function(e){switch(e.label){case 0:return[4,i()];case 1:return n=e.sent(),z.mutate(),X.mutate(),[2,n]}}))}));return function(){return n.apply(this,arguments)}}(),G=(0,r.tZ)(H,{discussionId:U.discussion.id,context:Z,onSubmit:M,onDiscussionCreateRequest:$}),q=U.isNotFound&&!N,F=!!U.discussion.url,J=!U.error&&!U.isNotFound&&!U.isLoading&&U.totalReplyCount>0,V=U.isRateLimited&&!h||!U.isLoading&&!U.isLocked&&(!U.error||U.isNotFound&&!N);return U.isLoading?(0,r.BX)("div",{className:"gsc-loading",children:[(0,r.tZ)("div",{className:"gsc-loading-image"}),(0,r.tZ)("span",{className:"gsc-loading-text color-fg-muted",children:b("loadingComments")})]}):(0,r.BX)("div",{className:"color-text-primary gsc-main",children:[!x||U.isLoading||!q&&U.error?null:(0,r.BX)("div",{className:"gsc-reactions",children:[(0,r.tZ)("h4",{className:"gsc-reactions-count",children:q&&!U.reactionCount?b("reactions",{count:0}):(0,r.tZ)("a",{href:U.discussion.url,target:"_blank",rel:"noreferrer noopener nofollow",className:"color-text-primary",children:b("reactions",{count:U.reactionCount||0})})}),(0,r.tZ)("div",{className:"flex flex-auto items-center justify-center gap-2 text-sm mt-2",children:(0,r.tZ)(j.Z,{subjectId:U.discussion.id,reactionGroups:U.discussion.reactions,onReact:O,onDiscussionCreateRequest:$})})]}),(0,r.BX)("div",{className:"gsc-comments",children:[(0,r.BX)("div",{className:"gsc-header",children:[(0,r.BX)("div",{className:"gsc-left-header",children:[(0,r.tZ)("h4",{className:"gsc-comments-count",children:q&&!U.totalCommentCount?b("comments",{count:0}):U.error&&!U.backData?b("genericError",{message:(null===(e=U.error)||void 0===e?void 0:e.message)||""}):(0,r.tZ)("a",{href:U.discussion.url,target:"_blank",rel:"noreferrer noopener nofollow",className:"color-text-primary",children:b("comments",{count:U.totalCommentCount})})}),J?(0,r.BX)(r.HY,{children:[(0,r.tZ)("h4",{className:"gsc-comments-count-separator",children:"\xb7"}),(0,r.tZ)("h4",{className:"gsc-replies-count",children:b("replies",{count:U.totalReplyCount,plus:U.numHidden>0?"+":""})})]}):null,F?(0,r.tZ)("em",{className:"color-text-secondary text-sm",children:(0,r.tZ)(m.cC,{i18nKey:"common:poweredBy",components:{a:(0,r.tZ)("a",{href:"https://giscus.app",target:"_blank",rel:"noreferrer noopener nofollow",className:"link-secondary"})}})}):null]}),U.totalCommentCount>0?(0,r.BX)("ul",{className:"gsc-right-header BtnGroup",children:[(0,r.tZ)("li",{className:"BtnGroup-item ".concat("oldest"===T?"BtnGroup-item--selected":""),"aria-current":"oldest"===T,children:(0,r.tZ)("button",{className:"btn",onClick:function(){return A("oldest")},children:b("oldest")})}),(0,r.tZ)("li",{className:"BtnGroup-item ".concat("newest"===T?"BtnGroup-item--selected":""),"aria-current":"newest"===T,children:(0,r.tZ)("button",{className:"btn",onClick:function(){return A("newest")},children:b("newest")})})]}):null]}),V&&"top"===_?G:null,(0,r.BX)("div",{className:"gsc-timeline ".concat(0===U.totalCommentCount?"hidden":""),children:[U.isLoading?null:U.frontComments.map((function(n){return(0,r.tZ)(B.Z,{comment:n,replyBox:h&&!U.isLocked?(0,r.tZ)(H,{discussionId:U.discussion.id,context:Z,onSubmit:z.addNewReply,replyToId:n.id}):void 0,onCommentUpdate:z.updateComment,onReplyUpdate:z.updateReply},n.id)})),U.numHidden>0?(0,r.tZ)("div",{className:"pagination-loader-container gsc-pagination",children:(0,r.BX)("button",{className:"gsc-pagination-button color-border-primary",onClick:D,disabled:U.isLoadingMore,children:[(0,r.tZ)("span",{className:"color-text-secondary",children:b("hiddenItems",{count:U.numHidden})}),(0,r.BX)("span",{className:"color-text-link font-semibold",children:[U.isLoadingMore?b("loading"):b("loadMore"),"\u2026"]})]})}):null,U.isLoading?null:U.backComments.map((function(n){return(0,r.tZ)(B.Z,{comment:n,replyBox:h&&!U.isLocked?(0,r.tZ)(H,{discussionId:U.discussion.id,context:Z,onSubmit:X.addNewReply,replyToId:n.id}):void 0,onCommentUpdate:X.updateComment,onReplyUpdate:X.updateReply},n.id)}))]}),V&&"top"!==_?G:null]})]})}function $(){return($=(0,c.Z)((function(n,e){return(0,u.__generator)(this,(function(t){switch(t.label){case 0:return[4,fetch("/api/discussions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({repo:n,input:e})}).then((function(n){return n.json()}))];case 1:return[2,t.sent().id]}}))}))).apply(this,arguments)}function G(){return(G=(0,c.Z)((function(n){var e,t;return(0,u.__generator)(this,(function(o){switch(o.label){case 0:return[4,fetch("/api/oauth/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session:n})}).then((function(n){return n.json()}))];case 1:if("error"in(e=o.sent()))throw new Error(e.error);if(!(t=e.token))throw new Error("Unable to retrieve token.");return[2,t]}}))}))).apply(this,arguments)}function q(n){var e=n.origin,t=n.session,o=(0,a.useState)(""),i=o[0],s=o[1],d=(0,a.useState)(),m=d[0],p=d[1],v=(0,a.useContext)(l.E_),h=v.repo,g=v.repoId,b=v.categoryId,y=v.description,Z=v.backLink,C=v.term,N=v.number,w=function(){var n=(0,c.Z)((function(){var n;return(0,u.__generator)(this,(function(t){return m?[2,m]:(n=function(n,e){return $.apply(this,arguments)}(h,{repositoryId:g,categoryId:b,title:C,body:"# ".concat(C,"\n\n").concat(y||"","\n\n").concat((0,k.dd)(Z||e))}),p(n),[2,n])}))}));return function(){return n.apply(this,arguments)}}(),x=(0,a.useCallback)((function(n){(0,f.A)({error:n},e)}),[e]),S=(0,a.useCallback)((function(){(0,f.A)({signOut:!0,error:"State has expired (user signed out)."},e)}),[e]);return(0,a.useEffect)((function(){t&&!i&&function(n){return G.apply(this,arguments)}(t).then(s).catch((function(n){return x(null===n||void 0===n?void 0:n.message)}))}),[x,t,i]),(0,a.useEffect)((function(){var n=new ResizeObserver((function(n){var t=n[0];t&&(0,f.A)({resizeHeight:t.contentRect.height},e)}));return n.observe(document.querySelector("body")),function(){return n.disconnect()}}),[e]),(!t||i)&&h&&(C||N)?(0,r.tZ)(l.Vo.Provider,{value:{token:i,origin:e,getLoginUrl:l.Zd,onSignOut:S},children:(0,r.tZ)(U,{onDiscussionCreateRequest:w,onError:x})}):null}var F=t(614),J=t.n(F),V=!0;function K(n){var e=n.origin,t=n.session,i=n.repo,c=n.term,u=n.number,d=n.category,f=n.strict,p=n.repoId,v=n.categoryId,h=n.description,g=n.reactionsEnabled,b=n.emitMetadata,y=n.inputPosition,Z=n.defaultCommentOrder,C=n.theme,N=n.originHost,w=n.backLink,k=e||("undefined"===typeof location?"":location.href),x=(0,a.useContext)(l.Ni),S=x.theme,_=x.setTheme,I=(0,a.useState)({repo:i,repoId:p,category:d,categoryId:v,description:h,backLink:w,term:c,number:u,strict:f,reactionsEnabled:g,emitMetadata:b,inputPosition:y,defaultCommentOrder:Z}),R=I[0],E=I[1];return(0,a.useEffect)((function(){var n=function(n){if(n.origin===N&&"object"===typeof n.data&&n.data.giscus){var e=n.data.giscus;if("setConfig"in e){var t=e.setConfig;"theme"in t&&(_(t.theme),delete t.theme),J().isReady&&t.lang in m.mT&&(J().replace(J().asPath,J().asPath,{locale:t.lang,scroll:!1}),delete t.lang),E((function(n){return(0,o.Z)({},n,t)}))}}};return window.addEventListener("message",n),function(){return window.removeEventListener("message",n)}}),[N,_]),(0,a.useEffect)((function(){return _(C)}),[_,C]),(0,r.BX)(r.HY,{children:[(0,r.BX)(s(),{children:[(0,r.tZ)("base",{target:"_top"}),(0,r.tZ)("title",{children:"giscus"})]}),(0,r.tZ)("main",{className:"w-full mx-auto","data-theme":S,children:(0,r.tZ)(l.E_.Provider,{value:R,children:(0,r.tZ)(q,{origin:k,session:t})})})]})}}},function(n){n.O(0,[9547,3871,4947,9774,2888,179],(function(){return e=4469,n(n.s=e);var e}));var e=n.O();_N_E=e}]);