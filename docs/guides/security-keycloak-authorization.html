<!DOCTYPE html>
<html lang="ja">







<head>
  <title>OpenID Connect (OIDC) と Keycloak を使用して認証を一元化する - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://analytics.ossupstream.org/ https://search.quarkus.io https://smetrics.redhat.com https://ajax.googleapis.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://analytics.ossupstream.org/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://player.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />

  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/guides/security-keycloak-authorization" />
  <meta property="og:title" content="OpenID Connect (OIDC) と Keycloak を使用して認証を一元化する" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/security-keycloak-authorization">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="guides">

  


<div class="grid-wrapper communitysite">
  <div class="grid__item width-12-12">The <a href="https://quarkus.io/guides/security-keycloak-authorization">English version of quarkus.io</a> is the official project site. Translated sites are community supported on a best-effort basis.</div>
</div>


  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox"> <i class="fa fa-bars"></i>
</label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="#">Why<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">QUARKUSとは何か?</a></li>
          <li><a href="/developer-joy" class="">開発者満足</a></li>
          <li><a href="/performance" class="">パフォーマンス</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">標準</a></li>
          <li><a href="/versatility" class="">多用途性</a></li>
          <li><a href="/container-first" class="">コンテナ・ファースト</a></li>
          <li><a href="/spring" class="">USING SPRING?</a></li>
          <li class="tertiarydropdown">
            <span href="#">AI<i class="fas fa-chevron-down"></i></span>
            <ul class="tertiarymenu">
              <li><a href="/ai" class="">AI OVERVIEW</a></li>
              <li><a href="/java-for-ai" class="">JAVA FOR AI</a></li>
              <li><a href="/quarkus-for-ai" class="">WHY QUARKUS FOR AI</a></li>
              <li><a href="/ai-blueprints" class="">AI BLUEPRINTS</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="#">Learn<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">入門</a></li>
          <li><a href="/guides" class="active">ドキュメント</a></li>
          <li><a href="/userstories/" class="">ユーザーストーリー</a></li>  
          <li><a href="/qtips" class="">"Q" Tipsビデオ</a></li>          
          <li><a href="/books" class="">書籍</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="#">Extensions<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
<li><a href="https://quarkus.io/extensions/" class="">エクステンションを探す</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">エクステンションの使用</a></li>
          <li><a href="/guides/writing-extensions" class="">エクステンションの作成</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">エクステンションの共有</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="#">Community<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">サポート</a></li>
          <li><a href="/blog" class="">ブログ</a></li>
          <li><a href="/discussion" class="">ディスカッション</a></li>
          <li><a href="/working-groups" class="">ワーキンググループ</a></li>
          <li><a href="/insights" class="">ポッドキャスト</a></li>
          <li><a href="/events" class="">イベント</a></li>
          <li><a href="/newsletter" class="">ニュースレター</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ロードマップ</a></li>
          <li><a href="/benefactors" class="">BENEFACTORS</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary
white">コーディングを開始</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/guides/security-keycloak-authorization" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/guides/security-keycloak-authorization">ポルトガル（BR）</a></li>
          <li><a href="https://es.quarkus.io/guides/security-keycloak-authorization">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/guides/security-keycloak-authorization">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/guides/security-keycloak-authorization">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas
fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    







<section class="full-width-version-bg flexfilterbar guides">
  <div class="guideflexcontainer">
    <div class="docslink">
      <a class="returnlink" href="/guides/"> Back to Guides</a>
    </div>
    <div class="flexlabel">
      <label>バージョン:</label>
    </div>
    <div class="guidepulldown version">
    <select id="guide-version-dropdown">
      
        
        
        <option value="main" >Main - SNAPSHOT</option>
        
        
        
        <option value="latest" selected>3.31.3 - Latest</option>
        
        
        
        <option value="3.27" >3.27</option>
        
        
        
        <option value="3.20" >3.20</option>
        
        
        
        <option value="3.15" >3.15</option>
        
        
        
        <option value="3.8" >3.8</option>
        </select>
    </div>
  </div>
</section>

<div class="guide">
  <div class="grid-wrapper">
    <div class="grid__item width-8-12 width-12-12-m">
      
      <a class="editlink" href="https://github.com/quarkusio/quarkus/edit/main/docs/src/main/asciidoc/security-keycloak-authorization.adoc">このページを編集</a>
      
      <h1 class="text-caps">OpenID Connect (OIDC) と Keycloak を使用して認証を一元化する </h1>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>保護されたリソースへ安全にアクセスするために、<a href="https://www.keycloak.org/docs/latest/authorization_services/index.html">Keycloak Authorization Services</a> を使用して、Quarkus アプリケーションでベアラートークン認可を有効にする方法を説明します。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a>概要</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Keycloak Authorization エクステンション の <code>quarkus-keycloak-authorization</code> は、OpenID Connect エクステンションの <code>quarkus-oidc</code> を拡張して、高度な認可機能を提供します。
これには、保護されたリソースへのアクセスを動的に管理するポリシーエンフォーサーが備わっています。
アクセスは Keycloak で定義された権限によって管理され、柔軟で動的なリソースベースのアクセス制御 (RBAC) をサポートします。</p>
</div>
<div class="paragraph">
<p>Keycloak を使用しており、認可判断を処理するために環境で Keycloak 認可サービス機能が有効になっている場合にのみ、<code>quarkus-keycloak-authorization</code> エクステンションを使用してください。</p>
</div>
<div class="paragraph">
<p>Keycloakを使用していない場合、またはKeycloak 認可サービス機能を使用せずにKeycloakが設定されている場合は、代わりに <code>quarkus-oidc</code> エクステンションを使用してください。</p>
</div>
<div class="paragraph">
<div class="title">動作原理</div>
<p><code>quarkus-keycloak-authorization</code> エクステンションは、Keycloak の認可責任を一元化し、セキュリティーを強化して、アプリケーションのメンテナンスを簡素化します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ベアラートークンを検証するために <code>quarkus-oidc</code> エクステンションを使用します。</p>
</li>
<li>
<p>検証されたトークンを Keycloak Authorization Services に送信します。</p>
</li>
<li>
<p>これにより、Keycloak はリソース名、識別子、URI などの属性を使用して、リソースベースの権限を動的に評価できるようになります。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>認可決定を外部化することで、次のことが可能になります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>アプリケーションコードを変更せずに、多様なアクセス制御ストラテジーを実装できます。</p>
</li>
<li>
<p>セキュリティー要件が進化するにつれ、再デプロイの必要性を軽減できます。</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">互換性</div>
<p>このエクステンションは、Quarkus <a href="security-oidc-bearer-token-authentication">OIDC サービスアプリケーション</a> とのみ互換性があります。
ロールベースのアクセス制御などの明示的なメカニズムを動的認可ポリシーで補完します。</p>
</div>
<div class="ulist">
<div class="title">主な特長</div>
<ul>
<li>
<p><strong>集中管理</strong>: アプリケーション間で一貫したセキュリティーポリシーを実現するために、認可の決定を Keycloak に委譲します。</p>
</li>
<li>
<p><strong>動的権限</strong>: リソース属性を使用してアクセス制御を動的に定義します。</p>
</li>
<li>
<p><strong>メンテナンスの簡素化</strong>: アクセスポリシーが変更されたときにアプリケーションを更新して再デプロイする必要性を軽減します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">セットアップ</div>
<p>このエクステンションを使用する前に、次の点を確認してください。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Keycloak認可サービス機能がKeycloakインスタンスで有効になっています。</p>
</li>
<li>
<p>Quarkus アプリケーションに <code>quarkus-keycloak-authorization</code> エクステンションが含まれている。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>詳細な手順については、<a href="security-oidc-bearer-token-authentication">OIDC ベアラートークン認証</a> ガイドを参照してください。</p>
</div>
<div class="paragraph">
<div class="title">関連情報</div>
<p>Keycloak Authorization Services とポリシーエンフォーサーの詳細は、公式ドキュメントを参照してください: 
<a href="https://www.keycloak.org/docs/latest/authorization_services/index.html#_enforcer_overview">Keycloak Authorization Services ドキュメント</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>要件</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このガイドを完成させるには、以下が必要です:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>約15分</p>
</li>
<li>
<p>IDE</p>
</li>
<li>
<p>JDK 17+がインストールされ、 <code>JAVA_HOME</code> が適切に設定されていること</p>
</li>
<li>
<p>Apache Maven 3.9.12</p>
</li>
<li>
<p>動作するコンテナランタイム(Docker, <a href="podman">Podman</a>)</p>
</li>
<li>
<p>使用したい場合は、 <a href="cli-tooling.html">Quarkus CLI</a></p>
</li>
<li>
<p>ネイティブ実行可能ファイルをビルドしたい場合、MandrelまたはGraalVM（あるいはネイティブなコンテナビルドを使用する場合はDocker）をインストールし、 <a href="building-native-image.html#configuring-graalvm">適切に設定</a>していること</p>
</li>
<li>
<p><a href="https://stedolan.github.io/jq/">jq tool</a></p>
</li>
<li>
<p><a href="https://www.keycloak.org">Keycloak</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="architecture"><a class="anchor" href="#architecture"></a>アーキテクチャー</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この例では、2 つの保護されたエンドポイントを持つ単純なマイクロサービスのセットアップを示します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/api/users/me</code></p>
</li>
<li>
<p><code>/api/admin</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">トークンベースのアクセス制御</div>
<p>これらのエンドポイントへのアクセスは、ベアラートークンを使用して制御されます。
アクセスするには、次の条件を満たす必要があります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>有効なトークン</strong>: トークンには正しい署名、適切な有効期限、適切な対象者が設定されている必要があります。</p>
</li>
<li>
<p><strong>信頼</strong>: マイクロサービスは発行元の Keycloak サーバーを信頼する必要があります。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Keycloak サーバーによって発行されるベアラートークンは、以下の役割を果たします。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ユーザー識別子</strong>: トークンが発行された対象 (ユーザー) を示します。</p>
</li>
<li>
<p><strong>クライアント参照</strong>: OAuth 2.0 Authorization Server 標準に従って、ユーザーに代わって動作するクライアントアプリケーションを識別します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">エンドポイントとアクセスポリシー</div>
<p><code>/api/users/me</code> の場合: </p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>アクセスポリシー</strong>: 有効なベアラートークンと <code>user</code> ロールを持つユーザーに適用されます。</p>
</li>
<li>
<p><strong>レスポンス</strong>: トークンから派生した JSON オブジェクトとしてユーザーの詳細を返します。</p>
<div class="listingblock">
<div class="title">応答の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "user": {
    "id": "1234",
    "username": "johndoe",
    "email": "johndoe@example.com"
  }
}</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>/api/admin</code> の場合: </p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>アクセスポリシー</strong>: 有効なベアラートークンと <code>admin</code> ロールを持つユーザーに制限されます。</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">分離された認可</div>
<p>この例では、リソースを保護するためのロールベースのアクセス制御 (RBAC) ポリシーの使用について説明します。
主なポイントは次のとおりです。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>ポリシーの柔軟性</strong>: Keycloak は、属性ベースやカスタムポリシーなど、さまざまなポリシータイプをサポートしており、きめ細かい制御が可能です。</p>
</li>
<li>
<p><strong>分離されたアプリケーションロジック</strong>: 認可ポリシーは Keycloak によって完全に管理されるため、アプリケーションはコア機能に集中できます。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="solution"><a class="anchor" href="#solution"></a>ソリューション</h2>
<div class="sectionbody">
<div class="paragraph">
<p>次の章で紹介する手順に沿って、ステップを踏んでアプリケーションを作成することを推奨します。
ただし、完成した例にそのまま進むこともできます。</p>
</div>
<div class="paragraph">
<p><code>git clone <a href="https://github.com/quarkusio/quarkus-quickstarts.git" class="bare">https://github.com/quarkusio/quarkus-quickstarts.git</a></code> で Git リポジトリーをクローンします。または、https://github.com/quarkusio/quarkus-quickstarts/archive/main.zip[アーカイブ] をダウンロードします。</p>
</div>
<div class="paragraph">
<p>解決策は <code>security-keycloak-authorization-quickstart</code> <a href="https://github.com/quarkusio/quarkus-quickstarts/tree/main/security-keycloak-authorization-quickstart">ディレクトリー</a> にあります。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-the-project"><a class="anchor" href="#creating-the-project"></a>プロジェクトの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>最初に、次のコマンドを使用して新しいプロジェクトを作成します。</p>
</div>
<div class="sidebarblock primary asciidoc-tabs-sync-cli">
<div class="content">
<div class="title">コマンドラインインタフェース</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus create app org.acme:security-keycloak-authorization-quickstart \
    --extension='oidc,keycloak-authorization,rest-jackson' \
    --no-code
cd security-keycloak-authorization-quickstart</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradleプロジェクトを作成するには、 <code>--gradle</code> または <code>--gradle-kotlin-dsl</code> オプションを追加します。</p>
</div>
<div class="paragraph">
<p>Quarkus CLIのインストールと使用方法の詳細については、 <a href="cli-tooling">Quarkus CLI</a> ガイドを参照してください。</p>
</div>
</div>
</div>
<div class="sidebarblock secondary asciidoc-tabs-sync-maven">
<div class="content">
<div class="title">Maven</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn io.quarkus.platform:quarkus-maven-plugin:3.31.3:create \
    -DprojectGroupId=org.acme \
    -DprojectArtifactId=security-keycloak-authorization-quickstart \
    -Dextensions='oidc,keycloak-authorization,rest-jackson' \
    -DnoCode
cd security-keycloak-authorization-quickstart</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradleプロジェクトを作成するには、 <code>-DbuildTool=gradle</code> または <code>-DbuildTool=gradle-kotlin-dsl</code> オプションを追加します。</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Windowsユーザーの場合:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cmdを使用する場合、（バックスラッシュ <code>\</code> を使用せず、すべてを同じ行に書かないでください）。</p>
</li>
<li>
<p>Powershellを使用する場合は、 <code>-D</code> パラメータを二重引用符で囲んでください。例: <code>"-DprojectArtifactId=security-keycloak-authorization-quickstart"</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>このコマンドは、 <code>keycloak-authorization</code> エクステンションを持つ新しいプロジェクトを生成します。
このエクステンションは、Keycloak アダプターを Quarkus アプリケーションに統合し、Keycloak サーバーと対話してベアラートークンの認可を実行するために必要な機能を提供します。</p>
</div>
<div class="paragraph">
<div class="title">既存のプロジェクトにエクステンションを追加する</div>
<p>既存の Quarkus プロジェクトがある場合は、プロジェクトのベースディレクトリーで次のコマンドを実行して、 <code>oidc</code> および <code>keycloak-authorization</code> エクステンションを追加できます。</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">コマンドラインインタフェース</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus extension add oidc,keycloak-authorization</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:add-extension -Dextensions='oidc,keycloak-authorization'</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew addExtension --extensions='oidc,keycloak-authorization'</code></pre>
</div>
</div>
<div class="paragraph">
<p>このコマンドは、ビルドファイルに以下の依存関係を追加します。</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-oidc&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-keycloak-authorization&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">implementation("io.quarkus:quarkus-oidc")
implementation("io.quarkus:quarkus-keycloak-authorization")</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title"><code>/api/users/me</code> エンドポイントの実装</div>
<p><code>/api/users/me</code> エンドポイントの実装から開始します。
次のコードは、ユーザーの詳細を提供する Jakarta REST リソースを定義します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.keycloak.authorization;

import jakarta.inject.Inject;
import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;

import org.jboss.resteasy.reactive.NoCache;

import io.quarkus.security.identity.SecurityIdentity;

@Path("/api/users")
public class UsersResource {

    @Inject
    SecurityIdentity identity;

    @GET
    @Path("/me")
    @NoCache
    public User me() {
        return new User(identity);
    }

    public static class User {

        private final String userName;

        User(SecurityIdentity identity) {
            this.userName = identity.getPrincipal().getName();
        }

        public String getUserName() {
            return userName;
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title"><code>/api/admin</code> エンドポイントの実装</div>
<p>次に、 <code>/api/admin</code> エンドポイントを定義します。
次のコードは、認証で保護された単純な Jakarta REST リソースを表しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.keycloak.authorization;

import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;
import jakarta.ws.rs.Produces;
import jakarta.ws.rs.core.MediaType;

import io.quarkus.security.Authenticated;

@Path("/api/admin")
@Authenticated
public class AdminResource {

    @GET
    @Produces(MediaType.TEXT_PLAIN)
    public String admin() {
        return "granted";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">Keycloak によるロールベースのアクセス制御</div>
<p>リソースへのアクセス制御を強制するために、 <code>@RolesAllowed</code> などの明示的なアノテーションが定義されていない点に注意してください。
代わりに、 <code>keycloak-authorization</code> エクステンションは、Keycloak 内の保護されたリソースの URI を動的にマッピングします。</p>
</div>
<div class="paragraph">
<p>アクセス制御は次のように管理されます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Keycloak は、設定されたポリシーに基づいて各リクエストの権限を評価します。</p>
</li>
<li>
<p>エクステンションはこれらの権限を適用し、Keycloak で定義されたロールまたはポリシーに基づいてアクセスを許可または拒否します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>これにより、アクセス制御ロジックがアプリケーションコードから分離され、Keycloak で直接アクセスポリシーを管理および更新しやすくなります。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuring-the-application"><a class="anchor" href="#configuring-the-application"></a>アプリケーションの設定</h2>
<div class="sectionbody">
<div class="paragraph">
<p>OpenID Connect エクステンションを使用すると、通常は <code>src/main/resources</code> ディレクトリーにある <code>application.properties</code> ファイルを通じてアダプター設定を行うことができます。
以下に例を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># OIDC Configuration
%prod.quarkus.oidc.auth-server-url=https://localhost:8543/realms/quarkus <i class="conum" data-value="1"></i><b>(1)</b>
quarkus.oidc.client-id=backend-service <i class="conum" data-value="2"></i><b>(2)</b>
quarkus.oidc.credentials.secret=secret <i class="conum" data-value="3"></i><b>(3)</b>
quarkus.oidc.tls.verification=none <i class="conum" data-value="4"></i><b>(4)</b>

# Enable Policy Enforcement
quarkus.keycloak.policy-enforcer.enabled=true <i class="conum" data-value="5"></i><b>(5)</b>

# Import the realm file with Dev Services for Keycloak
# Note: This property is effective only in dev mode, not in JVM or native modes
quarkus.keycloak.devservices.realm-path=quarkus-realm.json <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Keycloak サーバーの URL と認証に使用するレルムを指定します。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Keycloak レルム内のクライアントアプリケーションを識別します。</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Keycloak サーバーによる認証用のクライアントシークレットを定義します。</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>開発目的で TLS 検証を無効にします。実稼働環境では推奨されません。</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Keycloak ポリシーエンフォーサーが、定義された権限に基づいてアクセス制御を管理できるようにします。</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>指定されたレルムファイルをインポートするように Dev Services を設定します。これは開発モードでのみ有効で、JVM モードやネイティブモードでは有効ではありません。</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>quarkus.oidc.auth-server-url</code> に <code>%prod.</code> プロファイルプレフィックスを追加すると、Dev Services for Keycloak が開発モードで自動的にコンテナーを起動するようになります。
詳細は、<a href="#keycloak-dev-mode">Running the application in Dev mode</a> セクションを参照してください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>デフォルトでは、 <code>quarkus-oidc</code> エクステンションを使用するアプリケーションは <code>service</code> タイプのアプリケーションとして扱われます。
ただし、エクステンションは、次の条件下では <code>web-app</code> タイプのアプリケーションもサポートします。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>認可コード付与フロー中に返されるアクセストークンは、ロールのソース (<code>quarkus.oidc.roles.source=accesstoken</code>) である必要があります。</p>
</li>
<li>
<p>注記: <code>web-app</code> タイプのアプリケーションの場合、ID トークンのロールはデフォルトでチェックされます。</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="starting-and-configuring-the-keycloak-server"><a class="anchor" href="#starting-and-configuring-the-keycloak-server"></a>Keycloak サーバーの起動と設定</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>アプリケーションを開発モードで実行するときは、Keycloak サーバーを起動しないでください。
Dev Services for Keycloak がコンテナーを起動します。
詳細は、<a href="#keycloak-dev-mode">開発モードでアプリケーションを実行する</a> セクションを参照してください。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Keycloak サーバーを起動するには、以下の Docker コマンドを使用します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">docker run --name keycloak \
  -e KC_BOOTSTRAP_ADMIN_USERNAME=admin \
  -e KC_BOOTSTRAP_ADMIN_PASSWORD=admin \
  -p 8543:8443 \
  -v "$(pwd)"/config/keycloak-keystore.jks:/etc/keycloak-keystore.jks \
  quay.io/keycloak/keycloak:26.5.0 \
  start --hostname-strict=false --https-key-store-file=/etc/keycloak-keystore.jks <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Keycloak キーストアの場合は、 <a href="https://github.com/quarkusio/quarkus-quickstarts/blob/main/security-keycloak-authorization-quickstart/config/keycloak-keystore.jks">quarkus-quickstarts/security-keycloak-authorization-quickstart/config</a> にある <code>keycloak-keystore.jks</code> ファイルを使用します。</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Keycloak サーバーへのアクセス</div>
<ol class="arabic">
<li>
<p>ブラウザーを開き、 <a href="https://localhost:8543">https://localhost:8543</a> に移動します。</p>
</li>
<li>
<p>次の認証情報を使用して、Keycloak Administration Console にログインします。</p>
<div class="ulist">
<ul>
<li>
<p><strong>ユーザー名</strong>: <code>admin</code></p>
</li>
<li>
<p><strong>パスワード</strong>: <code>admin</code></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">レルム設定のインポート</div>
<p>新しいレルムを作成するには、<a href="https://github.com/quarkusio/quarkus-quickstarts/tree/main/security-keycloak-authorization-quickstart/config/quarkus-realm.json">レルム設定ファイル</a> をインポートします。
レルムを作成する詳細な手順については、Keycloak のドキュメント ( <a href="https://www.keycloak.org/docs/latest/server_admin/index.html#_create-realm">新しいレルムを作成する</a>) を参照してください。</p>
</div>
<div class="paragraph">
<p>レルムをインポートした後、[Clients]に移動し、 <code>backend-service</code> クライアントを選択し、このクライアントの[Authorization and Resources]タブを選択します。リソースの権限を確認できます：</p>
</div>
<div class="imageblock center">
<div class="content">
<img src="/guides/images/keycloak-authorization-permissions.png" alt="Keycloak Authorization Permissions">
</div>
</div>
<div class="paragraph">
<div class="title">リソース権限における Keycloak のロール</div>
<p>リソースのアクセス権限は Keycloak で直接設定されるため、アプリケーションコードに <code>@RolesAllowed</code> アノテーションを追加する必要がなくなります。
このアプローチにより、Keycloak 内でアクセス制御管理が集中化され、アプリケーションのメンテナンスとセキュリティー更新が簡素化されます。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="keycloak-dev-mode"><a class="anchor" href="#keycloak-dev-mode"></a>開発モードでのアプリケーションの実行</h2>
<div class="sectionbody">
<div class="paragraph">
<p>アプリケーションを開発モードで実行するには、次のコマンドを使用します。</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">コマンドラインインタフェース</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus dev</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew --console=plain quarkusDev</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="security-openid-connect-dev-services">Dev Services for Keycloak</a> は、Keycloak コンテナーを起動し、 <code>quarkus-realm.json</code> 設定ファイルをインポートします。</p>
</div>
<div class="paragraph">
<p><a href="http://localhost:8080/q/dev-ui">/q/dev-ui</a> で入手可能な <a href="dev-ui">Dev UI</a> を開き、Dev UI の <strong>OpenID Connect</strong> カードの <strong>Provider: Keycloak</strong> リンクをクリックします。</p>
</div>
<div class="olist arabic">
<div class="title">開発 UI の操作</div>
<ol class="arabic">
<li>
<p><a href="dev-ui">Dev UI</a> at <a href="http://localhost:8080/q/dev-ui">/q/dev-ui</a> を開きます。</p>
</li>
<li>
<p>Dev UI の <strong>OpenID Connect</strong> カード内の <strong>Provider: Keycloak</strong> リンクをクリックします。</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">ユーザー権限のテスト</div>
<p><code>OpenID Connect Dev UI</code> によって提供される <code>Single Page Application</code> にログインするように求められたら、次の手順を実行します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>/api/users/me</code> リソースにアクセスするための <code>User Permission</code> のみを持つ <code>alice</code> (パスワード: <code>alice</code>) としてログインします。</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>/api/admin</code> にアクセスすると、 <code>403</code> が返されます。</p>
</li>
<li>
<p><code>/api/users/me</code> にアクセスすると、 <code>200</code> が返されます。</p>
</li>
</ol>
</div>
</li>
<li>
<p>ログアウトし、 <code>admin</code> としてログインします (パスワード: <code>admin</code>)。 <code>admin</code> は、 <code>/api/admin</code> リソースにアクセスするための <code>Admin Permission</code> と、 <code>/api/users/me</code> リソースにアクセスするための <code>User Permission</code> の両方を持っています。</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>/api/admin</code> にアクセスすると、 <code>200</code> が返されます。</p>
</li>
<li>
<p><code>/api/users/me</code> にアクセスすると、 <code>200</code> が返されます。</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Keycloak レルムのカスタマイズ</div>
<p><a href="https://github.com/quarkusio/quarkus-quickstarts/tree/main/security-keycloak-authorization-quickstart/config/quarkus-realm.json">quarkus-realm.json</a> などのレルムファイルをインポートせずに Dev Services for Keycloak を開始した場合は、Keycloak 認可ポリシーなしでデフォルトの <code>quarkus</code> レルムを作成します。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Dev UI の <strong>OpenID Connect</strong> カードから <strong>Keycloak Admin</strong> リンクを選択します。</p>
</li>
<li>
<p>Keycloak 管理コンソールにログインします。
ユーザー名とパスワードは両方とも <code>admin</code> です。</p>
</li>
<li>
<p><code>quarkus</code> レルムで認可ポリシーを有効にするには、<a href="https://www.keycloak.org/docs/latest/authorization_services/index.html">Keycloak Authorization Services ドキュメント</a> の指示に従ってください。</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Keycloak Admin</strong> リンクは、Dev UI で簡単に見つけることができます。</p>
</div>
<div class="imageblock center">
<div class="content">
<img src="/guides/images/dev-ui-oidc-keycloak-card.png" alt="Dev UI OpenID Connect Card">
</div>
</div>
<div class="paragraph">
<div class="title">カスタム JavaScript ポリシーの追加</div>
<p>アプリケーションが、JAR アーカイブにデプロイされた <a href="https://www.keycloak.org/docs/latest/authorization_services/index.html#_policy_js">JavaScript ポリシー</a> で設定された Keycloak 認可を使用する場合、Dev Services for Keycloak はこのアーカイブを Keycloak コンテナーに転送できます。
転送を設定するには、 <code>application.properties</code> の次のプロパティーを使用します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># Alias the policies archive
quarkus.keycloak.devservices.resource-aliases.policies=/policies.jar <i class="conum" data-value="1"></i><b>(1)</b>
# Map the policies archive to a specific location in the container
quarkus.keycloak.devservices.resource-mappings.policies=/opt/keycloak/providers/policies.jar <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>/policies.jar</code> クラスパスリソースの <code>policies</code> エイリアスを作成します。
ポリシーアーカイブはファイルシステム上に配置することもできます。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>ポリシーアーカイブを Keycloak コンテナー内の <code>/opt/keycloak/providers/policies.jar</code> のロケーションにマップします。</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-the-application-in-jvm-mode"><a class="anchor" href="#running-the-application-in-jvm-mode"></a>JVM モードでのアプリケーションの実行</h2>
<div class="sectionbody">
<div class="paragraph">
<p>開発モードでアプリケーションを試した後、JVM モードで標準の Java アプリケーションとして実行できます。</p>
</div>
<div class="paragraph">
<p>アプリケーションをコンパイルします。</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">コマンドラインインタフェース</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew build</code></pre>
</div>
</div>
<div class="paragraph">
<p>アプリケーションを実行します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">java -jar target/quarkus-app/quarkus-run.jar</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="running-the-application-in-native-mode"><a class="anchor" href="#running-the-application-in-native-mode"></a>ネイティブモードでアプリケーションの実行</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このデモはネイティブコードにコンパイルできます。変更は必要ありません。</p>
</div>
<div class="paragraph">
<p>ネイティブコンパイルでは、生成されたバイナリーにランタイムが含まれ、リソースの使用が最小限になるように最適化されるため、実稼働環境で JVM が不要になります。</p>
</div>
<div class="paragraph">
<p>コンパイルには時間がかかるため、デフォルトでは無効になっています。
アプリケーションをビルドするには、 <code>native</code> プロファイルを有効にします。</p>
</div>
<div class="paragraph">
<p>ネイティブバイナリーをビルドします。</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">コマンドラインインタフェース</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus build --native</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw install -Dnative</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew build -Dquarkus.native.enabled=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>しばらくしたら、ネイティブバイナリーを実行します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./target/security-keycloak-authorization-quickstart-1.0.0-SNAPSHOT-runner</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing"><a class="anchor" href="#testing"></a>アプリケーションのテスト</h2>
<div class="sectionbody">
<div class="paragraph">
<p>開発モードでアプリケーションをテストする手順については、前述の <a href="#keycloak-dev-mode">Running the application in Dev mode</a> セクションを参照してください。</p>
</div>
<div class="paragraph">
<p><code>curl</code> を使用して、JVM またはネイティブモードで実行されているアプリケーションをテストできます。</p>
</div>
<div class="paragraph">
<div class="title">アクセストークンの取得</div>
<p>アプリケーションはベアラートークン認可を使用します。
リソースにアクセスするには、まず Keycloak サーバーからアクセストークンを取得します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export access_token=$(\
    curl --insecure -X POST https://localhost:8543/realms/quarkus/protocol/openid-connect/token \
    --user backend-service:secret \
    -H 'content-type: application/x-www-form-urlencoded' \
    -d 'username=alice&amp;password=alice&amp;grant_type=password' | jq --raw-output '.access_token' \
 )</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>quarkus.oidc.authentication.user-info-required</code> プロパティーが <code>true</code> に設定されている場合、アプリケーションはアクセストークンを使用して UserInfo をリクエストすることを要求します。
その場合、トークン付与リクエストに <code>scope=openid</code> クエリーパラメーターを追加する必要があります。以下に例を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export access_token=$(\
    curl --insecure -X POST http://localhost:8180/realms/quarkus/protocol/openid-connect/token \
    --user backend-service:secret \
    -H 'content-type: application/x-www-form-urlencoded' \
    -d 'username=alice&amp;password=alice&amp;grant_type=password&amp;scope=openid' | jq --raw-output '.access_token' \
 )</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>上記の例では、ユーザー <code>alice</code> のアクセストークンを取得します。</p>
</div>
<div class="paragraph">
<div class="title"><code>/api/users/me</code> エンドポイントへのアクセス</div>
<p>有効なアクセストークンを持つすべてのユーザーは、ユーザーの詳細を含む JSON ペイロードを返す <code><a href="http://localhost:8080/api/users/me" class="bare">http://localhost:8080/api/users/me</a></code> エンドポイントにアクセスできます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -v -X GET \
  http://localhost:8080/api/users/me \
  -H "Authorization: Bearer "$access_token</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title"><code>/api/admin</code> エンドポイントへのアクセス</div>
<p><code><a href="http://localhost:8080/api/admin" class="bare">http://localhost:8080/api/admin</a></code> エンドポイントは、 <code>admin</code> ロールを持つユーザーに制限されています。
以前に発行されたアクセストークンを使用してこのエンドポイントにアクセスしようとすると、サーバーは <code>403 Forbidden</code> レスポンスを返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">curl -v -X GET \
  http://localhost:8080/api/admin \
  -H "Authorization: Bearer "$access_token</code></pre>
</div>
</div>
<div class="paragraph">
<div class="title">管理者アクセストークンの取得</div>
<p>管理エンドポイントにアクセスするには、 <code>admin</code> ユーザーのアクセストークンを取得します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">export access_token=$(\
    curl --insecure -X POST https://localhost:8543/realms/quarkus/protocol/openid-connect/token \
    --user backend-service:secret \
    -H 'content-type: application/x-www-form-urlencoded' \
    -d 'username=admin&amp;password=admin&amp;grant_type=password' | jq --raw-output '.access_token' \
 )</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="injecting-the-authorization-client"><a class="anchor" href="#injecting-the-authorization-client"></a>認可クライアントの注入</h2>
<div class="sectionbody">
<div class="paragraph">
<p>リソースの管理や Keycloak からの直接の権限取得などの高度なタスクについては、<a href="https://www.keycloak.org/docs/latest/authorization_services/#_service_client_api">Keycloak Authorization Client Java API</a> を参照してください。
この機能を有効にするには、Bean に <code>AuthzClient</code> インスタンスを注入します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class ProtectedResource {
    @Inject
    AuthzClient authzClient;
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To use the <code>AuthzClient</code> directly, set <code>quarkus.keycloak.policy-enforcer.enabled=true</code>.
Otherwise, no bean is available for injection.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mapping-protected-resources"><a class="anchor" href="#mapping-protected-resources"></a>保護されたリソースのマッピング</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, the extension uses lazy loading to fetch resources from Keycloak on demand. It uses the request URI to identify and map application resources that require protection.</p>
</div>
<div class="paragraph">
<p>To disable lazy loading and instead pre-load all resources at startup, configure the following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.keycloak.policy-enforcer.lazy-load-paths=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>起動時に Keycloak からリソースを事前ロードするのに必要な時間はリソースの数によって異なり、アプリケーションの初期ロード時間に影響する可能性があります。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="more-about-configuring-protected-resources"><a class="anchor" href="#more-about-configuring-protected-resources"></a>保護されたリソースの設定に関する詳細</h2>
<div class="sectionbody">
<div class="paragraph">
<p>デフォルト設定では、Keycloak はロールを管理し、誰がどのルートにアクセスできるかを決定します。</p>
</div>
<div class="paragraph">
<p><code>@RolesAllowed</code> アノテーションまたは <code>application.properties</code> ファイルを使用して保護されたルートを設定するには、<a href="security-oidc-bearer-token-authentication">OpenID Connect (OIDC) ベアラートークン認証</a> および <a href="security-authorize-web-endpoints-reference">Web エンドポイントの認可</a> ガイドを確認してください。
詳細は、<a href="security-overview">Quarkus セキュリティーの概要</a> を参照してください。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="access-to-public-resources"><a class="anchor" href="#access-to-public-resources"></a>パブリックリソースへのアクセス</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>quarkus-keycloak-authorization</code> ポリシーを適用せずにパブリックリソースへのアクセスを許可するには、 <code>application.properties</code> ファイルで <code>permit</code> HTTP ポリシーを定義します。
詳細は、<a href="security-authorize-web-endpoints-reference">Web エンドポイントの認可</a> ガイドを参照してください。</p>
</div>
<div class="paragraph">
<p>次のような設定を使用する場合、Keycloak Authorization Policy のポリシーチェックを無効にする必要はありません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.keycloak.policy-enforcer.paths.1.paths=/api/public
quarkus.keycloak.policy-enforcer.paths.1.enforcement-mode=DISABLED</code></pre>
</div>
</div>
<div class="paragraph">
<p>匿名ユーザーによるパブリックリソースへのアクセスを制限するには、強制的な Keycloak Authorization Policy を定義します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.keycloak.policy-enforcer.paths.1.paths=/api/public-enforcing
quarkus.keycloak.policy-enforcer.paths.1.enforcement-mode=ENFORCING</code></pre>
</div>
</div>
<div class="paragraph">
<p>パブリックリソースへの匿名アクセスを制御する必要がある場合、デフォルトのテナント設定のみが適用されます。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="checking-permission-scopes-programmatically"><a class="anchor" href="#checking-permission-scopes-programmatically"></a>プログラムを使用してパーミッションスコープを確認する</h2>
<div class="sectionbody">
<div class="paragraph">
<p>リソース権限に加えて、メソッドスコープを定義できます。
スコープは通常、リソースに対して実行されるアクションを表します。
メソッドスコープを使用して、強制的な Keycloak Authorization Policy を作成できます。
以下に例を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># path policy with enforced scope 'read' for method 'GET'
quarkus.keycloak.policy-enforcer.paths.1.name=Scope Permission Resource
quarkus.keycloak.policy-enforcer.paths.1.paths=/api/protected/standard-way
quarkus.keycloak.policy-enforcer.paths.1.methods.get.method=GET
quarkus.keycloak.policy-enforcer.paths.1.methods.get.scopes=read <i class="conum" data-value="1"></i><b>(1)</b>

# path policies without scope
quarkus.keycloak.policy-enforcer.paths.2.name=Scope Permission Resource
quarkus.keycloak.policy-enforcer.paths.2.paths=/api/protected/programmatic-way,/api/protected/annotation-way</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>ユーザーはリソースパーミッション 'Scope Permission Resource' とスコープ 'read' を持っている必要があります。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Keycloak Policy Enforcer は <code>/api/protected/standard-way</code> リクエストパスを保護し、 <code>@RolesAllowed</code> などのアノテーションの必要性を排除します。
ただし、シナリオによっては、プログラムによるチェックを実行する必要がある場合があります。</p>
</div>
<div class="paragraph">
<p>次の例に示すように、Bean に <code>SecurityIdentity</code> インスタンスを注入することでこれを実現できます。
または、リソースメソッドに <code>@PermissionsAllowed</code> アノテーションを付与することで同じ結果を得ることができます。
次の例は、それぞれ同じ <code>read</code> スコープを必要とする 3 つのリソースメソッドを示しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.security.BasicPermission;
import java.util.List;

import jakarta.inject.Inject;
import jakarta.ws.rs.ForbiddenException;
import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;

import org.keycloak.representations.idm.authorization.Permission;

import io.quarkus.security.PermissionsAllowed;
import io.quarkus.security.identity.SecurityIdentity;
import io.smallrye.mutiny.Uni;

@Path("/api/protected")
public class ProtectedResource {

    @Inject
    SecurityIdentity identity;

    @GET
    @Path("/standard-way")
    public Uni&lt;List&lt;Permission&gt;&gt; standardWay() { <i class="conum" data-value="1"></i><b>(1)</b>
        return Uni.createFrom().item(identity.&lt;List&lt;Permission&gt;&gt; getAttribute("permissions"));
    }

    @GET
    @Path("/programmatic-way")
    public Uni&lt;List&lt;Permission&gt;&gt; programmaticWay() {
        var requiredPermission = new BasicPermission("Scope Permission Resource") {
            @Override
            public String getActions() {
                return "read";
            }
        };
        return identity.checkPermission(requiredPermission).onItem() <i class="conum" data-value="2"></i><b>(2)</b>
                .transform(granted -&gt; {
                    if (granted) {
                        return identity.getAttribute("permissions");
                    }
                    throw new ForbiddenException();
                });
    }

    @PermissionsAllowed("Scope Permission Resource:read") <i class="conum" data-value="3"></i><b>(3)</b>
    @GET
    @Path("/annotation-way")
    public Uni&lt;List&lt;Permission&gt;&gt; annotationWay() {
        return Uni.createFrom().item(identity.&lt;List&lt;Permission&gt;&gt; getAttribute("permissions"));
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>/standard-way</code> サブパスには、 <code>application.properties</code> ファイルで設定された設定に基づいて、リソース権限と <code>read</code> スコープの両方が必要です。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>/programmatic-way</code> サブパスは、デフォルトでは <code>Scope Permission Resource</code> 権限のみをチェックします。ただし、 <code>SecurityIdentity#checkPermission</code> を使用して、スコープ要件などの追加の制約を適用できます。</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>/annotation-way</code> の <code>@PermissionsAllowed</code> アノテーションは、 <code>Scope Permission Resource</code> パーミッションと <code>read</code> スコープを持つリクエストへのアクセスを制限します。
詳細については、Web エンドポイントの認可ガイドの <a href="security-authorize-web-endpoints-reference#standard-security-annotations">アノテーションを使用した認可</a> のセクションを参照してください。</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="multi-tenancy"><a class="anchor" href="#multi-tenancy"></a>マルチテナンシー</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="security-openid-connect-multitenancy">OpenID Connect (OIDC) マルチテナンシー</a> と同様に、テナントごとにポリシーエンフォーサー設定をセットアップできます。
以下に例を示します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.keycloak.policy-enforcer.enabled=true

# Default Tenant
quarkus.oidc.auth-server-url=${keycloak.url:replaced-by-test-resource}/realms/quarkus
quarkus.oidc.client-id=quarkus-app
quarkus.oidc.credentials.secret=secret

quarkus.keycloak.policy-enforcer.enforcement-mode=PERMISSIVE
quarkus.keycloak.policy-enforcer.paths.1.name=Permission Resource
quarkus.keycloak.policy-enforcer.paths.1.paths=/api/permission
quarkus.keycloak.policy-enforcer.paths.1.claim-information-point.claims.static-claim=static-claim

# Service Tenant

quarkus.oidc.service-tenant.auth-server-url=${keycloak.url:replaced-by-test-resource}/realms/quarkus
quarkus.oidc.service-tenant.client-id=quarkus-app
quarkus.oidc.service-tenant.credentials.secret=secret

quarkus.keycloak.service-tenant.policy-enforcer.enforcement-mode=PERMISSIVE
quarkus.keycloak.service-tenant.policy-enforcer.paths.1.name=Permission Resource Service
quarkus.keycloak.service-tenant.policy-enforcer.paths.1.paths=/api/permission
quarkus.keycloak.service-tenant.policy-enforcer.paths.1.claim-information-point.claims.static-claim=static-claim


# WebApp Tenant

quarkus.oidc.webapp-tenant.auth-server-url=${keycloak.url:replaced-by-test-resource}/realms/quarkus
quarkus.oidc.webapp-tenant.client-id=quarkus-app
quarkus.oidc.webapp-tenant.credentials.secret=secret
quarkus.oidc.webapp-tenant.application-type=web-app
quarkus.oidc.webapp-tenant.roles.source=accesstoken

quarkus.keycloak.webapp-tenant.policy-enforcer.enforcement-mode=PERMISSIVE
quarkus.keycloak.webapp-tenant.policy-enforcer.paths.1.name=Permission Resource WebApp
quarkus.keycloak.webapp-tenant.policy-enforcer.paths.1.paths=/api/permission
quarkus.keycloak.webapp-tenant.policy-enforcer.paths.1.claim-information-point.claims.static-claim=static-claim</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dynamic-tenant-configuration-resolution"><a class="anchor" href="#dynamic-tenant-configuration-resolution"></a>動的なテナント設定の解決</h2>
<div class="sectionbody">
<div class="paragraph">
<p>設定ファイル内の過剰なエントリーを避けながら複数のテナントの設定を作成するには、 <code>io.quarkus.keycloak.pep.TenantPolicyConfigResolver</code> インターフェイスを使用して、実行時にプログラムで定義することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.keycloak.authorization;

import java.util.Map;

import jakarta.enterprise.context.ApplicationScoped;

import io.quarkus.keycloak.pep.TenantPolicyConfigResolver;
import io.quarkus.keycloak.pep.runtime.KeycloakPolicyEnforcerConfig;
import io.quarkus.keycloak.pep.runtime.KeycloakPolicyEnforcerTenantConfig;
import io.quarkus.oidc.OidcRequestContext;
import io.quarkus.oidc.OidcTenantConfig;
import io.smallrye.mutiny.Uni;
import io.vertx.ext.web.RoutingContext;

@ApplicationScoped
public class CustomTenantPolicyConfigResolver implements TenantPolicyConfigResolver {

    private final KeycloakPolicyEnforcerTenantConfig enhancedTenantConfig;
    private final KeycloakPolicyEnforcerTenantConfig newTenantConfig;

    public CustomTenantPolicyConfigResolver(KeycloakPolicyEnforcerConfig enforcerConfig) {
        this.enhancedTenantConfig = KeycloakPolicyEnforcerTenantConfig.builder(enforcerConfig.defaultTenant()) <i class="conum" data-value="1"></i><b>(1)</b>
            .paths("/enhanced-config")
            .permissionName("Permission Name")
            .get("read-scope")
            .build();
        this.newTenantConfig = KeycloakPolicyEnforcerTenantConfig.builder() <i class="conum" data-value="2"></i><b>(2)</b>
            .paths("/new-config")
            .claimInformationPoint(Map.of("claims", Map.of("grant", "{request.parameter['grant']}")))
            .build();
    }

    @Override
    public Uni&lt;KeycloakPolicyEnforcerTenantConfig&gt; resolve(RoutingContext routingContext, OidcTenantConfig tenantConfig,
                                                OidcRequestContext&lt;KeycloakPolicyEnforcerTenantConfig&gt; requestContext) {
        String path = routingContext.normalizedPath();
        String tenantId = tenantConfig.tenantId().orElse(null);
        if ("enhanced-config-tenant".equals(tenantId) &amp;&amp; path.equals("/enhanced-config")) {
            return Uni.createFrom().item(enhancedTenantConfig);
        } else if ("new-config-tenant".equals(tenantId) &amp;&amp; path.equals("/new-config")) {
            return Uni.createFrom().item(newTenantConfig);
        }
        return Uni.createFrom().nullItem(); <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>デフォルトのテナント設定で <code>/enhanced-config</code> パスを定義または更新します。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>プログラムによって設定されるカスタムクレームと値を含む、テナント設定に <code>/new-config</code> パスを追加します。</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>application.properties</code> ファイルまたはその他の SmallRye Config ソースで定義されているデフォルトの静的テナント設定解決にフォールバックします。</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-reference"><a class="anchor" href="#configuration-reference"></a>設定リファレンス</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この設定は、公式の <a href="https://www.keycloak.org/docs/latest/authorization_services/index.html#_enforcer_filter">Keycloak Policy Enforcer 設定</a> ガイドラインに準拠しています。
さまざまな設定オプションの詳細は、次のドキュメントを参照してください。</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> ビルド時に固定された設定プロパティー。その他の設定プロパティーは、すべて実行時にオーバーライド可能です。<input type="search" id="config-search-0" placeholder="FILTER CONFIGURATION" disabled></p>
</div>
<table class="tableblock frame-all grid-all stretch configuration-reference searchable configuration-reference-all-rows">
<colgroup>
<col style="width: 80%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><span class="header-title">Configuration property</span></p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">タイプ</p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">デフォルト</p></th>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-enabled"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-enabled"><code>quarkus.keycloak.policy-enforcer.enabled</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.enabled' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-1" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Enables policy enforcement.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8259">QUARKUS_KEYCLOAK_POLICY_ENFORCER_ENABLED</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8259" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ブーリアン</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-connection-pool-size"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-connection-pool-size"><code>quarkus.keycloak.connection-pool-size</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.connection-pool-size' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-2" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Adapters will make separate HTTP invocations to the Keycloak server to turn an access code into an access token. This config option defines how many connections to the Keycloak server should be pooled</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8260">QUARKUS_KEYCLOAK_CONNECTION_POOL_SIZE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8260" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>20</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-enforcement-mode"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-enforcement-mode"><code>quarkus.keycloak.policy-enforcer.enforcement-mode</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.enforcement-mode' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-3" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how policies are enforced.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8261">QUARKUS_KEYCLOAK_POLICY_ENFORCER_ENFORCEMENT_MODE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8261" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>permissive</code>, <code>enforcing</code>, <code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>enforcing</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-path-cache-max-entries"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-path-cache-max-entries"><code>quarkus.keycloak.policy-enforcer.path-cache.max-entries</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.path-cache.max-entries' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-4" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Defines the limit of entries that should be kept in the cache</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8262">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATH_CACHE_MAX_ENTRIES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8262" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1000</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-path-cache-lifespan"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-path-cache-lifespan"><code>quarkus.keycloak.policy-enforcer.path-cache.lifespan</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.path-cache.lifespan' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-5" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Defines the time in milliseconds when the entry should be expired</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8263">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATH_CACHE_LIFESPAN</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8263" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">長</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>30000</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-lazy-load-paths"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-lazy-load-paths"><code>quarkus.keycloak.policy-enforcer.lazy-load-paths</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.lazy-load-paths' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-6" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how the adapter should fetch the server for resources associated with paths in your application. If true, the policy enforcer is going to fetch resources on-demand accordingly with the path being requested</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8264">QUARKUS_KEYCLOAK_POLICY_ENFORCER_LAZY_LOAD_PATHS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8264" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ブーリアン</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-claim-information-point-complex-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-claim-information-point-complex-config"><code>quarkus.keycloak.policy-enforcer.claim-information-point."complex-config"</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.claim-information-point."complex-config"' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-7" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Complex config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8265">QUARKUS_KEYCLOAK_POLICY_ENFORCER_CLAIM_INFORMATION_POINT__COMPLEX_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8265" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,Map&lt;String,String&gt;&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-claim-information-point-simple-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-claim-information-point-simple-config"><code>quarkus.keycloak.policy-enforcer.claim-information-point."simple-config"</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.claim-information-point."simple-config"' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-8" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Simple config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8266">QUARKUS_KEYCLOAK_POLICY_ENFORCER_CLAIM_INFORMATION_POINT__SIMPLE_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8266" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,String&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-http-method-as-scope"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-http-method-as-scope"><code>quarkus.keycloak.policy-enforcer.http-method-as-scope</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.http-method-as-scope' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-9" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how scopes should be mapped to HTTP methods. If set to true, the policy enforcer will use the HTTP method from the current request to check whether access should be granted</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8267">QUARKUS_KEYCLOAK_POLICY_ENFORCER_HTTP_METHOD_AS_SCOPE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8267" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ブーリアン</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-name"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-name"><code>quarkus.keycloak.policy-enforcer.paths."paths".name</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.paths."paths".name' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-10" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The name of a resource on the server that is to be associated with a given path</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8268">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__NAME</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8268" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-paths"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-paths"><code>quarkus.keycloak.policy-enforcer.paths."paths".paths</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.paths."paths".paths' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-11" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>HTTP request paths that should be protected by the policy enforcer</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8269">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__PATHS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8269" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-methods-methods-method"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-methods-methods-method"><code>quarkus.keycloak.policy-enforcer.paths."paths".methods."methods".method</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.paths."paths".methods."methods".method' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-12" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The name of the HTTP method</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8270">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__METHODS__METHODS__METHOD</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8270" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">required <span class="icon"><i class="fa fa-exclamation-circle" title="Configuration property is required"></i></span></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-methods-methods-scopes"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-methods-methods-scopes"><code>quarkus.keycloak.policy-enforcer.paths."paths".methods."methods".scopes</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.paths."paths".methods."methods".scopes' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-13" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>An array of strings with the scopes associated with the method</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8271">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__METHODS__METHODS__SCOPES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8271" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">required <span class="icon"><i class="fa fa-exclamation-circle" title="Configuration property is required"></i></span></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-methods-methods-scopes-enforcement-mode"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-methods-methods-scopes-enforcement-mode"><code>quarkus.keycloak.policy-enforcer.paths."paths".methods."methods".scopes-enforcement-mode</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.paths."paths".methods."methods".scopes-enforcement-mode' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-14" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>A string referencing the enforcement mode for the scopes associated with a method</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8272">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__METHODS__METHODS__SCOPES_ENFORCEMENT_MODE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8272" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>all</code>, <code>any</code>, <code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>all</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-enforcement-mode"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-enforcement-mode"><code>quarkus.keycloak.policy-enforcer.paths."paths".enforcement-mode</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.paths."paths".enforcement-mode' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-15" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how policies are enforced</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8273">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__ENFORCEMENT_MODE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8273" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>permissive</code>, <code>enforcing</code>, <code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>enforcing</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-claim-information-point-complex-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-claim-information-point-complex-config"><code>quarkus.keycloak.policy-enforcer.paths."paths".claim-information-point."complex-config"</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.paths."paths".claim-information-point."complex-config"' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-16" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Complex config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8274">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__CLAIM_INFORMATION_POINT__COMPLEX_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8274" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,Map&lt;String,String&gt;&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-claim-information-point-simple-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-claim-information-point-simple-config"><code>quarkus.keycloak.policy-enforcer.paths."paths".claim-information-point."simple-config"</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.paths."paths".claim-information-point."simple-config"' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-17" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Simple config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8275">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__CLAIM_INFORMATION_POINT__SIMPLE_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8275" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,String&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-enable"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-enable"><span class="line-through"><code>quarkus.keycloak.policy-enforcer.enable</code></span></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.enable' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-18" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p><em>This property is deprecated since <code>3.26</code>: use <code>quarkus.keycloak.policy-enforcer.enabled</code> instead.</em></p>
</div>
<div class="paragraph">
<p>Enables policy enforcement.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8276">QUARKUS_KEYCLOAK_POLICY_ENFORCER_ENABLE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8276" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ブーリアン</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-path"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-policy-enforcer-paths-paths-path"><span class="line-through"><code>quarkus.keycloak.policy-enforcer.paths."paths".path</code></span></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak.policy-enforcer.paths."paths".path' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-19" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p><em>This property is deprecated since <code>Quarkus 3.10</code>.</em></p>
</div>
<div class="paragraph">
<p>A URI relative to the application’s context path that should be protected by the policy enforcer</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8277">QUARKUS_KEYCLOAK_POLICY_ENFORCER_PATHS__PATHS__PATH</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8277" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><a id="quarkus-keycloak-authorization_section_quarkus-keycloak"></a> <span class="section-name section-level0"><a href="#quarkus-keycloak-authorization_section_quarkus-keycloak">Additional named tenants</a></span></p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">タイプ</p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">デフォルト</p></th>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-connection-pool-size"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-connection-pool-size"><code>quarkus.keycloak."tenant".connection-pool-size</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".connection-pool-size' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-20" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Adapters will make separate HTTP invocations to the Keycloak server to turn an access code into an access token. This config option defines how many connections to the Keycloak server should be pooled</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8278">QUARKUS_KEYCLOAK__TENANT__CONNECTION_POOL_SIZE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8278" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>20</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-enforcement-mode"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-enforcement-mode"><code>quarkus.keycloak."tenant".policy-enforcer.enforcement-mode</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.enforcement-mode' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-21" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how policies are enforced.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8279">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_ENFORCEMENT_MODE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8279" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>permissive</code>, <code>enforcing</code>, <code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>enforcing</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-name"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-name"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".name</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.paths."paths".name' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-22" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The name of a resource on the server that is to be associated with a given path</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8280">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__NAME</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8280" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-paths"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-paths"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".paths</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.paths."paths".paths' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-23" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>HTTP request paths that should be protected by the policy enforcer</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8281">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__PATHS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8281" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-methods-methods-method"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-methods-methods-method"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".methods."methods".method</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.paths."paths".methods."methods".method' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-24" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The name of the HTTP method</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8282">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__METHODS__METHODS__METHOD</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8282" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">required <span class="icon"><i class="fa fa-exclamation-circle" title="Configuration property is required"></i></span></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-methods-methods-scopes"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-methods-methods-scopes"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".methods."methods".scopes</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.paths."paths".methods."methods".scopes' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-25" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>An array of strings with the scopes associated with the method</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8283">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__METHODS__METHODS__SCOPES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8283" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">required <span class="icon"><i class="fa fa-exclamation-circle" title="Configuration property is required"></i></span></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-methods-methods-scopes-enforcement-mode"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-methods-methods-scopes-enforcement-mode"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".methods."methods".scopes-enforcement-mode</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.paths."paths".methods."methods".scopes-enforcement-mode' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-26" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>A string referencing the enforcement mode for the scopes associated with a method</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8284">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__METHODS__METHODS__SCOPES_ENFORCEMENT_MODE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8284" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>all</code>, <code>any</code>, <code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>all</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-enforcement-mode"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-enforcement-mode"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".enforcement-mode</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.paths."paths".enforcement-mode' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-27" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how policies are enforced</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8285">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__ENFORCEMENT_MODE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8285" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>permissive</code>, <code>enforcing</code>, <code>disabled</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>enforcing</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-claim-information-point-complex-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-claim-information-point-complex-config"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".claim-information-point."complex-config"</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.paths."paths".claim-information-point."complex-config"' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-28" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Complex config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8286">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__CLAIM_INFORMATION_POINT__COMPLEX_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8286" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,Map&lt;String,String&gt;&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-claim-information-point-simple-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-paths-paths-claim-information-point-simple-config"><code>quarkus.keycloak."tenant".policy-enforcer.paths."paths".claim-information-point."simple-config"</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.paths."paths".claim-information-point."simple-config"' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-29" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Simple config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8287">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATHS__PATHS__CLAIM_INFORMATION_POINT__SIMPLE_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8287" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,String&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-path-cache-max-entries"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-path-cache-max-entries"><code>quarkus.keycloak."tenant".policy-enforcer.path-cache.max-entries</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.path-cache.max-entries' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-30" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Defines the limit of entries that should be kept in the cache</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8288">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATH_CACHE_MAX_ENTRIES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8288" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>1000</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc row-hidden odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-path-cache-lifespan"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-path-cache-lifespan"><code>quarkus.keycloak."tenant".policy-enforcer.path-cache.lifespan</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.path-cache.lifespan' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-31" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Defines the time in milliseconds when the entry should be expired</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8289">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_PATH_CACHE_LIFESPAN</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8289" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">長</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>30000</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc row-hidden">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-lazy-load-paths"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-lazy-load-paths"><code>quarkus.keycloak."tenant".policy-enforcer.lazy-load-paths</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.lazy-load-paths' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-32" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how the adapter should fetch the server for resources associated with paths in your application. If true, the policy enforcer is going to fetch resources on-demand accordingly with the path being requested</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8290">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_LAZY_LOAD_PATHS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8290" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ブーリアン</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc row-hidden odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-claim-information-point-complex-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-claim-information-point-complex-config"><code>quarkus.keycloak."tenant".policy-enforcer.claim-information-point."complex-config"</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.claim-information-point."complex-config"' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-33" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Complex config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8291">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_CLAIM_INFORMATION_POINT__COMPLEX_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8291" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,Map&lt;String,String&gt;&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc row-hidden">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-claim-information-point-simple-config"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-claim-information-point-simple-config"><code>quarkus.keycloak."tenant".policy-enforcer.claim-information-point."simple-config"</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.claim-information-point."simple-config"' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-34" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Simple config.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8292">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_CLAIM_INFORMATION_POINT__SIMPLE_CONFIG_</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8292" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">Map&lt;String,Map&lt;String,String&gt;&gt;</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc row-hidden odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-http-method-as-scope"></a> <span class="property-path"><a href="#quarkus-keycloak-authorization_quarkus-keycloak-tenant-policy-enforcer-http-method-as-scope"><code>quarkus.keycloak."tenant".policy-enforcer.http-method-as-scope</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.keycloak."tenant".policy-enforcer.http-method-as-scope' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-35" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Specifies how scopes should be mapped to HTTP methods. If set to true, the policy enforcer will use the HTTP method from the current request to check whether access should be granted</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-8293">QUARKUS_KEYCLOAK__TENANT__POLICY_ENFORCER_HTTP_METHOD_AS_SCOPE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-8293" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">ブーリアン</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="references"><a class="anchor" href="#references"></a>参考資料</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://www.keycloak.org/documentation.html">Keycloak ドキュメント</a></p>
</li>
<li>
<p><a href="https://www.keycloak.org/docs/latest/authorization_services/index.html">Keycloak Authorization Services</a></p>
</li>
<li>
<p><a href="https://openid.net/connect/">OpenID Connect</a></p>
</li>
<li>
<p><a href="https://tools.ietf.org/html/rfc7519">JSON Web Token</a></p>
</li>
<li>
<p><a href="security-overview">Quarkus Security の概要</a></p>
</li>
<li>
<p><a href="security-keycloak-admin-client">Quarkus Keycloak Adminクライアント</a></p>
</li>
</ul>
</div>
</div>
</div>
    </div>
    <div class="grid__item width-4-12 width-12-12-m tocwrapper">
      <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#overview">概要</a></li>
<li><a href="#prerequisites">要件</a></li>
<li><a href="#architecture">アーキテクチャー</a></li>
<li><a href="#solution">ソリューション</a></li>
<li><a href="#creating-the-project">プロジェクトの作成</a></li>
<li><a href="#configuring-the-application">アプリケーションの設定</a></li>
<li><a href="#starting-and-configuring-the-keycloak-server">Keycloak サーバーの起動と設定</a></li>
<li><a href="#keycloak-dev-mode">開発モードでのアプリケーションの実行</a></li>
<li><a href="#running-the-application-in-jvm-mode">JVM モードでのアプリケーションの実行</a></li>
<li><a href="#running-the-application-in-native-mode">ネイティブモードでアプリケーションの実行</a></li>
<li><a href="#testing">アプリケーションのテスト</a></li>
<li><a href="#injecting-the-authorization-client">認可クライアントの注入</a></li>
<li><a href="#mapping-protected-resources">保護されたリソースのマッピング</a></li>
<li><a href="#more-about-configuring-protected-resources">保護されたリソースの設定に関する詳細</a></li>
<li><a href="#access-to-public-resources">パブリックリソースへのアクセス</a></li>
<li><a href="#checking-permission-scopes-programmatically">プログラムを使用してパーミッションスコープを確認する</a></li>
<li><a href="#multi-tenancy">マルチテナンシー</a></li>
<li><a href="#dynamic-tenant-configuration-resolution">動的なテナント設定の解決</a></li>
<li><a href="#configuration-reference">設定リファレンス</a></li>
<li><a href="#references">参考資料</a></li>
</ul></div>
    </div>
  </div>
  <h2>関連コンテンツ</h2>
  <div class="grid-wrapper relations">
    <div class="grid__item width-6-12 width-12-12-m">
      <h3>同じエクステンションについて</h3>
      <ul class="related-content">
      
        
        <li class="concepts"><a href="/guides/security-openid-connect-providers">よく知られたOpenID Connect プロバイダーの設定</a></li>
      
        
        <li class="howto"><a href="/guides/security-openid-connect-dev-services">OpenID Connect (OIDC)のDev ServicesとDev UI</a></li>
      
        
        <li class="tutorial"><a href="/guides/security-vertx-oidc-to-quarkus-oidc-migration">Migrate from Vert.x OIDC to Quarkus OIDC</a></li>
      
        
        <li class="concepts"><a href="/guides/security-oidc-bearer-token-authentication">OpenID Connect (OIDC) ベアラートークン認証</a></li>
      
        
        <li class="reference"><a href="/guides/security-oidc-configuration-properties-reference">OpenID Connect (OIDC) 設定プロパティ</a></li>
      
        
        <li class="concepts"><a href="/guides/security-oidc-code-flow-authentication">Web アプリケーションを保護するための OpenID Connect 認可コードフローメカニズム</a></li>
      
        
        <li class="tutorial"><a href="/guides/security-oidc-bearer-token-authentication-tutorial">OpenID Connect（OIDC）ベアラートークン認証によるサービスアプリケーションの保護</a></li>
      
        
        <li class="tutorial"><a href="/guides/security-oidc-code-flow-authentication-tutorial">Quarkus - 認可コードフローのOpenID Connectを使用してWebアプリケーションを保護</a></li>
      
        
        <li class="howto"><a href="/guides/security-openid-connect-multitenancy">OpenID Connect (OIDC)のマルチテナンシーの使用</a></li>
      </ul>
    </div>
    <div class="grid__item width-6-12 width-12-12-m">
      <h3>同じトピックについて</h3>
      <ul class="related-content">
      
        
        <li class="guide"><a href="/guides/security-keycloak-admin-client">Keycloak Admin Clientの使用</a></li>
      
        
        <li class="concepts"><a href="/guides/security-oidc-bearer-token-authentication">OpenID Connect (OIDC) ベアラートークン認証</a></li>
      
        
        <li class="concepts"><a href="/guides/security-oidc-code-flow-authentication">Web アプリケーションを保護するための OpenID Connect 認可コードフローメカニズム</a></li>
      
        
        <li class="tutorial"><a href="/guides/security-oidc-bearer-token-authentication-tutorial">OpenID Connect（OIDC）ベアラートークン認証によるサービスアプリケーションの保護</a></li>
      
        
        <li class="tutorial"><a href="/guides/security-oidc-code-flow-authentication-tutorial">Quarkus - 認可コードフローのOpenID Connectを使用してWebアプリケーションを保護</a></li>
      
        
        <li class="howto"><a href="/guides/security-openid-connect-dev-services">OpenID Connect (OIDC)のDev ServicesとDev UI</a></li>
      
        
        <li class="concepts"><a href="/guides/security-authentication-mechanisms">Quarkusの認証メカニズム</a></li>
      
        
        <li class="reference"><a href="/guides/security-authorize-web-endpoints-reference">ウェブエンドポイントの認可</a></li>
      
        
        <li class="concepts"><a href="/guides/security-basic-authentication">Basic認証</a></li>
      
        
        <li class="concepts"><a href="/guides/security-openid-connect-providers">よく知られたOpenID Connect プロバイダーの設定</a></li>
      
        
        <li class="howto"><a href="/guides/security-basic-authentication-howto">ベーシック認証の有効化</a></li>
      
        
        <li class="tutorial"><a href="/guides/security-getting-started-tutorial">Basic認証とJakarta Persistenceを使用したセキュリティの入門</a></li>
      
        
        <li class="tutorial"><a href="/guides/security-vertx-oidc-to-quarkus-oidc-migration">Migrate from Vert.x OIDC to Quarkus OIDC</a></li>
      
        
        <li class="reference"><a href="/guides/security-openid-connect-client-reference">OpenID Connect (OIDC) と OAuth2 クライアントおよびフィルター</a></li>
      
        
        <li class="reference"><a href="/guides/security-openid-connect-client-registration">OpenID Connect (OIDC) と OAuth2 の動的クライアント登録</a></li>
      
        
        <li class="reference"><a href="/guides/security-oidc-configuration-properties-reference">OpenID Connect (OIDC) 設定プロパティ</a></li>
      
        
        <li class="tutorial"><a href="/guides/security-openid-connect-client">OpenID Connectクライアントとトークン伝搬クイックスタート</a></li>
      
        
        <li class="concepts"><a href="/guides/security-proactive-authentication">プロアクティブ認証</a></li>
      
        
        <li class="howto"><a href="/guides/security-openid-connect-multitenancy">OpenID Connect (OIDC)のマルチテナンシーの使用</a></li>
      
        
        <li class="guide"><a href="/guides/security-webauthn">WebAuthnと共にSecurityを使用</a></li>
      </ul>
    </div>
    </div>
  </div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license. <i class='fab fa-creative-commons'></i><i class='fab fa-creative-commons-by'></i> <a href='https://creativecommons.org/licenses/by/3.0/' target='_blank'>CC by 3.0</a><br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>ナビゲーション</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">ホーム</a></li>
          
          
          
            <li><a href="/about" target="_blank">Quarkusについて</a></li>
          
          
          
            <li><a href="/blog" target="_blank">ブログ</a></li>
          
          
          
            <li><a href="/insights" target="_blank">ポッドキャスト</a></li>
          
          
          
            <li><a href="/events" target="_blank">イベント</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">ニュースレター</a></li>
          
          
          
            <li><a href="/userstories" target="_blank">ユーザーストーリー</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">ロードマップ</a></li>
          
          
          
            <li><a href="/security" target="_blank">セキュリティ&nbsp;ポリシー</a></li>
          
          
          
            <li><a href="/usage" target="_blank">使用方法</a></li>
          
          
          
            <li><a href="https://github.com/commonhaus/artwork/tree/main/projects/quarkus" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
          
            <li><a href="https://www.redhat.com/en/about/privacy-policy" target="_blank">Privacy Policy</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>フォローする</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a href="https://bsky.app/profile/quarkus.io" target="_blank">Bluesky</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.threads.com/@quarkusio" target="_blank">Threads</a></li>
          
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>ヘルプ</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">サポート</a></li>
          
          
          
            <li><a href="/guides" target="_blank">ガイド</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">入門</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">ディスカッション</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">開発メーリングリスト</a></li>
          
          
          
            <li><a href="https://stats.uptimerobot.com/ze1PfweT2p" target="_blank">Quarkus Service Status</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>言語</span>
        <ul class="footer-links">
          
          
            <li><a href=" https://quarkus.io/ " target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href=" https://es.quarkus.io/ " target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href=" https://ja.quarkus.io/ " target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkusはコミュニティプロジェクトで構成されています</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate ORM</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">その他多数...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content cf-footer">
  <div class="flexcontainer">
    <div class="cf-logo">
      <a class="cf-logo" href="https://www.commonhaus.org/" target="_blank"><img src="https://raw.githubusercontent.com/commonhaus/artwork/main/foundation/brand/svg/CF_logo_horizontal_single_reverse.svg"/></a>
    </div>
    <div class="license">
      Copyright © Quarkus. All rights reserved. For details on our trademarks, please visit our <a href="https://www.commonhaus.org/policies/trademark-policy/">Trademark Policy</a> and <a href="https://www.commonhaus.org/trademarks/">Trademark List</a>. Trademarks of third parties are owned by their respective holders and their mention here does not suggest any endorsement or association.
    </div>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
  <script src="/assets/javascript/randomize.js" type="text/javascript"></script>
  <script src="/assets/javascript/time.js" type="text/javascript"></script>
</body>

</html>
