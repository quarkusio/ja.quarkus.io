<!DOCTYPE html>
<html lang="ja">







<head>
  <title>コンテキストと依存性インジェクション - main - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://analytics.ossupstream.org/ https://search.quarkus.io https://smetrics.redhat.com https://ajax.googleapis.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://analytics.ossupstream.org/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://player.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />

  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/version/main/guides/cdi-reference" />
  <meta property="og:title" content="コンテキストと依存性インジェクション - main" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/cdi-reference">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="guides">

  


<div class="grid-wrapper communitysite">
  <div class="grid__item width-12-12">The <a href="https://quarkus.io/version/main/guides/cdi-reference">English version of quarkus.io</a> is the official project site. Translated sites are community supported on a best-effort basis.</div>
</div>


  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox"> <i class="fa fa-bars"></i>
</label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="#">Why<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">QUARKUSとは何か?</a></li>
          <li><a href="/developer-joy" class="">開発者満足</a></li>
          <li><a href="/performance" class="">パフォーマンス</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">標準</a></li>
          <li><a href="/versatility" class="">多用途性</a></li>
          <li><a href="/container-first" class="">コンテナ・ファースト</a></li>
          <li><a href="/spring" class="">USING SPRING?</a></li>
          <li class="tertiarydropdown">
            <span href="#">AI<i class="fas fa-chevron-down"></i></span>
            <ul class="tertiarymenu">
              <li><a href="/ai" class="">AI OVERVIEW</a></li>
              <li><a href="/java-for-ai" class="">JAVA FOR AI</a></li>
              <li><a href="/quarkus-for-ai" class="">WHY QUARKUS FOR AI</a></li>
              <li><a href="/ai-blueprints" class="">AI BLUEPRINTS</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="#">Learn<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">入門</a></li>
          <li><a href="/guides" class="active">ドキュメント</a></li>
          <li><a href="/userstories/" class="">ユーザーストーリー</a></li>  
          <li><a href="/qtips" class="">"Q" Tipsビデオ</a></li>          
          <li><a href="/books" class="">書籍</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="#">Extensions<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
<li><a href="https://quarkus.io/extensions/" class="">エクステンションを探す</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">エクステンションの使用</a></li>
          <li><a href="/guides/writing-extensions" class="">エクステンションの作成</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">エクステンションの共有</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="#">Community<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">サポート</a></li>
          <li><a href="/blog" class="">ブログ</a></li>
          <li><a href="/discussion" class="">ディスカッション</a></li>
          <li><a href="/working-groups" class="">ワーキンググループ</a></li>
          <li><a href="/insights" class="">ポッドキャスト</a></li>
          <li><a href="/events" class="">イベント</a></li>
          <li><a href="/newsletter" class="">ニュースレター</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ロードマップ</a></li>
          <li><a href="/benefactors" class="">BENEFACTORS</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary
white">コーディングを開始</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/version/main/guides/cdi-reference" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/version/main/guides/cdi-reference">ポルトガル（BR）</a></li>
          <li><a href="https://es.quarkus.io/version/main/guides/cdi-reference">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/version/main/guides/cdi-reference">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/version/main/guides/cdi-reference">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas
fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    







<section class="full-width-version-bg flexfilterbar guides">
  <div class="guideflexcontainer">
    <div class="docslink">
      <a class="returnlink" href="/version/main/guides/"> Back to Guides</a>
    </div>
    <div class="flexlabel">
      <label>バージョン:</label>
    </div>
    <div class="guidepulldown version">
    <select id="guide-version-dropdown">
      
        
        
        <option value="main" selected>Main - SNAPSHOT</option>
        
        
        
        <option value="latest" >3.31.3 - Latest</option>
        
        
        
        <option value="3.27" >3.27</option>
        
        
        
        <option value="3.20" >3.20</option>
        
        
        
        <option value="3.15" >3.15</option>
        
        
        
        <option value="3.8" >3.8</option>
        </select>
    </div>
  </div>
</section>

<div class="guide">
  <div class="grid-wrapper">
    <div class="grid__item width-8-12 width-12-12-m">
      
      <a class="editlink" href="https://github.com/quarkusio/quarkus/edit/main/docs/src/main/asciidoc/cdi-reference.adoc">このページを編集</a>
      
      <h1 class="text-caps">コンテキストと依存性インジェクション </h1>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus DI ソリューション (ArC とも呼ばれる) は、 <a href="https://jakarta.ee/specifications/cdi/4.1/jakarta" class="bare">https://jakarta.ee/specifications/cdi/4.1/jakarta</a> -cdi-spec-4.1.html[Jakarta コンテキストと依存性の注入 4.1、window="_blank"] 仕様に基づいています。
CDI Lite 仕様を実装し、その上に厳選された改良を加え、CDI Lite TCK に合格しました。
CDI Full は実装されていません。
<a href="#supported_features_and_limitations">the list of supported features and limitations</a> も参照してください。
既存の CDI コードのほとんどは問題なく動作するはずですが、Quarkus のアーキテクチャーと目標に起因する小さな違いがいくつかあります。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
CDI が初めての方は、最初に <a href="cdi">コンテキストと依存性注入(CDI)の紹介</a> を読むことを推奨します。
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<a href="cdi-integration">CDI インテグレーションガイド</a> には、一般的な CDI 関連のインテグレーションのユースケースとソリューションのサンプルコードの詳細が記載されています。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bean_discovery"><a class="anchor" href="#bean_discovery"></a>1. Bean の検出</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CDI での Bean 検出は、従来のデプロイメント構造と、基盤となるモジュールアーキテクチャーのアクセシビリティー要件が関係する複雑なプロセスです。
ただし、Quarkus は <strong>簡略化された Bean 検出</strong> を使用しています。
<a href="https://jakarta.ee/specifications/cdi/4.1/jakarta" class="bare">https://jakarta.ee/specifications/cdi/4.1/jakarta</a> -cdi-spec-4.1.html#default_bean_discovery[bean 検出モード <code>annotated</code>、window="_blank"] および可視性境界のない単一の Bean アーカイブのみが存在します。</p>
</div>
<div class="paragraph">
<p>Bean のアーカイブは、次のものから合成されます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>アプリケーションクラス</p>
</li>
<li>
<p><code>beans.xml</code> 記述子を含む依存関係 (内容は無視される)</p>
</li>
<li>
<p>Jandex インデックスを含む依存関係 (<code>META-INF/jandex.idx</code>)</p>
</li>
<li>
<p><code>application.properties</code> の <code>quarkus.index-dependency</code> で参照される依存関係</p>
</li>
<li>
<p>Quarkus の統合コード</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="https://jakarta.ee/specifications/cdi/4.1/jakarta" class="bare">https://jakarta.ee/specifications/cdi/4.1/jakarta</a> -cdi-spec-4.1.html#bean_defining_annotations[bean 定義アノテーション、window="_blank"] のない Bean クラスは検出されません。
この動作は CDI によって定義されます。
ただし、宣言クラスに Bean 定義アノテーションが付けられていない場合でも、プロデューサーメソッドとフィールドおよびオブザーバーメソッドは検出されます (この動作は CDI で定義されているものと異なります)。
実際、宣言する Bean クラスは <code>@Dependent</code> でアノテーションが付けられていると見なされます。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Quarkus エクステンションは、追加のディスカバリールールを宣言することができます。たとえば、 <code>@Scheduled</code> ビジネスメソッドは、宣言するクラスが Bean 定義アノテーションでアノテーションされていなくても登録されます。
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="how-to-generate-a-jandex-index"><a class="anchor" href="#how-to-generate-a-jandex-index"></a>1.1. Jandex インデックスを生成する方法</h3>
<div class="paragraph">
<p>A dependency with a Jandex index is automatically scanned for beans.
To generate the index, just add the following plugin to your build file:</p>
</div>
<div class="sidebarblock primary asciidoc-tabs-sync-maven">
<div class="content">
<div class="title">Maven</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;io.smallrye&lt;/groupId&gt;
      &lt;artifactId&gt;jandex-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;3.5.3&lt;/version&gt;
      &lt;executions&gt;
        &lt;execution&gt;
          &lt;id&gt;make-index&lt;/id&gt;
          &lt;goals&gt;
            &lt;goal&gt;jandex&lt;/goal&gt;
          &lt;/goals&gt;
        &lt;/execution&gt;
      &lt;/executions&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sidebarblock secondary asciidoc-tabs-sync-gradle-groovy">
<div class="content">
<div class="title">Gradle (Groovy DSL)</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-groovy hljs" data-lang="groovy">plugins {
    id 'org.kordamp.gradle.jandex' version '2.3.0'
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>最新のプラグインバージョンは、 <a href="https://plugins.gradle.org/plugin/org.kordamp.gradle.jandex">Gradle プラグインポータル</a> で確認できます。</p>
</div>
</div>
</div>
<div class="sidebarblock secondary asciidoc-tabs-sync-gradle-kotlin">
<div class="content">
<div class="title">Gradle (Kotlin DSL)</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-kotlin hljs" data-lang="kotlin">plugins {
    id("org.kordamp.gradle.jandex") version "2.3.0"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>最新のプラグインバージョンは、 <a href="https://plugins.gradle.org/plugin/org.kordamp.gradle.jandex">Gradle プラグインポータル</a> で確認できます。</p>
</div>
</div>
</div>
<div class="paragraph">
<p>依存関係を変更できなくても、 <code>quarkus.index-dependency</code> エントリーを <code>application.properties</code> に追加することでインデックスを作成できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.index-dependency.&lt;name&gt;.group-id=
quarkus.index-dependency.&lt;name&gt;.artifact-id=(this one is optional)
quarkus.index-dependency.&lt;name&gt;.classifier=(this one is optional)</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>artifact-id</code> が指定されていない場合は、 <code>group-id</code> が指定された依存関係はすべてインデックス化されます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>たとえば、次のエントリーは、 <code>org.acme:acme-api</code> 依存関係が確実にインデックス化されるようにします。</p>
</div>
<div class="listingblock">
<div class="title">application.properties の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.index-dependency.acme.group-id=org.acme <i class="conum" data-value="1"></i><b>(1)</b>
quarkus.index-dependency.acme.artifact-id=acme-api <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>値 <code>acme</code> は、名前で識別される依存関係のグループ ID です。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>値は、名前 <code>acme</code> で識別される依存関係のアーティファクト ID です。</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="how-to-exclude-types-and-dependencies-from-discovery"><a class="anchor" href="#how-to-exclude-types-and-dependencies-from-discovery"></a>1.2. ディスカバリーから型と依存関係を除外する方法</h3>
<div class="paragraph">
<p>サードパーティーのライブラリーからのいくつかの Bean が Quarkus で正しく動作しないことがあります。典型的な例は、ポータブルエクステンションを注入する Bean です。このような場合は、型や依存関係を Bean の検出から除外することができます。 <code>quarkus.arc.exclude-types</code> プロパティーは、除外すべきクラスに一致するために使用される文字列値のリストを受け入れます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. 値の例</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">値</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.acme.Foo</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">クラスの完全修飾名と一致させる</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.acme.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.acme</code> パッケージとクラスを一致させる</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.acme.**</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">パッケージが <code>org.acme</code> で始まるクラスを一致させる</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">クラスのシンプルな名前に一致する</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">application.properties の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.arc.exclude-types=org.acme.Foo,org.acme.*,Bar <i class="conum" data-value="1"></i><b>(1)</b><i class="conum" data-value="2"></i><b>(2)</b><i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>タイプ <code>org.acme.Foo</code> を除外します。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>org.acme</code> パッケージからすべてのタイプを除外します。</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>シンプルな名前が <code>Bar</code> であるすべてのタイプを除外します。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>また、除外しなければ Bean をスキャンする、依存関係のあるアーティファクトを除外することも可能です。たとえば、 <code>beans.xml</code> 記述子を含んでいる場合です。</p>
</div>
<div class="listingblock">
<div class="title">application.properties の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.arc.exclude-dependency.acme.group-id=org.acme <i class="conum" data-value="1"></i><b>(1)</b>
quarkus.arc.exclude-dependency.acme.artifact-id=acme-services <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>値 <code>acme</code> は、名前で識別される依存関係のグループ ID です。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>値は、名前 <code>acme</code> で識別される依存関係のアーティファクト ID です。</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="string-based-qualifiers"><a class="anchor" href="#string-based-qualifiers"></a>2. String-Based Qualifiers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>@Named</code> qualifier, which you might be familiar with, is a <em>string-based qualifier</em>.
That is, it&#8217;s the string value of the qualifier annotation who determines whether the qualifier matches or not.
This is not type-safe and should not be the norm in CDI applications.
Specific qualifier types should be preferred.</p>
</div>
<div class="paragraph">
<p>However, sometimes string-based qualifiers are necessary.
In that case, avoid the <code>@Named</code> qualifier, because in CDI, it works differently to all other qualifiers.</p>
</div>
<div class="paragraph">
<p>Specifically: if the only qualifier a bean has is <code>@Named</code>, it also automatically gets <code>@Default</code>.
This means that if multiple beans of the same type exist, one of them without qualifiers and the others with <code>@Named</code>, they <em>all</em> get the <code>@Default</code> qualifier and bean resolution will error with ambiguity.
For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class Producers {
    @Produces
    MyBean produce() {
        ...
    }

    @Produces
    @Named("foo")
    MyBean produceFoo() {
        ...
    }
}

@ApplicationScoped
public class Consumer {
    @Inject
    MyBean bean;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the <code>Consumer#bean</code> injection point will cause ambiguity error, because both <code>MyBean</code> producers will have the <code>@Default</code> qualifier.</p>
</div>
<div class="paragraph">
<p>Instead of <code>@Named</code>, use <code>@io.smallrye.common.annotation.Identifier</code>.
This is a regular qualifier that works like all others.
So if we rewrite the example to use <code>@Identifier</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class Producers {
    @Produces
    MyBean produce() {
        ...
    }

    @Produces
    @Identifier("foo")
    MyBean produceFoo() {
        ...
    }
}

@ApplicationScoped
public class Consumer {
    @Inject
    MyBean bean;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Only the first producer will get the <code>@Default</code> qualifier, the second will not.
Hence, there will be no error, and everything will work as expected.</p>
</div>
<div class="sect2">
<h3 id="when-to-use-named"><a class="anchor" href="#when-to-use-named"></a>2.1. When To Use <code>@Named</code>?</h3>
<div class="paragraph">
<p>There is one case where <code>@Named</code> is the right thing to use: specifying an external identifier for a different language that doesn&#8217;t support dependency injection directly.</p>
</div>
<div class="paragraph">
<p>例えば、以下のようになります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
@Named("myBean")
public class MyBean {
    public String getValue() {
        ...
    }
}

@ApplicationScoped
public class Consumer {
    @Inject
    MyBean bean;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As you can see, in the application code, the bean is injected without a qualifier.
The bean name is only used to refer to the bean in the other language.</p>
</div>
<div class="paragraph">
<p>Historically, the most common external language that used bean names was JSF.
In Quarkus, we have <a href="qute-reference#injecting-beans-directly-in-templates">Qute</a>.
In a Qute template, one would refer to the bean using its name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">The current value is {inject:myBean.value}.</code></pre>
</div>
</div>
<div class="paragraph">
<p>Outside of this use-case, just use <code>@Identifier</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="native-executables-and-private-members"><a class="anchor" href="#native-executables-and-private-members"></a>3. ネイティブ実行可能ファイルとプライベートメンバー</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus is using GraalVM to build a native executable.
One of the limitations of GraalVM is the usage of <a href="https://www.graalvm.org/jdk21/reference-manual/native-image/Reflection/" target="_blank" rel="noopener">Reflection</a>.
Reflective operations are supported, but all relevant members must be registered for reflection explicitly.
Those registrations result in a bigger native executable.</p>
</div>
<div class="paragraph">
<p>And if Quarkus DI needs to access a private member it, <strong>has to use reflection</strong>.
That&#8217;s why Quarkus users are encouraged <em>not to use private members</em> in their beans.
This involves injection fields, constructors and initializers, observer methods, producer methods and fields, disposers, and interceptor methods.</p>
</div>
<div class="paragraph">
<p>プライベートメンバーの使用を回避するには、package-private 修飾子を使うことができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class CounterBean {

    @Inject
    CounterService counterService; <i class="conum" data-value="1"></i><b>(1)</b>

    void onMessage(@Observes Event msg) { <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>package-private injection フィールド。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>package-private observer メソッド。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>あるいはコンストラクターの注入。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class CounterBean {

    private CounterService service;

    CounterBean(CounterService service) { <i class="conum" data-value="1"></i><b>(1)</b>
      this.service = service;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>パッケージプライベートコンストラクター挿入。この特定の場合、 <code>@Inject</code> は任意です。</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="supported_features_and_limitations"><a class="anchor" href="#supported_features_and_limitations"></a>4. <a id="supported_features"></a><a id="limitations"></a> サポートされている機能と制限</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CDI Lite 仕様は完全にサポートされています。
CDI Full の次の機能もサポートされています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>デコレーター</p>
<div class="ulist">
<ul>
<li>
<p><code>Event</code> などのビルトイン Bean の装飾はサポートされていません</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>BeanManager</code></p>
<div class="ulist">
<ul>
<li>
<p><code>BeanContainer</code> メソッドに加えて、 <code>getInjectableReference()</code>、 <code>resolveDecorators()</code> のメソッドがサポートされています。</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>@SessionScoped</code></p>
<div class="ulist">
<ul>
<li>
<p>Undertow エクステンションのみ。詳細は <a href="cdi#bean-scope-available">こちら</a> を参照してください。</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><em>メソッド呼び出し</em> 実装は非同期メソッドをサポートします。
次のメソッドは非同期とみなされ、 <code>@Dependent</code> インスタンスは非同期アクションが完了したときにのみ破棄されます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>戻り値の型として <code>CompletionStage</code>、 <code>Uni</code>、または <code>Multi</code> を宣言するメソッド</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
これらの追加機能は、CDI Lite TCK では対応していません。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="nonstandard_features"><a class="anchor" href="#nonstandard_features"></a>5. 標準外の機能</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="eager-instantiation-of-beans"><a class="anchor" href="#eager-instantiation-of-beans"></a>5.1. Bean の即時インスタンス化</h3>
<div class="sect3">
<h4 id="lazy_by_default"><a class="anchor" href="#lazy_by_default"></a>5.1.1. デフォルトではレイジー</h4>
<div class="paragraph">
<p>デフォルトでは、CDI Bean は必要なときに作成されます。何を正確に「必要とされる」かは、Bean のスコープに依存します。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>挿入されたインスタンス (仕様による文脈参照) からメソッドが呼び出される場合は、<strong>通常のスコープ付き Bean</strong> (<code>@ApplicationScoped</code>、 <code>@RequestScoped</code> など) が必要になります。</p>
<div class="paragraph">
<p>言い換えれば、通常のスコープ付き Bean を挿入しても、Bean のコンテキストインスタンスの代わりに <em>クライアントプロキシー</em> が挿入されるため、十分ではありません。</p>
</div>
</li>
<li>
<p>挿入時に <strong>疑似スコープを持つ Bean</strong> (<code>@Dependent</code> および <code>@Singleton</code>) が作成されます。</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title">遅延インスタンス化の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Singleton // =&gt; pseudo-scope
class AmazingService {
  String ping() {
    return "amazing";
  }
}

@ApplicationScoped // =&gt; normal scope
class CoolService {
  String ping() {
    return "cool";
  }
}

@Path("/ping")
public class PingResource {

  @Inject
  AmazingService s1; <i class="conum" data-value="1"></i><b>(1)</b>

  @Inject
  CoolService s2; <i class="conum" data-value="2"></i><b>(2)</b>

  @GET
  public String ping() {
    return s1.ping() + s2.ping(); <i class="conum" data-value="3"></i><b>(3)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>挿入は、 <code>AmazingService</code> のインスタンス化をトリガーします。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>インジェクション自体は、 <code>CoolService</code> のインスタンス化にはなりません。クライアントプロキシーが挿入されます。</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>挿入されたプロキシーに対する最初の呼び出しは、 <code>CoolService</code> のインスタンス化をトリガーします。</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="startup_event"><a class="anchor" href="#startup_event"></a>5.1.2. スタートアップイベント</h4>
<div class="paragraph">
<p>However, if you really need to instantiate a bean eagerly, you can:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>StartupEvent</code> のオブザーバーを宣言します。この場合、Bean のスコープは重要ではありません。</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
class CoolService {
  void startup(@Observes StartupEvent event) { <i class="conum" data-value="1"></i><b>(1)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>CoolService</code> は、起動時に作成され、オブザーバーメソッドの呼び出しを処理します。</td>
</tr>
</table>
</div>
</li>
<li>
<p><code>StartupEvent</code> のオブザーバーで Bean を使用します - <a href="#lazy_by_default">デフォルトではレイジー</a> で説明されているように、通常のスコープの Bean を使用する必要があります。</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Dependent
class MyBeanStarter {

  void startup(@Observes StartupEvent event, AmazingService amazing, CoolService cool) { <i class="conum" data-value="1"></i><b>(1)</b>
    cool.toString(); <i class="conum" data-value="2"></i><b>(2)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>AmazingService</code> は注入時に作成されます。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>CoolService</code> は通常のスコープ付き Bean であるため、強制的にインスタンス化するために挿入されたプロキシーにメソッドを呼び出さなければなりません。</td>
</tr>
</table>
</div>
</li>
<li>
<p><a href="lifecycle#startup_annotation">Startup annotation</a>: で説明したように、 <code>@io.quarkus.runtime.Startup</code> で Bean をアノテーションします。</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Startup <i class="conum" data-value="1"></i><b>(1)</b>
@ApplicationScoped
public class EagerAppBean {

   private final String name;

   EagerAppBean(NameGenerator generator) { <i class="conum" data-value="2"></i><b>(2)</b>
     this.name = generator.createName();
   }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@Startup</code>  でアノテーションされた各Beanに対して、 <code>StartupEvent</code>  の合成オブザーバが生成されます。デフォルトの優先度が使用されます。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Beanのコンストラクタは、アプリケーションの起動時に呼び出され、結果として得られるコンテキストインスタンスがアプリケーションのコンテキストに格納されます。</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Quarkus ユーザーは、<a href="lifecycle">Application Initialization and Termination</a> のガイドで説明されているように、常に <code>@Initialized(ApplicationScoped.class)</code> よりも <code>@Observes StartupEvent</code> を選択することが推奨されます。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="request-context-lifecycle"><a class="anchor" href="#request-context-lifecycle"></a>5.2. リクエストコンテキストのライフサイクル</h3>
<div class="paragraph">
<p>リクエストコンテキストもアクティブになっています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>同期オブザーバメソッドの通知中に</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>リクエストコンテキストは破棄されます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>通知が開始したときにまだアクティブではなかった場合はイベントのオブザーバー通知が完了した後</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
オブザーバー通知のためにリクエストコンテキストが初期化されると、修飾子 <code>@Initialized(RequestScoped.class)</code> を持つイベントが発生します。さらに、修飾子 <code>@BeforeDestroyed(RequestScoped.class)</code> および <code>@Destroyed(RequestScoped.class)</code> を持つイベントは、リクエストコンテキストが破棄されたときに発生します。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="how-to-enable-trace-logging-for-request-context-activation"><a class="anchor" href="#how-to-enable-trace-logging-for-request-context-activation"></a>5.2.1. リクエストコンテキストのアクティブ化のトレースログを有効にする方法</h4>
<div class="paragraph">
<p>ロガー <code>io.quarkus.arc.requestContext</code> の <code>TRACE</code> レベルを設定し、後でログ出力の分析を試みることができます。</p>
</div>
<div class="listingblock">
<div class="title"><code>application.properties</code> の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.log.category."io.quarkus.arc.requestContext".min-level=TRACE <i class="conum" data-value="1"></i><b>(1)</b>
quarkus.log.category."io.quarkus.arc.requestContext".level=TRACE</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>また、関連するカテゴリーの最小ログレベルを調整する必要があります。</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="qualified-injected-fields"><a class="anchor" href="#qualified-injected-fields"></a>5.3. 修飾された注入フィールド</h3>
<div class="paragraph">
<p>CDI では、フィールド注入ポイントを宣言する場合は <code>@Inject</code> と任意で修飾子のセットを使用する必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @Inject
  @ConfigProperty(name = "cool")
  String coolProperty;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Quarkus では、注入されたフィールドが少なくとも 1 つの修飾子を宣言している場合は、 <code>@Inject</code> アノテーションを完全にスキップすることができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">  @ConfigProperty(name = "cool")
  String coolProperty;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
後述する特別なケースを除いて、コンストラクターとメソッドの注入には <code>@Inject</code> が必要です。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="simplified-constructor-injection"><a class="anchor" href="#simplified-constructor-injection"></a>5.4. 簡略化されたコンストラクター注入</h3>
<div class="paragraph">
<p>CDI では、通常のスコープ付き Bean は常に no-args コンストラクターを宣言しなければなりません (このコンストラクターは、他のコンストラクターを宣言しない限り、通常はコンパイラーによって生成されます)。しかし、この要件はコンストラクターの注入を複雑にします。CDI で動作させるためにはダミーの no-args コンストラクターを提供する必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class MyCoolService {

  private SimpleProcessor processor;

  MyCoolService() { // dummy constructor needed
  }

  @Inject // constructor injection
  MyCoolService(SimpleProcessor processor) {
    this.processor = processor;
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Quarkus では、通常のスコープ付き Bean のためにダミーのコンストラクターを宣言する必要はありません。自動的に生成されます。また、コンストラクターが 1 つしかない場合は、 <code>@Inject</code> の必要性はありません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class MyCoolService {

  private SimpleProcessor processor;

  MyCoolService(SimpleProcessor processor) {
    this.processor = processor;
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
no-args コンストラクターを宣言していないクラスを Bean クラスが継承している場合は、no-args コンストラクターは自動的に生成されません。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="remove_unused_beans"><a class="anchor" href="#remove_unused_beans"></a>5.5. 未使用の Bean の削除</h3>
<div class="paragraph">
<p>コンテナーは、デフォルトでビルド中に未使用の Bean、インターセプター、デコレーターをすべて削除しようとします。この最適化は、生成されるクラスの量を最小限に抑え、メモリーを節約するのに役立ちます。ただし、Quarkus は、 <code>CDI.current()</code> staticメソッドを介して実行されたプログラムによるルックアップを検出できません。したがって、削除すると誤検知エラーが発生する可能性があります。つまり、Bean は実際に使用されていても、削除されます。このような場合、ログに大きな警告が表示されます。ユーザーとエクステンションの作成者にはいくつかのオプションがあります: <a href="#eliminate_false_positives">how to eliminate false positives</a>。</p>
</div>
<div class="paragraph">
<p>The optimization can be disabled by setting <code>quarkus.arc.remove-unused-beans</code> to <code>none</code> or <code>false</code>.
Quarkus also provides a middle ground where application beans are never removed, whether or not they are unused, while the optimization proceeds normally for non application classes.
To use this mode, set <code>quarkus.arc.remove-unused-beans</code> to <code>fwk</code> or <code>framework</code>.</p>
</div>
<div class="sect3">
<h4 id="whats-removed"><a class="anchor" href="#whats-removed"></a>5.5.1. 何が削除されましたか?</h4>
<div class="paragraph">
<p>Quarkusはまず、依存関係ツリーのルートを形成する、いわゆる <em>削除不可能な</em> Beanを特定します。良い例は、Jakarta RESTリソースクラスや、 <code>@Scheduled</code> メソッドを宣言している Bean です。</p>
</div>
<div class="paragraph">
<p><em>unremovable</em> Bean:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#eliminate_false_positives">excluded from removal</a>、または</p>
</li>
<li>
<p><code>@Named</code> を通して指定された名前を持っているか、</p>
</li>
<li>
<p>オブザーバーメソッドを宣言している場合。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>_未使用の_Bean:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>unremovable</em> ではなく、</p>
</li>
<li>
<p><em>削除不可能</em> な Bean の依存ツリー内のどの注入ポイントにも注入できない。</p>
</li>
<li>
<p>依存関係ツリー内の挿入ポイントへの挿入に適格なプロデューサーを宣言していません。</p>
</li>
<li>
<p><code>jakarta.enterprise.inject.Instance</code> または <code>jakarta.inject.Provider</code> 注入ポイントへの注入には適格ではない。</p>
</li>
<li>
<p><a href="#injecting-multiple-bean-instances-intuitively"><code>@Inject @All List&lt;&gt;</code></a> 注入ポイントに注入する資格がない。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>未使用のインターセプターとデコレーターは、どの Bean とも関連付けられていません。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>開発モード (<code>./mvnw quarkus:dev</code> を実行) を使用すると、削除される Bean に関する詳細情報を確認できます。</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>コンソールで - <code>application.properties</code> で DEBUG レベルを有効にするだけです。例:　<code>quarkus.log.category."io.quarkus.arc.processor".level=DEBUG</code></p>
</li>
<li>
<p>関連する開発 UI ページ</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="eliminate_false_positives"><a class="anchor" href="#eliminate_false_positives"></a>5.5.2. 誤検知を排除する方法</h4>
<div class="paragraph">
<p>ユーザーは、コンテナーに <code>@io.quarkus.arc.Unremovable</code> をアノテーションすることで、(上で指定したルールをすべて満たしていても) 特定の Bean を削除しないように指示することができます。このアノテーションは、クラス、producer メソッド、producer フィールドに置くことができます。</p>
</div>
<div class="paragraph">
<p>これは常に可能ではないので、 <code>application.properties</code> を通して同じことを実現するオプションがあります。 <code>quarkus.arc.unremovable-types</code> プロパティーは、Bean の名前やパッケージに基づいて一致させるための文字列値のリストを受け付けます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. 値の例</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">値</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.acme.Foo</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bean クラスの完全修飾名と一致させる</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.acme.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bean クラスのパッケージが <code>org.acme</code> である Bean に一致します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.acme.**</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bean クラスのパッケージが <code>org.acme</code> で開始する Bean に一致します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bean クラスのシンプルな名前に一致します。</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">application.properties の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.arc.unremovable-types=org.acme.Foo,org.acme.*,Bar</code></pre>
</div>
</div>
<div class="paragraph">
<p>さらに、エクステンションは <code>UnremovableBeanBuildItem</code> を生成することで、可能性のある誤検出を排除することができます。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="default_beans"><a class="anchor" href="#default_beans"></a>5.6. デフォルトの Bean</h3>
<div class="paragraph">
<p>Quarkus は、CDI が現在サポートしていない機能を追加します。これは、利用可能な手段 (Beanクラス、producer、合成 Bean など) で同等の型と修飾子を持つ他の Bean が宣言されていない場合に、条件付きで Bean を宣言することです。これは、 <code>@io .quarkus.Arc.DefaultBean</code> アノテーションを使用して行われ、例を挙げて説明するのが最善です。</p>
</div>
<div class="paragraph">
<p>Say there is a Quarkus extension that, among other things, declares a few CDI beans like the following code does:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Dependent
public class TracerConfiguration {

    @Produces
    public Tracer tracer(Reporter reporter, Configuration configuration) {
        return new Tracer(reporter, configuration);
    }

    @Produces
    @DefaultBean
    public Configuration configuration() {
        // create a Configuration
    }

    @Produces
    @DefaultBean
    public Reporter reporter(){
        // create a Reporter
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>アイデアは、エクステンションがユーザーのために自動設定を行い、多くのボイラープレートを排除するということです。必要な場所であれば、 <code>@Inject</code> を <code>Tracer</code> にすることができます。私たちのアプリケーションで、設定された <code>Tracer</code> を利用しようとする場合は、、カスタムの <code>Reporter</code> を提供するなど、少しカスタマイズする必要があります。アプリケーションで必要になるのは、次のようなものだけです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Dependent
public class CustomTracerConfiguration {

    @Produces
    public Reporter reporter(){
        // create a custom Reporter
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@DefaultBean</code> では、エクステンション (またはそのための他のコード) が Quarkus がサポートする何らかの方法でその型の Bean が提供されている場合、バックオフ中にデフォルトを提供することができます。</p>
</div>
<div class="paragraph">
<p>デフォルトの Bean はオプションで <code>@jakarta.annotation.Priority</code> を宣言できます。
優先度が定義されていない場合は、 <code>@Priority (0)</code> が想定されます。
優先度の値は、Bean の順序付けと、複数の一致するデフォルト Bean の曖昧さを解消するための型安全な解決に使用されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Dependent
public class CustomizedDefaultConfiguration {

    @Produces
    @DefaultBean
    @Priority(100)
    public Configuration customizedConfiguration(){
        // create a customized default Configuration
        // this will have priority over previously defined default bean
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="enable_build_profile"><a class="anchor" href="#enable_build_profile"></a>5.7. Quarkus ビルドプロファイルの Bean の有効化</h3>
<div class="paragraph">
<p>Quarkus adds a capability that CDI currently does not support, which is to conditionally enable a bean when a Quarkus build time profile is enabled,
via the <code>@io.quarkus.arc.profile.IfBuildProfile</code> and <code>@io.quarkus.arc.profile.UnlessBuildProfile</code> annotations.
When used in conjunction with <code>@io.quarkus.arc.DefaultBean</code>, these annotations allow for the creation of different bean configurations for different build profiles.</p>
</div>
<div class="paragraph">
<p>Imagine, for instance that an application contains a bean named <code>Tracer</code>, which needs to do nothing when in tests or in dev mode, but works in its normal capacity for the production artifact.
An elegant way to create such beans is the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Dependent
public class TracerConfiguration {

    @Produces
    @IfBuildProfile("prod")
    public Tracer realTracer(Reporter reporter, Configuration configuration) {
        return new RealTracer(reporter, configuration);
    }

    @Produces
    @DefaultBean
    public Tracer noopTracer() {
        return new NoopTracer();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>代わりに、 <code>Tracer</code> Bean も開発モードで動作し、デフォルトではテストのために何もしないことが要求される場合は、 <code>@UnlessBuildProfile</code> が理想的です。コードは次のようになります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Dependent
public class TracerConfiguration {

    @Produces
    @UnlessBuildProfile("test") // this will be enabled for both prod and dev build time profiles
    public Tracer realTracer(Reporter reporter, Configuration configuration) {
        return new RealTracer(reporter, configuration);
    }

    @Produces
    @DefaultBean
    public Tracer noopTracer() {
        return new NoopTracer();
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
実行時プロファイルは、 <code>@IfBuildProfile</code> および <code>@UnlessBuildProfile</code> を使用した Bean 解決には影響を及ぼしません。
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>@IfBuildProfile</code> and <code>@UnlessBuildProfile</code> may be put on a stereotype.
A bean will only be enabled if <strong>all</strong> the conditions defined by these annotations are satisfied.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="enable_build_properties"><a class="anchor" href="#enable_build_properties"></a>5.8. Quarkus ビルドプロパティーの Bean を有効にする</h3>
<div class="paragraph">
<p>Quarkus は、CDI が現在サポートしていない機能を追加します。これは、Quarkus のビルド時のプロパティーに特定の値がある場合とない場合に、 <code>@io.quarkus.arc.properties.IfBuildProperty</code> および <code>@io.quarkus.arc.properties.UnlessBuildProperty</code> アノテーションを介して
条件付きで Bean を有効にする機能です。
これらのアノテーションを <code>@io.quarkus.arc.DefaultBean</code> と組み合わせて使用すると、異なるビルドプロパティーに対して異なる Bean 設定を作成できます。</p>
</div>
<div class="paragraph">
<p><code>Tracer</code> を使用して上で述べたシナリオも、以下のように実装することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Dependent
public class TracerConfiguration {

    @Produces
    @IfBuildProperty(name = "some.tracer.enabled", stringValue = "true")
    public Tracer realTracer(Reporter reporter, Configuration configuration) {
        return new RealTracer(reporter, configuration);
    }

    @Produces
    @DefaultBean
    public Tracer noopTracer() {
        return new NoopTracer();
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>@IfBuildProperty</code> and <code>@UnlessBuildProperty</code> are repeatable annotations and may be put on a stereotype.
A bean will only be enabled if <strong>all</strong> the conditions defined by these annotations are satisfied.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>代わりに、 <code>some.tracer.enabled</code> プロパティーが <code>false</code> でない場合にのみ <code>RealTracer</code> Bean が使用されることが要求される場合は、 <code>@UnlessBuildProperty</code> が理想的です。コードは以下のようになります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Dependent
public class TracerConfiguration {

    @Produces
    @UnlessBuildProperty(name = "some.tracer.enabled", stringValue = "false")
    public Tracer realTracer(Reporter reporter, Configuration configuration) {
        return new RealTracer(reporter, configuration);
    }

    @Produces
    @DefaultBean
    public Tracer noopTracer() {
        return new NoopTracer();
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Properties set at runtime have absolutely no effect on the bean resolution using <code>@IfBuildProperty</code> / <code>@UnlessBuildProperty</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="declaring-selected-alternatives"><a class="anchor" href="#declaring-selected-alternatives"></a>5.9. 選択された代替の宣言</h3>
<div class="paragraph">
<p>In CDI, an alternative bean may be selected either globally for an application by means of <code>@Priority</code>, or for a bean archive using a <code>beans.xml</code> descriptor.
Quarkus has a simplified bean discovery, and the content of <code>beans.xml</code> is ignored.</p>
</div>
<div class="paragraph">
<p>However, it is also possible to select alternatives for an application using the unified configuration.
The <code>quarkus.arc.selected-alternatives</code> property accepts a list of string values that are used to match alternative beans.
If any value matches, then the priority of <code>Integer#MAX_VALUE</code> is used for the relevant bean.
The priority declared via <code>@Priority</code> or inherited from a stereotype is overridden.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. 値の例</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">値</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.acme.Foo</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bean クラス、または producer を宣言する Bean の Bean クラスの完全修飾名に一致します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.acme.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bean クラスのパッケージが <code>org.acme</code> である Bean に一致します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.acme.**</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bean クラスのパッケージが <code>org.acme</code> で開始する Bean に一致します。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Bar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bean クラス、または producer を宣言する Bean の Bean クラスの単純名に一致します。</p></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="title">application.properties の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.arc.selected-alternatives=org.acme.Foo,org.acme.*,Bar</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="simplified-producer-method-declaration"><a class="anchor" href="#simplified-producer-method-declaration"></a>5.10. 簡略化された Producer メソッドの宣言</h3>
<div class="paragraph">
<p>CDI では、producer メソッドは常に <code>@Produces</code> とアノテーションされていなければなりません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">class Producers {

  @Inject
  @ConfigProperty(name = "cool")
  String coolProperty;

  @Produces
  @ApplicationScoped
  MyService produceService() {
    return new MyService(coolProperty);
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Quarkus では、producer メソッドにスコープアノテーション、ステレオタイプ、または修飾子が付いている場合は、 <code>@Produces</code> アノテーションを完全に省略できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">class Producers {

  @ConfigProperty(name = "cool")
  String coolProperty;

  @ApplicationScoped
  MyService produceService() {
    return new MyService(coolProperty);
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="interception_of_static_methods"><a class="anchor" href="#interception_of_static_methods"></a>5.11. 静的メソッドのインターセプション</h3>
<div class="paragraph">
<p>インターセプターの仕様は、<em>around-invoke</em> メソッドを静的宣言してはならないことは明らかです。しかし、この制限は、主に技術的な制限によって設定されました。Quarkus は追加のクラス変換を可能にするビルド時指向のスタックであるため、この制限は適用されなくなりました。インターセプタ―バインディングで非プライベートの静的メソッドにアノテーションを付けることができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">class Services {

  @Logged <i class="conum" data-value="1"></i><b>(1)</b>
  static BigDecimal computePrice(long amount) { <i class="conum" data-value="2"></i><b>(2)</b>
    BigDecimal price;
    // Perform computations...
    return price;
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>Logged</code> はインターセプターバインディングです。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>各メソッドの呼び出しは、 <code>Logged</code> に関連付けられたインターセプターがある場合に傍受されます。</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="limitations"><a class="anchor" href="#limitations"></a>5.11.1. 制約事項</h4>
<div class="ulist">
<ul>
<li>
<p>下位互換性の理由から <strong>メソッドレベルのバインディング</strong> のみが考慮されます (そうでないとクラスレベルのバインディングを宣言している Bean クラスの静的メソッドが突然傍受されてしまいます)。</p>
</li>
<li>
<p>プライベートなスタティックメソッドは決して傍受されません。</p>
</li>
<li>
<p><code>InvocationContext#getTarget()</code> returns <code>null</code> for obvious reasons; therefore, not all existing interceptors may behave correctly when intercepting static methods</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
インターセプターは <code>InvocationContext.getMethod()</code> を使用して静的メソッドを検出し、それに応じて動作を調整することができます。
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="unproxyable_classes_transformation"><a class="anchor" href="#unproxyable_classes_transformation"></a>5.12. final クラスとメソッドを処理する能力</h3>
<div class="paragraph">
<p>In normal CDI, classes that are marked as <code>final</code> and / or have <code>final</code> methods are not eligible for proxy creation,
which in turn means that interceptors and normal scoped beans don&#8217;t work properly.
This situation is very common when trying to use CDI with alternative JVM languages like Kotlin, where classes and methods are <code>final</code> by default.</p>
</div>
<div class="paragraph">
<p>しかし、Quarkus では、 <code>quarkus.arc.transform-unproxyable-classes</code> を <code>true</code> (デフォルト値) に設定すると、これらの制限を抑制することができます。</p>
</div>
</div>
<div class="sect2">
<h3 id="container-managed-concurrency"><a class="anchor" href="#container-managed-concurrency"></a>5.13. コンテナー管理型の並行処理</h3>
<div class="paragraph">
<p>There is no standard concurrency control mechanism for CDI beans.
Nevertheless, a bean instance can be shared and accessed concurrently from multiple threads.
In that case, it should be thread-safe.
You can use standard Java constructs (<code>volatile</code>, <code>synchronized</code>, <code>ReadWriteLock</code>, etc.) or let the container control the concurrent access.
Quarkus provides <code>@io.quarkus.arc.Lock</code> and a built-in interceptor for this interceptor binding.
Each interceptor instance associated with a contextual instance of an intercepted bean holds a separate <code>ReadWriteLock</code> with non-fair ordering policy.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>io.quarkus.arc.Lock</code> は通常のインターセプターバインディングであるため、任意のスコープを持つ任意の Bean に使用することができます。しかし、特に「共有」スコープ、たとえば <code>@Singleton</code> や <code>@ApplicationScoped</code> に有益です。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">コンテナー管理された並行処理の例</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.quarkus.arc.Lock;

@Lock <i class="conum" data-value="1"></i><b>(1)</b>
@ApplicationScoped
class SharedService {

  void addAmount(BigDecimal amount) {
    // ...changes some internal state of the bean
  }

  @Lock(value = Lock.Type.READ, time = 1, unit = TimeUnit.SECONDS) <i class="conum" data-value="2"></i><b>(2)</b> <i class="conum" data-value="3"></i><b>(3)</b>
  BigDecimal getAmount() {
    // ...it is safe to read the value concurrently
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>クラスで宣言された (<code>@Lock (Lock.type.Write)</code> にマッピングされる) <code>@Lock</code> は、任意のビジネスメソッドの呼び出しに対して Bean インスタンスをロックするようにコンテナーに指示します。つまり、クライアントには「排他アクセス」があり、同時呼び出しは許可されません。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>@Lock(Lock.Type.READ)</code> は、クラスレベルで指定された値を上書きします。これは、Bean のインスタンスが <code>@Lock(Lock.Type.WRITE)</code> によってロックされていない限り、任意の数のクライアントが同時にメソッドを呼び出すことができることを意味します。</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>また、「待ち時間」を指定することもできます。指定した時間内にロックを取得できない場合は <code>LockException</code> が発生します。</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="repeatable-interceptor-bindings"><a class="anchor" href="#repeatable-interceptor-bindings"></a>5.14. 反復可能なインターセプターバインディング</h3>
<div class="paragraph">
<p>Quarkusでは、 <code>@Repeatable</code> インターセプター結合アノテーションのサポートが制限されています。</p>
</div>
<div class="paragraph">
<p>インターセプタ―をコンポーネントにバインドする場合は、メソッドに対して複数の <code>@Repeatable</code> アノテーションを宣言できます。インターセプター仕様との相互作用に関する未解決の質問があるため、クラスとステレオタイプで宣言された反復可能なインターセプターバインディングはサポートされていません。これは将来追加される可能性があります。</p>
</div>
<div class="paragraph">
<p>たとえば、キャッシュをクリアするインターセプタ―があるとします。対応するインターセプタ―バインディングは <code>@CacheInvalidateAll</code> と呼ばれ、 <code>@Repeatable</code> として宣言されます。同時に 2 つのキャッシュをクリアしたい場合は、 <code>@CacheInvalidateAll</code> を 2 回追加します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
class CachingService {
  @CacheInvalidateAll(cacheName = "foo")
  @CacheInvalidateAll(cacheName = "bar")
  void heavyComputation() {
    // ...
    // some computation that updates a lot of data
    // and requires 2 caches to be invalidated
    // ...
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>ここまで、インターセプタ―がどのように使用されるかを説明しました。では、インターセプターを作成するにはどうすれば良いでしょうか。</p>
</div>
<div class="paragraph">
<p>インターセプタ―のインターセプタ―バインディングを宣言する場合は、通常どおり、インターセプタ―クラスに複数の <code>@Repeatable</code> アノテーションを追加できます。 <code>@Cached</code> アノテーションの場合と同様に、アノテーションメンバーが <code>@Nonbinding</code> の場合は役に立ちませんが、それ以外の場合は重要になります。</p>
</div>
<div class="paragraph">
<p>たとえば、メソッド呼び出しを特定のターゲットに自動的に記録できるインターセプタ―があるとします。インターセプタ―バインディングアノテーション <code>@Logged</code> には、ログを保存する場所を指定する <code>target</code> というメンバーがあります。この実装は、コンソールログとファイルロギングに制限することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Interceptor
@Logged(target = "console")
@Logged(target = "file")
class NaiveLoggingInterceptor {
  // ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>他にも、異なるターゲットへのメソッド呼び出しをログに記録するためのインターセプターを提供することができます。</p>
</div>
</div>
<div class="sect2">
<h3 id="caching-the-result-of-programmatic-lookup"><a class="anchor" href="#caching-the-result-of-programmatic-lookup"></a>5.15. プログラムによるルックアップの結果をキャッシュする</h3>
<div class="paragraph">
<p>In certain situations, it is practical to obtain a bean instance programmatically via an injected <code>jakarta.enterprise.inject.Instance</code> and <code>Instance.get()</code>.
However, according to the specification, the <code>get()</code> method must identify the matching bean and obtain a contextual reference.
As a consequence, a new instance of a  <code>@Dependent</code> bean is returned from each invocation of <code>get()</code>.
Moreover, this instance is a dependent object of the injected <code>Instance</code>.
This behavior is well-defined, but it may lead to unexpected errors and memory leaks.
Therefore, Quarkus comes with the <code>io.quarkus.arc.WithCaching</code> annotation.
An injected <code>Instance</code> annotated with this annotation will cache the result of the <code>Instance#get()</code> operation.
The result is computed on the first call, and the same value is returned for all subsequent calls, even for <code>@Dependent</code> beans.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">class Producer {

  AtomicLong nextLong = new AtomicLong();
  AtomicInteger nextInt = new AtomicInteger();

   @Dependent
   @Produces
   Integer produceInt() {
     return nextInt.incrementAndGet();
   }

   @Dependent
   @Produces
   Long produceLong() {
     return nextLong.incrementAndGet();
   }
}

class Consumer {

  @Inject
  Instance&lt;Long&gt; longInstance;

  @Inject
  @WithCaching
  Instance&lt;Integer&gt; intInstance;

  // this method should always return true
  // Producer#produceInt() is only called once
  boolean pingInt() {
    return intInstance.get().equals(intInstance.get());
  }

  // this method should always return false
  // Producer#produceLong() is called twice per each pingLong() invocation
  boolean pingLong() {
    return longInstance.get().equals(longInstance.get());
  }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>io.quarkus.arc.InjectableInstance.clearCache()</code> を使って、キャッシュされた値をクリアすることも可能です。この場合、 <code>jakarta.enterprise.inject.Instance</code> の代わりに Quarkus 固有の <code>io.quarkus.arc.InjectableInstance</code> を注入する必要があります。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="declaratively-choose-beans-that-can-be-obtained-by-programmatic-lookup"><a class="anchor" href="#declaratively-choose-beans-that-can-be-obtained-by-programmatic-lookup"></a>5.16. プログラムによるルックアップで取得できる Bean を宣言的に選択する</h3>
<div class="paragraph">
<p><code>jakarta.enterprise.inject.Instance</code> を介したプログラムによる検索で取得できる Bean の集合を絞り込むことが有用な場合があります。典型的には，ユーザは，実行時設定プロパティに基づいて，インタフェースの適切な実装を選択する必要があります。</p>
</div>
<div class="paragraph">
<p>インターフェイス <code>org.acme.Service</code> を実装した 2 つの Bean があるとします。実装が CDI 修飾子を宣言していない限り、 <code>org.acme.Service</code> を直接注入することはできません。しかし、代わりに <code>Instance&lt;Service&gt;</code> を注入して、すべての実装を繰り返し、正しいものを手動で選択することができます。また、 <code>@LookupIfProperty</code> と <code>@LookupUnlessProperty</code> アノテーションを利用することもできます。 <code>@LookupIfProperty</code> は、実行時設定プロパティーが提供された値と一致する場合にのみ、Bean を取得する必要があることを示します。一方、 <code>@LookupUnlessProperty</code> は、実行時設定プロパティーが提供された値と一致しない場合にのみ、Bean を取得する必要があることを示します。</p>
</div>
<div class="listingblock">
<div class="title"><code>@LookupIfProperty</code> Example</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java"> interface Service {
    String name();
 }

 @LookupIfProperty(name = "service.foo.enabled", stringValue = "true")
 @ApplicationScoped
 class ServiceFoo implements Service {

    public String name() {
       return "foo";
    }
 }

 @ApplicationScoped
 class ServiceBar implements Service {

    public String name() {
       return "bar";
    }
 }

 @ApplicationScoped
 class Client {

    @Inject
    Instance&lt;Service&gt; service;

    void printServiceName() {
       // This will print "bar" if the property "service.foo.enabled" is NOT set to "true"
       // If "service.foo.enabled" is set to "true" then service.get() would result in an AmbiguousResolutionException
       System.out.println(service.get().name());
    }
 }</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>@LookupIfProperty</code> and <code>@LookupUnlessProperty</code> are repeatable annotations and may be put on a stereotype.
A bean will only be obtained if <strong>all</strong> the conditions defined by these annotations are satisfied.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sorting-beans-obtained-with-programmatic-lookup"><a class="anchor" href="#sorting-beans-obtained-with-programmatic-lookup"></a>5.17. プログラムによる検索で取得した Bean のソート</h3>
<div class="paragraph">
<p>必要なタイプと修飾子に一致し、注入の対象となる Bean が複数ある場合は、使用可能な Bean インスタンスを反復処理 (またはストリーム処理) できます。
ストリームメソッドとイテレーターメソッドの両方で返される Bean は、 <code>io.quarkus.arc.InjectableBean#getPriority()</code> で定義された優先順位でソートされます。優先度の高いものが最初に来ます。
優先度が明示的に宣言されていない場合は、0 が想定されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">interface Service {

}

@Priority(100)
@ApplicationScoped
class FirstService implements Service {

}

@Priority(10)
@ApplicationScoped
class SecondService implements Service {

}

@ApplicationScoped
class ThirdService implements Service {

}

@ApplicationScoped
class Client {

   @Inject
   Instance&lt;Service&gt; serviceInstance;

   void printServiceName() {
       if(service.isAmbiguous()){
           for (Service service : serviceInstance) {
                // FirstService, SecondService, ThirdService
           }
       }
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="injecting-multiple-bean-instances-intuitively"><a class="anchor" href="#injecting-multiple-bean-instances-intuitively"></a>5.18. 複数の Bean インスタンスを直感的に注入する</h3>
<div class="paragraph">
<p>CDIでは、 <code>java.lang.Iterable</code> を実装した <code>jakarta.enterprise.inject.Instance</code> を介して、複数のBeanインスタンス（別名：コンテキスト参照）を注入することが可能です。しかし、これは直感的に理解できるものではありません。そこで、Quarkusでは新しい方法を導入しました。 <code>io.quarkus.arc.All</code> 修飾子でアノテーションされた <code>java.util.List</code> を注入することができます。リスト内の要素の型は、検索を実行する際に必要な型として使用されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class Processor {

     @Inject
     @All
     List&lt;Service&gt; services; <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>注入されたインスタンスは、<em>disambiguated</em> bean のコンテキスト参照の <em>immutable list</em> です。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>このインジェクションポイントに必要なタイプは <code>Service</code> であり、追加の修飾子は宣言されていません。</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
リストは、 <code>io.quarkus.arc.InjectableBean#getPriority()</code> で定義された優先度でソートされます。優先度の高いものが最初に来ます。一般に、 <code>@jakarta.annotation.Priority</code> アノテーションを使用して、クラス Bean、プロデューサーメソッド、またはプロデューサーフィールドに優先度を割り当てることができます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>インジェクションポイントが <code>@All</code> 以外の修飾子を宣言していない場合、 <code>@Any</code> が使用されます。つまり、動作は <code>@Inject @Any Instance&lt;Service&gt;</code> と同等です。</p>
</div>
<div class="paragraph">
<p><code>io.quarkus.arc.InstanceHandle</code> でラップされた Bean インスタンスのリストを注入することもできます。これは、関連する Bean メタデータを検査する必要がある場合に役立ちます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class Processor {

     @Inject
     @All
     List&lt;InstanceHandle&lt;Service&gt;&gt; services;

     public void doSomething() {
       for (InstanceHandle&lt;Service&gt; handle : services) {
         if (handle.getBean().getScope().equals(Dependent.class)) {
           handle.get().process();
           break;
         }
       }
     }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
型変数もワイルドカードも <code>@All List&lt;&gt;</code> インジェクションポイントのタイプパラメーターとしては有効ではありません。つまり、 <code>@Inject @All List&lt;?&gt; all</code> はサポートされておらず、デプロイメントエラーになります。
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>Arc.container().listAll()</code> メソッドを使用して、プログラムですべての Bean インスタンスハンドルのリストを取得することもできます。
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="ignoring-class-level-interceptor-bindings-for-methods-and-constructors"><a class="anchor" href="#ignoring-class-level-interceptor-bindings-for-methods-and-constructors"></a>5.19. メソッドとコンストラクターのクラスレベルのインターセプターバインディングを無視する</h3>
<div class="paragraph">
<p>マネージド Bean がクラスレベルでインターセプターバインディングアノテーションを宣言する場合、対応する <code>@AroundInvoke</code> インターセプターがすべてのビジネスメソッドに適用されます。同様に、対応する <code>@AroundConstruct</code> インターセプターが Bean コンストラクターに適用されます。</p>
</div>
<div class="paragraph">
<p>たとえば、 <code>@Logged</code> バインディングアノテーションを持つロギングインターセプターと <code>@Traced</code> バインディングアノテーションを持つトレースインターセプターがあるとします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
@Logged
public class MyService {
    public void doSomething() {
        ...
    }

    @Traced
    public void doSomethingElse() {
        ...
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>この例では、 <code>doSomething</code> と <code>doSomethingElse</code> の両方が架空のロギングインターセプターによってインターセプトされます。さらに、 <code>doSomethingElse</code> メソッドは、架空のトレースインターセプターによってインターセプトされます。</p>
</div>
<div class="paragraph">
<p>もし <code>@Traced</code> インターセプターが必要なロギングもすべて行っていた場合、このメソッドでは <code>@Logged</code> インターセプターを省略したいのですが、他のすべてのメソッドではそのままにしておきたいと思います。これを実現するには、メソッドに <code>@NoClassInterceptors</code> というアノテーションを付けます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Traced
@NoClassInterceptors
public void doSomethingElse() {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>@NoClassInterceptors</code> annotation may be put on methods and constructors, and means that all class-level interceptors are ignored for these methods and constructors.
In other words, if a method/constructor is annotated <code>@NoClassInterceptors</code>, then the only interceptors that will apply to this method/constructor are interceptors declared directly on the method/constructor.</p>
</div>
<div class="paragraph">
<p>このアノテーションは、ビジネスメソッドインターセプター (<code>@AroundInvoke</code>) とコンストラクターライフサイクルコールバックインターセプター (<code>@AroundConstruct</code>) にのみ影響します。</p>
</div>
</div>
<div class="sect2">
<h3 id="exceptions-thrown-by-an-asynchronous-observer-method"><a class="anchor" href="#exceptions-thrown-by-an-asynchronous-observer-method"></a>5.20. 非同期オブザーバーメソッドによって出力される例外</h3>
<div class="paragraph">
<p>非同期オブザーバーによって例外が発生した場合、 <code>fireAsync()</code> メソッドによって返される <code>CompletionStage</code> は例外的に完了し、イベントプロデューサーが適切に対応できるようになります。
ただし、イベントプロデューサーが気にしない場合は、例外は黙って無視されます。
したがって、Quarkus はデフォルトでエラーメッセージをログに記録します。
カスタムの <code>AsyncObserverExceptionHandler</code> を実装することも可能です。
このインターフェイスを実装する Bean は、 <code>@jakarta.inject.Singleton</code> または <code>@jakarta.enterprise.context.ApplicationScoped</code> である必要があります。</p>
</div>
<div class="listingblock">
<div class="title"><code>NoopAsyncObserverExceptionHandler</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Singleton
public class NoopAsyncObserverExceptionHandler implements AsyncObserverExceptionHandler {

  void handle(Throwable throwable, ObserverMethod&lt;?&gt; observerMethod, EventContext&lt;?&gt; eventContext) {
    // do nothing
  }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="intercepted-self-invocation"><a class="anchor" href="#intercepted-self-invocation"></a>5.21. インターセプトされた自己呼び出し</h3>
<div class="paragraph">
<p>Quarkus は、インターセプトされた自己呼び出し (または単に自己インターセプションと呼ぶ) をサポートしています。これは、CDI Bean が、関連付けられているインターセプターをトリガーしながら、別のメソッド内から独自のインターセプトされたメソッドを呼び出すシナリオです。
CDI 仕様では自己インターセプトが機能するかどうかが定義されていないため、これは非標準の機能です。</p>
</div>
<div class="paragraph">
<p>メソッドが 2 つある CDI Bean があり、そのうちの 1 つに <code>@Transactional</code> インターセプターバインディングが関連付けられているとします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ApplicationScoped
public class MyService {

  @Transactional <i class="conum" data-value="1"></i><b>(1)</b>
  void doSomething() {
    // some application logic
  }

  void doSomethingElse() {
    doSomething();<i class="conum" data-value="2"></i><b>(2)</b>
  }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>1 つ以上のインターセプターバインディング。 <code>@Transactional</code> は単なる例です。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>インターセプトされないメソッドが、関連付けられたバインディングを持つ同じ Bean から別のメソッドを呼び出します。これにより、インターセプトがトリガーされます。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>上記の例では、 <code>doSomething()</code> メソッドを呼び出すすべてのコードがインターセプションをトリガーします。この場合、メソッドはトランザクションになります。
これは、呼び出しが <code>MyService</code> Bean (<code>MyService#doSomethingElse</code> など) から直接発生したか、他の Bean から発生したかには関係ありません。</p>
</div>
</div>
<div class="sect2">
<h3 id="intercepting-producer-methods-and-synthetic-beans"><a class="anchor" href="#intercepting-producer-methods-and-synthetic-beans"></a>5.22. インターセプトプロデューサーメソッドと合成 Bean</h3>
<div class="paragraph">
<p>デフォルトでは、インターセプションはマネージド Bean (クラスベース Bean とも呼ばれます) に対してのみサポートされます。
プロデューサーメソッドと合成 Bean のインターセプションをサポートするために、CDI 仕様には <code>InterceptionFactory</code> が含まれていますが、これはランタイム指向の概念であるため、Quarkus ではサポートできません。</p>
</div>
<div class="paragraph">
<p>代わりに、Quarkus には独自の API: <code>InterceptionProxy</code> と <code>@BindingsSource</code> があります。
<code>InterceptionProxy</code> は <code>InterceptionFactory</code> と非常によく似ており、メソッド呼び出しをターゲットインスタンスに転送する前に <code>@AroundInvoke</code> インターセプターを適用するプロキシーを作成します。
<code>@BindingsSource</code> アノテーションを使用すると、インターセプトされたクラスが外部にあり、変更できない場合に、インターセプターバインディングを設定できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.quarkus.arc.InterceptionProxy;

@ApplicationScoped
class MyProducer {
    @Produces
    MyClass produce(InterceptionProxy&lt;MyClass&gt; proxy) { <i class="conum" data-value="1"></i><b>(1)</b>
        return proxy.create(new MyClass()); <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>InterceptionProxy&lt;MyClass&gt;</code> 型の注入ポイントを宣言します。
つまり、ビルド時に、インターセプトと転送を行う <code>MyClass</code> のサブクラスが生成されます。
型引数はプロデューサーメソッドの戻り値の型と同じである必要があることに注意してください。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>指定された <code>MyClass</code> インスタンスのインターセプトプロキシーのインスタンスを作成します。
すべてのインターセプターが実行された後、メソッド呼び出しはこのターゲットインスタンスに転送されます。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>この例では、インターセプターバインディングは <code>MyClass</code> クラスから読み取られます。</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<code>InterceptionProxy</code> は、インターセプタークラスで宣言された <code>@AroundInvoke</code> インターセプターのみをサポートすることに注意してください。
他の種類のインターセプション、およびターゲットクラスとそのスーパークラスで宣言された <code>@AroundInvoke</code> インターセプターはサポートされていません。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>インターセプトされたクラスは <a href="https://jakarta.ee/specifications/cdi/4.1/jakarta" class="bare">https://jakarta.ee/specifications/cdi/4.1/jakarta</a> -cdi-spec-4.1#unproxyable[proxyable] である必要があるため、 <code>final</code> や、プライベート以外の <code>final</code> メソッドを指定できません。また、プライベート以外のゼロパラメーターのコンストラクターを指定する必要があります。
そうでなく、<a href="#unproxyable_classes_transformation">enabled</a> の場合は、バイトコード変換によって修正を試みます。ゼロパラメーターのコンストラクターを追加できない場合もあることに注意してください。</p>
</div>
<div class="paragraph">
<p>生成されたクラスは外部ライブラリーからのものであり、インターセプターバインディングアノテーションがまったく含まれていないことがよくあります。
このようなケースをサポートするには、 <code>InterceptionProxy</code> パラメーターで <code>@BindingsSource</code> アノテーションを宣言します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.quarkus.arc.BindingsSource;
import io.quarkus.arc.InterceptionProxy;

abstract class MyClassBindings { <i class="conum" data-value="1"></i><b>(1)</b>
    @MyInterceptorBinding
    abstract String doSomething();
}

@ApplicationScoped
class MyProducer {
    @Produces
    MyClass produce(@BindingsSource(MyClassBindings.class) InterceptionProxy&lt;MyClass&gt; proxy) { <i class="conum" data-value="2"></i><b>(2)</b>
        return proxy.create(new MyClass());
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>MyClass</code> 構造をミラーリングし、インターセプターバインディングを含むクラス。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>@BindingsSource</code> アノテーションによると、 <code>MyClass</code> のインターセプターバインディングは <code>MyClassBindings</code> から読み取る必要があります。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><em>bindings source</em> の概念は、ビルド時に使いやすい <code>InterceptionFactory.configure()</code> と同等です。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
プロデューサーメソッドインターセプションと合成 Bean インターセプションは、インスタンスメソッドに対してのみ機能します。
<a href="#interception_of_static_methods">静的メソッドのインターセプション</a> はプロデューサーメソッドと合成 Bean ではサポートされていません。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="declaring-bindingssource"><a class="anchor" href="#declaring-bindingssource"></a>5.22.1. <code>@BindingsSource</code> の宣言</h4>
<div class="paragraph">
<p><code>@BindingsSource</code> アノテーションは、インターセプトされたクラスの構造を反映するクラスを指定します。
その後、インターセプターバインディングはそのクラスから読み取られ、インターセプトされたクラスで宣言されているかのように扱われます。</p>
</div>
<div class="paragraph">
<p>具体的には、バインディングソースクラスで宣言されたクラスレベルのインターセプターバインディングは、インターセプトされたクラスのクラスレベルのバインディングとして扱われます。
バインディングソースクラスで宣言されたメソッドレベルのインターセプターバインディングは、インターセプトされたクラスと同じ名前、戻り値の型、パラメーターの型、および <code>static</code> フラグを持つメソッドのメソッドレベルのバインディングとして扱われます。</p>
</div>
<div class="paragraph">
<p>メソッド本体を記述しなくて済むように、バインディングソースクラスとメソッドを <code>abstract</code> にするのが一般的です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">abstract class MyClassBindings {
    @MyInterceptorBinding
    abstract String doSomething();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>このクラスはインスタンス化されることはなく、そのメソッドが呼び出されることもないので、これで問題ありませんが、非 <code>abstract</code> クラスを作成することも可能です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">class MyClassBindings {
    @MyInterceptorBinding
    String doSomething() {
        return null; <i class="conum" data-value="1"></i><b>(1)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>メソッド本体は重要ではありません。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ジェネリッククラスの場合、型変数名も同一である必要があることに注意してください。
たとえば、次のクラスの場合:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">class MyClass&lt;T&gt; {
    T doSomething() {
        ...
    }

    void doSomethingElse(T param) {
        ...
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The bindings source class must also use <code>T</code> as the name of the type variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">abstract class MyClassBindings&lt;T&gt; {
    @MyInterceptorBinding
    abstract T doSomething();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>インターセプトされたクラスに存在するという理由だけで、アノテーションが付けられていないメソッドを宣言する必要はありません。
メソッドのサブセットにメソッドレベルのバインディングを追加する場合は、インターセプターバインディングを指定する予定のメソッドを宣言するだけで済みます。
クラスレベルのバインディングのみを追加する場合は、メソッドを宣言する必要はありません。</p>
</div>
<div class="paragraph">
<p>バインディングソースクラスには次のアノテーションを配置できます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>インターセプターバインディング</em>: クラスとメソッド</p>
</li>
<li>
<p><em>ステレオタイプ</em>: クラスについて</p>
</li>
<li>
<p><code>@NoClassInterceptors</code>: メソッドについて</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>バインディングソースクラスに存在するその他のアノテーションは無視されます。</p>
</div>
</div>
<div class="sect3">
<h4 id="synthetic-beans"><a class="anchor" href="#synthetic-beans"></a>5.22.2. 合成 Bean</h4>
<div class="paragraph">
<p>合成 Bean で <code>InterceptionProxy</code> を使用する場合も同様です。</p>
</div>
<div class="paragraph">
<p>まず、合成 Bean が <code>InterceptionProxy</code> を注入することを宣言する必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public void register(RegistrationContext context) {
    context.configure(MyClass.class)
            .types(MyClass.class)
            .injectInterceptionProxy() <i class="conum" data-value="1"></i><b>(1)</b>
            .creator(MyClassCreator.class)
            .done();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>つまり、これはビルド時に、インターセプトと転送を行う <code>MyClass</code> のサブクラスが生成されることを意味します。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>次に、 <code>BeanCreator</code> の <code>SyntheticCreationalContext</code> から <code>InterceptionProxy</code> を取得して使用する必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public MyClass create(SyntheticCreationalContext&lt;MyClass&gt; context) {
    InterceptionProxy&lt;MyClass&gt; proxy = context.getInterceptionProxy(); <i class="conum" data-value="1"></i><b>(1)</b>
    return proxy.create(new MyClass());
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>上記で宣言したように、 <code>MyClass</code> の <code>InterceptionProxy</code> を取得します。
<code>TypeLiteral</code> を渡して <code>getInjectedReference()</code> メソッドを使用することも可能ですが、 <code>getInterceptionProxy()</code> の方が簡単です。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>@BindingsSource</code> に相当するものもあります。
<code>injectInterceptionProxy()</code> メソッドには、パラメーターが １ つ指定されたオーバーロードがあります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public void register(RegistrationContext context) {
    context.configure(MyClass.class)
            .types(MyClass.class)
            .injectInterceptionProxy(MyClassBindings.class) <i class="conum" data-value="1"></i><b>(1)</b>
            .creator(MyClassCreator.class)
            .done();
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>引数はバインディングソースクラスです。</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="instance-handle-close-behavior"><a class="anchor" href="#instance-handle-close-behavior"></a>5.23. <code>Instance.Handle.close()</code> の動作</h3>
<div class="paragraph">
<p>CDI 仕様によれば、 <code>Instance.Handle.close()</code> メソッドは常に <code>destroy()</code> に委任します。
ArC では、これは <a href="#strict_mode">ストリクトモード</a> では True のみです。</p>
</div>
<div class="paragraph">
<p>デフォルトモードでは、Bean が <code>@Dependent</code> の場合 (またはインスタンスハンドルが CDI コンテキストオブジェクトを表していない場合)、 <code>close()</code> メソッドは <code>destroy()</code> に委任するだけです。
インスタンスハンドルが他のスコープの Bean を表す場合、 <code>close()</code> メソッドは何も行いません。Bean はそのまま残され、コンテキストが破棄されると、Bean も破棄されます。</p>
</div>
<div class="paragraph">
<p>これは、次のコードを単純に期待どおりに動作させるためです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Instance&lt;T&gt; instance = ...;
try (Instance.Handle&lt;T&gt; handle : instance.getHandle()) {
   T value = handle.get();
   ... use value ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@Dependent</code> Bean はすぐに破棄されますが、他の Bean は破棄されません。
これは、 <code>Instance</code> によって異なるスコープの複数の Bean が返される可能性がある場合に重要です。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reactive_pitfalls"><a class="anchor" href="#reactive_pitfalls"></a>6. リアクティブプログラミングの落とし穴</h2>
<div class="sectionbody">
<div class="paragraph">
<p>CDI は単なる同期フレームワークです。
非同期の概念は非常に限られており、スレッドプールとスレッドオフロードのみに基づいています。
したがって、CDI をリアクティブプログラミングと組み合わせて使用すると、いくつかの落とし穴が生じます。</p>
</div>
<div class="sect2">
<h3 id="detecting-when-blocking-is-allowed"><a class="anchor" href="#detecting-when-blocking-is-allowed"></a>6.1. ブロックが許可されているかどうかの検出</h3>
<div class="paragraph">
<p><code>io.quarkus.runtime.BlockingOperationControl#isBlockingAllowed()</code> メソッドを使用すると、現在のスレッドでブロッキングが許可されているかどうかを検出できます。
そうでない場合、ブロッキング操作を実行する必要がある場合は、その操作を別のスレッドにオフロードする必要があります。
最も簡単な方法は、 <code>Vertx.executeBlocking()</code> メソッドを使用することです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import io.quarkus.runtime.BlockingOperationControl;

@ApplicationScoped
public class MyBean {
    @Inject
    Vertx vertx;

    @PostConstruct
    void init() {
        if (BlockingOperationControl.isBlockingAllowed()) {
            somethingThatBlocks();
        } else {
            vertx.executeBlocking(() -&gt; {
                somethingThatBlocks();
                return null;
            });
        }
    }

    void somethingThatBlocks() {
        // use the file system or JDBC, call a REST service, etc.
        Thread.sleep(5000);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="asynchronous-observers"><a class="anchor" href="#asynchronous-observers"></a>6.2. 非同期オブザーバー</h3>
<div class="paragraph">
<p>CDI 非同期オブザーバー (<code>@ObservesAsync</code>) はリアクティブプログラミングを認識しないため、リアクティブパイプラインの一部として使用できません。
オブザーバーメソッドは同期されることを意図しており、スレッドプールにオフロードされるだけです。</p>
</div>
<div class="paragraph">
<p><code>Event.fireAsync()</code> メソッドは、すべてのオブザーバーに通知されると完了する <code>CompletionStage</code> を返します。
すべてのオブザーバーに正常に通知された場合、 <code>CompletionStage</code> はイベントペイロードで完了します。
一部のオブザーバーで例外が発生した場合、 <code>CompletionStage</code> は <code>CompletionException</code> で例外的に完了します。</p>
</div>
<div class="paragraph">
<p>オブザーバーの戻り値の型は重要ではありません。
オブザーバーの戻り値は無視されます。</p>
</div>
<div class="paragraph">
<p>You may declare an observer method that has a return type of <code>CompletionStage&lt;&gt;</code> or <code>Uni&lt;&gt;</code>, but neither the return type nor the actual return value affects the result of <code>Event.fireAsync()</code>.
Further, if the observer declares a return type of <code>Uni&lt;&gt;</code>, the returned <code>Uni</code> will not be subscribed to, so it is quite possible that part of the observer logic will not even execute.</p>
</div>
<div class="paragraph">
<p>したがって、同期と非同期の両方のオブザーバーメソッドは常に <code>void</code> として宣言することを推奨します。</p>
</div>
</div>
<div class="sect2">
<h3 id="reactive-startup-methods"><a class="anchor" href="#reactive-startup-methods"></a>6.3. Reactive startup methods</h3>
<div class="paragraph">
<p>As documented in <a href="lifecycle#startup_annotation">the <code>@Startup</code> method documentation</a>, you may define startup
methods that return a <code>Uni</code>, in which case they will be invoked on an event thread instead of a blocking thread, and
their returned <code>Uni</code> will be subscribed to and awaited.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="build_time_apis"><a class="anchor" href="#build_time_apis"></a>7. ビルド時間延長</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus は、インスタント起動と低メモリフットプリントを提供するために、ビルド時の最適化を取り入れています。このアプローチの欠点は、CDI ポータブル・エクステンションをサポートできないことです。それにもかかわらず、ほとんどの機能は、Quarkus <a href="writing-extensions">エクステンション</a> を使用して行うことができます。詳細は、<a href="cdi-integration">integration guide</a> を参照してください。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dev_mode"><a class="anchor" href="#dev_mode"></a>8. <a id="development-mode"></a> 開発モード</h2>
<div class="sectionbody">
<div class="paragraph">
<p>開発モードでは、JSON 形式で基本的なデバッグ情報を提供するために、2 つの特別なエンドポイントが自動的に登録されます。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HTTP GET <code>/q/arc</code> - 要約、Bean の数、設定プロパティーなどを返します。</p>
</li>
<li>
<p>HTTP GET <code>/q/arc/beans</code> - すべての Bean のリストを返します。</p>
<div class="ulist">
<ul>
<li>
<p>クエリーパラメーターを使用して出力をフィルタリングすることができます。</p>
<div class="ulist">
<ul>
<li>
<p><code>scope</code> - 指定した値で終わるスコープを持つ Bean を含みます (つまり <code><a href="http://localhost:8080/q/arc/beans?scope=ApplicationScoped" class="bare">http://localhost:8080/q/arc/beans?scope=ApplicationScoped</a></code>)。</p>
</li>
<li>
<p><code>beanClass</code> - 与えられた値で始まる Bean クラスを持つ Bean を含みます (つまり <code><a href="http://localhost:8080/q/arc/beans?beanClass=org.acme.Foo" class="bare">http://localhost:8080/q/arc/beans?beanClass=org.acme.Foo</a></code>)。</p>
</li>
<li>
<p><code>kind</code> - 指定された種類の Bean (<code>CLASS</code>、 <code>PRODUCER_FIELD</code>、 <code>PRODUCER_METHOD</code>、 <code>INTERCEPTOR</code>、または <code>SYNTHETIC</code>) を含みます (つまり <code><a href="http://localhost:8080/q/arc/beans?kind=PRODUCER_METHOD" class="bare">http://localhost:8080/q/arc/beans?kind=PRODUCER_METHOD</a></code>)。</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>HTTP GET <code>/q/arc/removed-beans</code> - ビルド中に削除された未使用の Bean のリストを返します。</p>
</li>
<li>
<p>HTTP GET <code>/q/arc/observers</code> - すべてのオブザーバーメソッドのリストを返します。</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
これらのエンドポイントは、開発モード、つまり <code>mvn quarkus:dev</code> (または <code>./gradlew quarkusDev</code>) 経由でアプリケーションを実行する場合にのみ使用できます。
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="monitoring-business-method-invocations-and-events"><a class="anchor" href="#monitoring-business-method-invocations-and-events"></a>8.1. ビジネスメソッドの呼び出しとイベントの監視</h3>
<div class="paragraph">
<p>開発モードでは、ビジネスメソッドの呼び出しと発生したイベントの監視を有効にすることもできます。
<code>quarkus.arc.dev-mode.monitoring-enabled</code> 設定プロパティーを <code>true</code> に設定し、関連する Dev UI ページを確認するだけです。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="strict_mode"><a class="anchor" href="#strict_mode"></a>9. ストリクトモード</h2>
<div class="sectionbody">
<div class="paragraph">
<p>デフォルトでは、ArC は CDI 仕様で要求される全てのバリデーションを実行するわけではありません。また、多くの方法でCDIの使い勝手を向上させますが、その中には仕様に直接反するものもあります。</p>
</div>
<div class="paragraph">
<p>CDI Lite TCK に合格させるために、ArC には <em>strict</em> モードもあります。
このモードでは、追加の検証が有効になり、仕様と競合する特定の改善機能が無効になります。</p>
</div>
<div class="paragraph">
<p>ストリクトモードを有効にするには、次のように設定します:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.arc.strict-compatibility=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>その他にも、仕様の互換性に影響を与える機能があります:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#unproxyable_classes_transformation">Transformation of unproxyable classes</a></p>
</li>
<li>
<p><a href="#remove_unused_beans">Unused beans removal</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>仕様に近い動作を得るには、これらの機能を無効にする必要があります。</p>
</div>
<div class="paragraph">
<p>アプリケーションは、CDIをより便利に使えるように、デフォルトの非厳密モードを使用することが推奨されます。厳密モードの「厳密さ」（CDI仕様の上に追加される検証のセットと無効にされる改良のセット）は、将来変化する可能性があります。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="arc-configuration-reference"><a class="anchor" href="#arc-configuration-reference"></a>10. ArC Configuration Reference</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="ビルド時に固定"></i></span>ビルド時に固定される設定プロパティ - 他のすべての設定プロパティは実行時にオーバーライド可能 <input type="search" id="config-search-0" placeholder="FILTER CONFIGURATION" disabled></p>
</div>
<table class="tableblock frame-all grid-all stretch configuration-reference searchable configuration-reference-all-rows">
<colgroup>
<col style="width: 80%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><span class="header-title">Configuration property</span></p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">型</p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">デフォルト</p></th>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-remove-unused-beans"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-remove-unused-beans"><code>quarkus.arc.remove-unused-beans</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.remove-unused-beans' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-1" class="openblock description description-collapsed">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>If set to <code>all</code> (or <code>true</code>) the container will attempt to remove all unused beans.</p>
</li>
<li>
<p>If set to <code>none</code> (or <code>false</code>) no beans will ever be removed even if they are unused (according to the criteria set out below)</p>
</li>
<li>
<p>If set to <code>fwk</code>, then all unused beans will be removed, except the unused beans whose classes are declared in the application code</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>An unused bean:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>is not a built-in bean or interceptor,</p>
</li>
<li>
<p>is not eligible for injection to any injection point,</p>
</li>
<li>
<p>is not excluded by any extension,</p>
</li>
<li>
<p>does not have a name,</p>
</li>
<li>
<p>does not declare an observer,</p>
</li>
<li>
<p>does not declare any producer which is eligible for injection to any injection point,</p>
</li>
<li>
<p>is not directly eligible for injection into any <code>jakarta.enterprise.inject.Instance</code> injection point</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69873">QUARKUS_ARC_REMOVE_UNUSED_BEANS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69873" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>all</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-auto-inject-fields"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-auto-inject-fields"><code>quarkus.arc.auto-inject-fields</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.auto-inject-fields' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-2" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If set to true <code>@Inject</code> is automatically added to all non-static non-final fields that are annotated with one of the annotations defined by <code>AutoInjectAnnotationBuildItem</code>.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69874">QUARKUS_ARC_AUTO_INJECT_FIELDS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69874" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-transform-unproxyable-classes"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-transform-unproxyable-classes"><code>quarkus.arc.transform-unproxyable-classes</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.transform-unproxyable-classes' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-3" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If set to true, the bytecode of unproxyable beans will be transformed. This ensures that a proxy/subclass can be created properly. If the value is set to false, then an exception is thrown at build time indicating that a subclass/proxy could not be created. Quarkus performs the following transformations when this setting is enabled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Remove 'final' modifier from classes and methods when a proxy is required.</p>
</li>
<li>
<p>Create a no-args constructor if needed.</p>
</li>
<li>
<p>Makes private no-args constructors package-private if necessary.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69875">QUARKUS_ARC_TRANSFORM_UNPROXYABLE_CLASSES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69875" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-transform-private-injected-fields"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-transform-private-injected-fields"><code>quarkus.arc.transform-private-injected-fields</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.transform-private-injected-fields' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-4" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If set to true, the bytecode of private fields that are injection points will be transformed to package private. This ensures that field injection can be performed completely reflection-free. If the value is set to false, then a reflection fallback is used to perform the injection.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69876">QUARKUS_ARC_TRANSFORM_PRIVATE_INJECTED_FIELDS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69876" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-fail-on-intercepted-private-method"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-fail-on-intercepted-private-method"><code>quarkus.arc.fail-on-intercepted-private-method</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.fail-on-intercepted-private-method' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-5" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If set to true (the default), the build fails if a private method that is neither an observer nor a producer, is annotated with an interceptor binding. An example of this is the use of <code>Transactional</code> on a private method of a bean. If set to false, Quarkus simply logs a warning that the annotation will be ignored.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69877">QUARKUS_ARC_FAIL_ON_INTERCEPTED_PRIVATE_METHOD</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69877" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-selected-alternatives"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-selected-alternatives"><code>quarkus.arc.selected-alternatives</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.selected-alternatives' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-6" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The list of selected alternatives for an application.</p>
</div>
<div class="paragraph">
<p>An element value can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a fully qualified class name, i.e. <code>org.acme.Foo</code></p>
</li>
<li>
<p>a simple class name as defined by <code>Class#getSimpleName()</code>, i.e. <code>Foo</code></p>
</li>
<li>
<p>a package name with suffix <code>.*</code>, i.e. <code>org.acme.*</code>, matches a package</p>
</li>
<li>
<p>a package name with suffix <code>.**</code>, i.e. <code>org.acme.**</code>, matches a package that starts with the value</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each element value is used to match an alternative bean class, an alternative stereotype annotation type or a bean class that declares an alternative producer. If any value matches then the priority of <code>Integer#MAX_VALUE</code> is used for the relevant bean. The priority declared via <code>jakarta.annotation.Priority</code> is overridden.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69878">QUARKUS_ARC_SELECTED_ALTERNATIVES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69878" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-auto-producer-methods"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-auto-producer-methods"><code>quarkus.arc.auto-producer-methods</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.auto-producer-methods' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-7" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If set to true then <code>jakarta.enterprise.inject.Produces</code> is automatically added to all non-void methods that are annotated with a scope annotation, a stereotype or a qualifier, and are not annotated with <code>Inject</code> or <code>Produces</code>, and no parameter is annotated with <code>Disposes</code>, <code>Observes</code> or <code>ObservesAsync</code>.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69879">QUARKUS_ARC_AUTO_PRODUCER_METHODS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69879" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-exclude-types"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-exclude-types"><code>quarkus.arc.exclude-types</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.exclude-types' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-8" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The list of types that should be excluded from discovery.</p>
</div>
<div class="paragraph">
<p>An element value can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a fully qualified class name, i.e. <code>org.acme.Foo</code></p>
</li>
<li>
<p>a simple class name as defined by <code>Class#getSimpleName()</code>, i.e. <code>Foo</code></p>
</li>
<li>
<p>a package name with suffix <code>.*</code>, i.e. <code>org.acme.*</code>, matches a package</p>
</li>
<li>
<p>a package name with suffix <code>.**</code>, i.e. <code>org.acme.**</code>, matches a package that starts with the value</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any element value matches a discovered type then the type is excluded from discovery, i.e. no beans and observer methods are created from this type.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69880">QUARKUS_ARC_EXCLUDE_TYPES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69880" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-unremovable-types"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-unremovable-types"><code>quarkus.arc.unremovable-types</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.unremovable-types' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-9" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>List of types that should be considered unremovable regardless of whether they are directly used or not. This is a configuration option equivalent to using <code>io.quarkus.arc.Unremovable</code> annotation.</p>
</div>
<div class="paragraph">
<p>An element value can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a fully qualified class name, i.e. <code>org.acme.Foo</code></p>
</li>
<li>
<p>a simple class name as defined by <code>Class#getSimpleName()</code>, i.e. <code>Foo</code></p>
</li>
<li>
<p>a package name with suffix <code>.*</code>, i.e. <code>org.acme.*</code>, matches a package</p>
</li>
<li>
<p>a package name with suffix <code>.**</code>, i.e. <code>org.acme.**</code>, matches a package that starts with the value</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If any element value matches a discovered bean, then such a bean is considered unremovable.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69881">QUARKUS_ARC_UNREMOVABLE_TYPES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69881" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><a id="quarkus-arc_section_quarkus-arc-exclude-dependency"></a> <span class="section-name section-level0"><a href="#quarkus-arc_section_quarkus-arc-exclude-dependency">Artifacts that should be excluded from discovery</a></span></p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">型</p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">デフォルト</p></th>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-exclude-dependency-dependency-name-group-id"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-exclude-dependency-dependency-name-group-id"><code>quarkus.arc.exclude-dependency."dependency-name".group-id</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.exclude-dependency."dependency-name".group-id' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-10" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The maven groupId of the artifact.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69882">QUARKUS_ARC_EXCLUDE_DEPENDENCY__DEPENDENCY_NAME__GROUP_ID</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69882" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">required <span class="icon"><i class="fa fa-exclamation-circle" title="Configuration property is required"></i></span></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-exclude-dependency-dependency-name-artifact-id"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-exclude-dependency-dependency-name-artifact-id"><code>quarkus.arc.exclude-dependency."dependency-name".artifact-id</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.exclude-dependency."dependency-name".artifact-id' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-11" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The maven artifactId of the artifact (optional).</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69883">QUARKUS_ARC_EXCLUDE_DEPENDENCY__DEPENDENCY_NAME__ARTIFACT_ID</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69883" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-exclude-dependency-dependency-name-classifier"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-exclude-dependency-dependency-name-classifier"><code>quarkus.arc.exclude-dependency."dependency-name".classifier</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.exclude-dependency."dependency-name".classifier' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-12" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The maven classifier of the artifact (optional).</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69884">QUARKUS_ARC_EXCLUDE_DEPENDENCY__DEPENDENCY_NAME__CLASSIFIER</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69884" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-detect-unused-false-positives"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-detect-unused-false-positives"><code>quarkus.arc.detect-unused-false-positives</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.detect-unused-false-positives' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-13" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If set to true then the container attempts to detect "unused removed beans" false positives during programmatic lookup at runtime. You can disable this feature to conserve some memory when running your application in production.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69885">QUARKUS_ARC_DETECT_UNUSED_FALSE_POSITIVES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69885" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-detect-wrong-annotations"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-detect-wrong-annotations"><code>quarkus.arc.detect-wrong-annotations</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.detect-wrong-annotations' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-14" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If set to true then the container attempts to detect <em>wrong</em> usages of annotations and eventually fails the build to prevent unexpected behavior of a Quarkus application.</p>
</div>
<div class="paragraph">
<p>A typical example is <code>@jakarta.ejb.Singleton</code> which is often confused with <code>@jakarta.inject.Singleton</code>. As a result a component annotated with <code>@jakarta.ejb.Singleton</code> would be completely ignored. Another example is an inner class annotated with a scope annotation - this component would be again completely ignored.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69886">QUARKUS_ARC_DETECT_WRONG_ANNOTATIONS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69886" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-strict-compatibility"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-strict-compatibility"><code>quarkus.arc.strict-compatibility</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.strict-compatibility' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-15" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If set to <code>true</code>, the container will perform additional validations mandated by the CDI specification. Some improvements on top of the CDI specification may be disabled. Applications that work as expected in the strict mode should work without a change in the default, non-strict mode.</p>
</div>
<div class="paragraph">
<p>The strict mode is mainly introduced to allow passing the CDI Lite TCK. Applications are recommended to use the default, non-strict mode, which makes CDI more convenient to use. The "strictness" of the strict mode (the set of additional validations and the set of disabled improvements on top of the CDI specification) may change over time.</p>
</div>
<div class="paragraph">
<p>Note that <code>transform-unproxyable-classes</code> and <code>remove-unused-beans</code> also has effect on specification compatibility. You may want to disable these features to get behavior closer to the specification.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69887">QUARKUS_ARC_STRICT_COMPATIBILITY</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69887" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-dev-mode-monitoring-enabled"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-dev-mode-monitoring-enabled"><code>quarkus.arc.dev-mode.monitoring-enabled</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.dev-mode.monitoring-enabled' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-16" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If set to true then the container monitors business method invocations and fired events during the development mode.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This config property should not be changed in the development mode as it requires a full rebuild of the application
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69888">QUARKUS_ARC_DEV_MODE_MONITORING_ENABLED</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69888" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-dev-mode-generate-dependency-graphs"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-dev-mode-generate-dependency-graphs"><code>quarkus.arc.dev-mode.generate-dependency-graphs</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.dev-mode.generate-dependency-graphs' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-17" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If set to <code>true</code> then the dependency graphs are generated and available in the Dev UI. If set to <code>auto</code> then the dependency graphs are generated if there&#8217;s less than 1000 beans in the application. If set to <code>false</code> the dependency graphs are not generated.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69889">QUARKUS_ARC_DEV_MODE_GENERATE_DEPENDENCY_GRAPHS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69889" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>true</code>, <code>false</code>, <code>auto</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>auto</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-test-disable-application-lifecycle-observers"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-test-disable-application-lifecycle-observers"><code>quarkus.arc.test.disable-application-lifecycle-observers</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.test.disable-application-lifecycle-observers' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-18" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If set to true then disable <code>StartupEvent</code> and <code>ShutdownEvent</code> observers declared on application bean classes during the tests.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69890">QUARKUS_ARC_TEST_DISABLE_APPLICATION_LIFECYCLE_OBSERVERS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69890" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-ignored-split-packages"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-ignored-split-packages"><code>quarkus.arc.ignored-split-packages</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.ignored-split-packages' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-19" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The list of packages that will not be checked for split package issues.</p>
</div>
<div class="paragraph">
<p>A package string representation can be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a full name of the package, i.e. <code>org.acme.foo</code></p>
</li>
<li>
<p>a package name with suffix <code>.*</code>, i.e. <code>org.acme.*</code>, which matches a package that starts with provided value</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69891">QUARKUS_ARC_IGNORED_SPLIT_PACKAGES</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69891" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-arc_quarkus-arc-context-propagation-enabled"></a> <span class="property-path"><a href="#quarkus-arc_quarkus-arc-context-propagation-enabled"><code>quarkus.arc.context-propagation.enabled</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.arc.context-propagation.enabled' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-20" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If set to true and the SmallRye Context Propagation extension is present then the CDI contexts will be propagated by means of the MicroProfile Context Propagation API. Specifically, a <code>org.eclipse.microprofile.context.spi.ThreadContextProvider</code> implementation is registered. On the other hand, if set to false then the MicroProfile Context Propagation API will never be used to propagate the CDI contexts. Note that the CDI contexts may be propagated in a different way though. For example with the Vertx duplicated context.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-69892">QUARKUS_ARC_CONTEXT_PROPAGATION_ENABLED</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-69892" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
    </div>
    <div class="grid__item width-4-12 width-12-12-m tocwrapper">
      <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#bean_discovery">1. Bean の検出</a>
<ul class="sectlevel2">
<li><a href="#how-to-generate-a-jandex-index">1.1. Jandex インデックスを生成する方法</a></li>
<li><a href="#how-to-exclude-types-and-dependencies-from-discovery">1.2. ディスカバリーから型と依存関係を除外する方法</a></li>
</ul>
</li>
<li><a href="#string-based-qualifiers">2. String-Based Qualifiers</a>
<ul class="sectlevel2">
<li><a href="#when-to-use-named">2.1. When To Use <code>@Named</code>?</a></li>
</ul>
</li>
<li><a href="#native-executables-and-private-members">3. ネイティブ実行可能ファイルとプライベートメンバー</a></li>
<li><a href="#supported_features_and_limitations">4.  サポートされている機能と制限</a></li>
<li><a href="#nonstandard_features">5. 標準外の機能</a>
<ul class="sectlevel2">
<li><a href="#eager-instantiation-of-beans">5.1. Bean の即時インスタンス化</a></li>
<li><a href="#request-context-lifecycle">5.2. リクエストコンテキストのライフサイクル</a></li>
<li><a href="#qualified-injected-fields">5.3. 修飾された注入フィールド</a></li>
<li><a href="#simplified-constructor-injection">5.4. 簡略化されたコンストラクター注入</a></li>
<li><a href="#remove_unused_beans">5.5. 未使用の Bean の削除</a></li>
<li><a href="#default_beans">5.6. デフォルトの Bean</a></li>
<li><a href="#enable_build_profile">5.7. Quarkus ビルドプロファイルの Bean の有効化</a></li>
<li><a href="#enable_build_properties">5.8. Quarkus ビルドプロパティーの Bean を有効にする</a></li>
<li><a href="#declaring-selected-alternatives">5.9. 選択された代替の宣言</a></li>
<li><a href="#simplified-producer-method-declaration">5.10. 簡略化された Producer メソッドの宣言</a></li>
<li><a href="#interception_of_static_methods">5.11. 静的メソッドのインターセプション</a></li>
<li><a href="#unproxyable_classes_transformation">5.12. final クラスとメソッドを処理する能力</a></li>
<li><a href="#container-managed-concurrency">5.13. コンテナー管理型の並行処理</a></li>
<li><a href="#repeatable-interceptor-bindings">5.14. 反復可能なインターセプターバインディング</a></li>
<li><a href="#caching-the-result-of-programmatic-lookup">5.15. プログラムによるルックアップの結果をキャッシュする</a></li>
<li><a href="#declaratively-choose-beans-that-can-be-obtained-by-programmatic-lookup">5.16. プログラムによるルックアップで取得できる Bean を宣言的に選択する</a></li>
<li><a href="#sorting-beans-obtained-with-programmatic-lookup">5.17. プログラムによる検索で取得した Bean のソート</a></li>
<li><a href="#injecting-multiple-bean-instances-intuitively">5.18. 複数の Bean インスタンスを直感的に注入する</a></li>
<li><a href="#ignoring-class-level-interceptor-bindings-for-methods-and-constructors">5.19. メソッドとコンストラクターのクラスレベルのインターセプターバインディングを無視する</a></li>
<li><a href="#exceptions-thrown-by-an-asynchronous-observer-method">5.20. 非同期オブザーバーメソッドによって出力される例外</a></li>
<li><a href="#intercepted-self-invocation">5.21. インターセプトされた自己呼び出し</a></li>
<li><a href="#intercepting-producer-methods-and-synthetic-beans">5.22. インターセプトプロデューサーメソッドと合成 Bean</a></li>
<li><a href="#instance-handle-close-behavior">5.23. <code>Instance.Handle.close()</code> の動作</a></li>
</ul>
</li>
<li><a href="#reactive_pitfalls">6. リアクティブプログラミングの落とし穴</a>
<ul class="sectlevel2">
<li><a href="#detecting-when-blocking-is-allowed">6.1. ブロックが許可されているかどうかの検出</a></li>
<li><a href="#asynchronous-observers">6.2. 非同期オブザーバー</a></li>
<li><a href="#reactive-startup-methods">6.3. Reactive startup methods</a></li>
</ul>
</li>
<li><a href="#build_time_apis">7. ビルド時間延長</a></li>
<li><a href="#dev_mode">8.  開発モード</a>
<ul class="sectlevel2">
<li><a href="#monitoring-business-method-invocations-and-events">8.1. ビジネスメソッドの呼び出しとイベントの監視</a></li>
</ul>
</li>
<li><a href="#strict_mode">9. ストリクトモード</a></li>
<li><a href="#arc-configuration-reference">10. ArC Configuration Reference</a></li>
</ul></div>
    </div>
  </div>
  <h2>関連コンテンツ</h2>
  <div class="grid-wrapper relations">
    <div class="grid__item width-6-12 width-12-12-m">
      <h3>同じエクステンションについて</h3>
      <ul class="related-content">
      
        
        <li class="guide"><a href="/version/main/guides/lifecycle">アプリケーションの初期化と終了</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/cdi-integration">CDI 統合ガイド</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/cdi">コンテキストと依存性注入(CDI)の紹介</a></li>
      </ul>
    </div>
    <div class="grid__item width-6-12 width-12-12-m">
      <h3>同じトピックについて</h3>
      <ul class="related-content">
      
        
        <li class="guide"><a href="/version/main/guides/cdi">コンテキストと依存性注入(CDI)の紹介</a></li>
      
        
        <li class="guide"><a href="/version/main/guides/cdi-integration">CDI 統合ガイド</a></li>
      </ul>
    </div>
    </div>
  </div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license. <i class='fab fa-creative-commons'></i><i class='fab fa-creative-commons-by'></i> <a href='https://creativecommons.org/licenses/by/3.0/' target='_blank'>CC by 3.0</a><br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>ナビゲーション</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">ホーム</a></li>
          
          
          
            <li><a href="/about" target="_blank">Quarkusについて</a></li>
          
          
          
            <li><a href="/blog" target="_blank">ブログ</a></li>
          
          
          
            <li><a href="/insights" target="_blank">ポッドキャスト</a></li>
          
          
          
            <li><a href="/events" target="_blank">イベント</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">ニュースレター</a></li>
          
          
          
            <li><a href="/userstories" target="_blank">ユーザーストーリー</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">ロードマップ</a></li>
          
          
          
            <li><a href="/security" target="_blank">セキュリティ&nbsp;ポリシー</a></li>
          
          
          
            <li><a href="/usage" target="_blank">使用方法</a></li>
          
          
          
            <li><a href="https://github.com/commonhaus/artwork/tree/main/projects/quarkus" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
          
            <li><a href="https://www.redhat.com/en/about/privacy-policy" target="_blank">Privacy Policy</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>フォローする</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a href="https://bsky.app/profile/quarkus.io" target="_blank">Bluesky</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.threads.com/@quarkusio" target="_blank">Threads</a></li>
          
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>ヘルプ</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">サポート</a></li>
          
          
          
            <li><a href="/guides" target="_blank">ガイド</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">入門</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">ディスカッション</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">開発メーリングリスト</a></li>
          
          
          
            <li><a href="https://stats.uptimerobot.com/ze1PfweT2p" target="_blank">Quarkus Service Status</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>言語</span>
        <ul class="footer-links">
          
          
            <li><a href=" https://quarkus.io/ " target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href=" https://es.quarkus.io/ " target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href=" https://ja.quarkus.io/ " target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkusはコミュニティプロジェクトで構成されています</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate ORM</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">その他多数...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content cf-footer">
  <div class="flexcontainer">
    <div class="cf-logo">
      <a class="cf-logo" href="https://www.commonhaus.org/" target="_blank"><img src="https://raw.githubusercontent.com/commonhaus/artwork/main/foundation/brand/svg/CF_logo_horizontal_single_reverse.svg"/></a>
    </div>
    <div class="license">
      Copyright © Quarkus. All rights reserved. For details on our trademarks, please visit our <a href="https://www.commonhaus.org/policies/trademark-policy/">Trademark Policy</a> and <a href="https://www.commonhaus.org/trademarks/">Trademark List</a>. Trademarks of third parties are owned by their respective holders and their mention here does not suggest any endorsement or association.
    </div>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
  <script src="/assets/javascript/randomize.js" type="text/javascript"></script>
  <script src="/assets/javascript/time.js" type="text/javascript"></script>
</body>

</html>
