<!DOCTYPE html>
<html lang="ja">







<head>
  <title>WebAuthnと共にSecurityを使用 - 3.20 - Quarkus</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="
  connect-src 'self' https://dpm.demdex.net https://adobedc.demdex.net https://analytics.ossupstream.org/ https://search.quarkus.io https://smetrics.redhat.com https://ajax.googleapis.com; 
  script-src 'self' 'unsafe-inline' 'unsafe-eval'
      
      https://assets.adobedtm.com
      js.bizographics.com
      https://www.redhat.com
      https://static.redhat.com
      https://app.requestly.io/
      jsonip.com
      https://ajax.googleapis.com
      https://use.fontawesome.com
      http://www.youtube.com
      http://www.googleadservices.com
      https://googleads.g.doubleclick.net
      https://giscus.app
      https://analytics.ossupstream.org/
      https://app.mailjet.com;

  style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; 
  img-src 'self' * data:; 
  media-src 'self'; 
  frame-src https://redhat.demdex.net https://www.youtube.com https://player.restream.io https://app.mailjet.com http://xy0p2.mjt.lu https://mj.quarkus.io https://giscus.app; 
  base-uri 'none'; 
  object-src 'none'; 
  form-action 'none'; 
  font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />

  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/version/3.20/guides/security-webauthn" />
  <meta property="og:title" content="WebAuthnと共にSecurityを使用 - 3.20" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/security-webauthn">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.5.2/css/all.css" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
  
  
  
  
  <link rel="alternate" hreflang="x-default" href="https://quarkus.io/" />  
  <script src="/assets/javascript/tracking.js"></script>
  
  <script src="/assets/javascript/colormode.js" type="text/javascript"></script>

</head>

<body class="guides">

  


<div class="grid-wrapper communitysite">
  <div class="grid__item width-12-12">The <a href="https://quarkus.io/version/3.20/guides/security-webauthn">English version of quarkus.io</a> is the official project site. Translated sites are community supported on a best-effort basis.</div>
</div>


  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
        <div class="logo-wrapper">
           <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
        </div>
    <label class="nav-toggle" for="checkbox"> <i class="fa fa-bars"></i>
</label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="#">Why<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">QUARKUSとは何か?</a></li>
          <li><a href="/developer-joy" class="">開発者満足</a></li>
          <li><a href="/performance" class="">パフォーマンス</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">標準</a></li>
          <li><a href="/versatility" class="">多用途性</a></li>
          <li><a href="/container-first" class="">コンテナ・ファースト</a></li>
          <li><a href="/spring" class="">USING SPRING?</a></li>
          <li class="tertiarydropdown">
            <span href="#">AI<i class="fas fa-chevron-down"></i></span>
            <ul class="tertiarymenu">
              <li><a href="/ai" class="">AI OVERVIEW</a></li>
              <li><a href="/java-for-ai" class="">JAVA FOR AI</a></li>
              <li><a href="/quarkus-for-ai" class="">WHY QUARKUS FOR AI</a></li>
              <li><a href="/ai-blueprints" class="">AI BLUEPRINTS</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="#">Learn<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">入門</a></li>
          <li><a href="/guides" class="active">ドキュメント</a></li>
          <li><a href="/userstories/" class="">ユーザーストーリー</a></li>  
          <li><a href="/qtips" class="">"Q" Tipsビデオ</a></li>          
          <li><a href="/books" class="">書籍</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="#">Extensions<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          
          <!-- Note that quarkus.io is hardcoded here, because it is the only url which supports extensions -->
<li><a href="https://quarkus.io/extensions/" class="">エクステンションを探す</a></li>
          <li><a href="/faq/#what-is-a-quarkus-extension" class="">エクステンションの使用</a></li>
          <li><a href="/guides/writing-extensions" class="">エクステンションの作成</a></li>
          <li><a href="https://hub.quarkiverse.io" class="">エクステンションの共有</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="#">Community<i class="fas fa-chevron-down firsti"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">サポート</a></li>
          <li><a href="/blog" class="">ブログ</a></li>
          <li><a href="/discussion" class="">ディスカッション</a></li>
          <li><a href="/working-groups" class="">ワーキンググループ</a></li>
          <li><a href="/insights" class="">ポッドキャスト</a></li>
          <li><a href="/events" class="">イベント</a></li>
          <li><a href="/newsletter" class="">ニュースレター</a></li>
          <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" class="">ロードマップ</a></li>
          <li><a href="/benefactors" class="">BENEFACTORS</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary
white">コーディングを開始</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/version/3.20/guides/security-webauthn" >OFFICIAL (ENGLISH)</a></li>
          <li><a href="https://pt.quarkus.io/version/3.20/guides/security-webauthn">ポルトガル（BR）</a></li>
          <li><a href="https://es.quarkus.io/version/3.20/guides/security-webauthn">ESPAÑOL</a></li>
          <li><a href="https://cn.quarkus.io/version/3.20/guides/security-webauthn">简体中文</a></li>
          <li><a href="https://ja.quarkus.io/version/3.20/guides/security-webauthn">日本語</a></li>
          </ul>
      </li>
      <li>
        <span href="#" class="modeswitcher" id='theme-toggle'><i class="fas
fa-sun"></i><i class="fas fa-moon"></i><i class="fas fa-cog"></i></span>
      </li>
    </ul>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    







<section class="full-width-version-bg flexfilterbar guides">
  <div class="guideflexcontainer">
    <div class="docslink">
      <a class="returnlink" href="/version/3.20/guides/"> Back to Guides</a>
    </div>
    <div class="flexlabel">
      <label>バージョン:</label>
    </div>
    <div class="guidepulldown version">
    <select id="guide-version-dropdown">
      
        
        
        <option value="main" >Main - SNAPSHOT</option>
        
        
        
        <option value="latest" >3.31.3 - Latest</option>
        
        
        
        <option value="3.27" >3.27</option>
        
        
        
        <option value="3.20" selected>3.20</option>
        
        
        
        <option value="3.15" >3.15</option>
        
        
        
        <option value="3.8" >3.8</option>
        </select>
    </div>
  </div>
</section>

<div class="guide">
  <div class="grid-wrapper">
    <div class="grid__item width-8-12 width-12-12-m">
      
      <h1 class="text-caps">WebAuthnと共にSecurityを使用 </h1>
      <a class="status-label status-preview" title="This extension's backward compatibility and presence in the ecosystem is not guaranteed" href="#extension-status-note">preview</a>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>このガイドでは、Quarkus アプリケーションで、パスワードの代わりに WebAuthn 認証を使用する方法を説明します。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>この技術は、previewと考えられています。</p>
</div>
<div class="paragraph">
<p><em>preview</em> では、下位互換性やエコシステムでの存在は保証されていません。具体的な改善には設定や API の変更が必要になるかもしれませんが、 <em>stable</em> になるための計画は現在進行中です。フィードバックは <a href="https://groups.google.com/d/forum/quarkus-dev">メーリングリスト</a> や <a href="https://github.com/quarkusio/quarkus/issues">GitHub の課題管理</a> で受け付けています。</p>
</div>
<div class="paragraph">
<p>とりうるステータスの完全なリストについては、 <a href="https://quarkus.io/faq/#extension-status">FAQの項目</a> を参照してください。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>前提条件</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このガイドを完成させるには、以下が必要です:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>約15分</p>
</li>
<li>
<p>IDE</p>
</li>
<li>
<p>JDK 17+がインストールされ、 <code>JAVA_HOME</code> が適切に設定されていること</p>
</li>
<li>
<p>Apache Maven 3.9.9</p>
</li>
<li>
<p>使用したい場合は、 <a href="cli-tooling.html">Quarkus CLI</a></p>
</li>
<li>
<p>ネイティブ実行可能ファイルをビルドしたい場合、MandrelまたはGraalVM（あるいはネイティブなコンテナビルドを使用する場合はDocker）をインストールし、 <a href="building-native-image.html#configuring-graalvm">適切に設定</a>していること</p>
</li>
<li>
<p>WebAuthn または PassKeys 対応デバイス、または <a href="https://developer.chrome.com/docs/devtools/webauthn/">それらのエミュレーター</a>。</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction-to-webauthn"><a class="anchor" href="#introduction-to-webauthn"></a>WebAuthnの紹介</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://webauthn.guide/">WebAuthn</a> は、パスワードを置き換えるために設計された認証メカニズムです。つまり、新しいユーザーを登録したり、ログインしたりするサービスを書くたびに、パスワードを要求する代わりに、WebAuthn を使って、パスワードを置き換えるのです。</p>
</div>
<div class="paragraph">
<p>WebAuthnは、パスワードをID証明に置き換えます。実際には、ユーザーは、パスワードを考案したり、保存したり、記憶したりする代わりに、あなたのサービスやウェブサイトのために特別にID証明を生成するハードウェアトークンを使用することになります。これは、ユーザーに携帯電話で親指を押してもらったり、パソコンで <a href="https://www.yubico.com">YubiKey</a> のボタンを押したりすることで実現可能です。</p>
</div>
<div class="paragraph">
<p>そこで、ユーザーを登録する際に、ブラウザーでユーザー情報（ユーザー名、自分の名前など）を入力しパスワードを入力して本人確認をする代わりに、ボタンをクリックすると、WebAuthn ブラウザー API が実行され、何か（ボタンを押す、指紋を使う）をするように要求されます。すると、ブラウザーはパスワードの代わりに、サービスに送信できるID証明を生成します。</p>
</div>
<div class="paragraph">
<p>この登録時のID証明は、ほとんどが公開鍵で構成されています。実際にはいろいろなものがありますが、最も興味深いのは公開鍵です。この公開鍵は、あなたのデバイスやブラウザに保存されているわけではありません。この公開鍵は、対象となるサービスのために特別に生成され（そのURIに関連付けられます）、ハードウェア認証デバイスから導出されたものです。したがって、ハードウェア認証デバイスとターゲットサービスの関連付けは、常に同じ秘密鍵と公開鍵のペアを導き出すことになります。例えば、YubiKeyを別のコンピュータに持ち出しても、同じターゲットサービスに対して同じ秘密鍵と公開鍵を生成し続けることができます。</p>
</div>
<div class="paragraph">
<p>そのため、登録時にはパスワードの代わりに（主に）公開鍵を送信し、サービスはその情報を新しいユーザーアカウントのWebAuthnクレデンシャルとして保存し、これが後にあなたを識別することになります。</p>
</div>
<div class="paragraph">
<p>そして、そのサービスにログインする必要があるとき、パスワードを入力する代わりに（これは存在しませんよ）、ログインフォームのボタンを押すと、ブラウザーが何かを尋ねてきて、パスワードの代わりに署名をサービスに送信してくれます。その署名にはあなたの認証ハードウェアと対象サービスから得られる秘密鍵が必要なので、あなたのサービスがそれを受け取ると、それがあなたがクレデンシャルとして保存した公開鍵の署名と一致するかどうかを検証することができるのです。</p>
</div>
<div class="paragraph">
<p>つまり、まとめると、登録時にはパスワードの代わりに生成した公開鍵を送信し、ログイン時にはその公開鍵に対する署名を送信することで、ユーザーが登録時の人物であることを確認することができるのです。</p>
</div>
<div class="paragraph">
<p>実際にはもう少し複雑で、ハードウェア認証機能を使う前にサーバーとハンドシェイクする必要があるため（チャレンジを求めるなど）、サービスには常に2つの呼び出しがあります。1つはログインや登録の一つ前のハードウェア認証デバイスを呼び出す前、そしてもう1つは通常のログインや登録の時です。</p>
</div>
<div class="paragraph">
<p>また、公開鍵以外にも保存するフィールドはたくさんありますが、それについては私たちがお手伝いします。</p>
</div>
<div class="paragraph">
<p><a href="https://fidoalliance.org/passkeys/">PassKeys</a> との関連について、そしてサポート対象かどうかについて気になるかもしれませんが、
もちろんこれはサポート対象です。PassKeys は、オーセンティケーターデバイスがその認証情報を共有および同期できる方法です。
認証情報は、続いて WebAuthn 認証で使用できます。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
WebAuthn 仕様では、サーバーとの通信に HTTPS を使用する必要がありますが、
一部のブラウザーでは <code>localhost</code> が許可されています。開発モードで HTTPS を使用する必要がある場合は、
<a href="https://docs.quarkiverse.io/quarkus-ngrok/dev/index.html">quarkus-ngrok</a> を常に使用できます。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="architecture"><a class="anchor" href="#architecture"></a>アーキテクチャ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>この例では、4つのエンドポイントを提供する、非常にシンプルなマイクロサービスを構築します:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/api/public</code></p>
</li>
<li>
<p><code>/api/public/me</code></p>
</li>
<li>
<p><code>/api/users/me</code></p>
</li>
<li>
<p><code>/api/admin</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>/api/public</code> エンドポイントは匿名でアクセスすることができます。 <code>/api/public/me</code> エンドポイントは匿名でアクセスでき、現在のユーザー名がある場合はそのユーザー名を、ない場合は <code>&lt;not logged in&gt;</code> を返します。 <code>/api/admin</code> エンドポイントは RBAC (Role-Based Access Control) で保護されており、 <code>admin</code> のロールを与えられたユーザーのみがアクセスすることができます。このエンドポイントでは、 <code>@RolesAllowed</code> アノテーションを使用して、アクセス制約を宣言的に適用しています。 <code>/api/users/me</code> のエンドポイントも RBAC (Role-Based Access Control) で保護されており， <code>user</code> のロールが付与されたユーザのみがアクセスできるようになっています．レスポンスとして、ユーザーに関する詳細情報を含むJSONドキュメントが返されます。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="solution"><a class="anchor" href="#solution"></a>ソリューション</h2>
<div class="sectionbody">
<div class="paragraph">
<p>次の章で紹介する手順に沿って、ステップを踏んでアプリを作成することをお勧めします。ただし、完成した例にそのまま進んでも構いません。</p>
</div>
<div class="paragraph">
<p>Gitレポジトリをクローンするか <code>git clone -b 3.20 <a href="https://github.com/quarkusio/quarkus-quickstarts.git" class="bare">https://github.com/quarkusio/quarkus-quickstarts.git</a></code> 、 <a href="https://github.com/quarkusio/quarkus-quickstarts/archive/3.20.zip">アーカイブ</a> をダウンロードします。</p>
</div>
<div class="paragraph">
<p>ソリューションは <code>security-webauthn-quickstart</code> <a href="https://github.com/quarkusio/quarkus-quickstarts/tree/3.20/security-webauthn-quickstart">ディレクトリ</a> にあります。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="creating-the-maven-project"><a class="anchor" href="#creating-the-maven-project"></a>Mavenプロジェクトの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>まず、新しいプロジェクトが必要です。以下のコマンドで新規プロジェクトを作成します。</p>
</div>
<div class="sidebarblock primary asciidoc-tabs-sync-cli">
<div class="content">
<div class="title">コマンドラインインタフェース</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus create app org.acme:security-webauthn-quickstart \
    --extension='security-webauthn,jdbc-postgresql,rest,hibernate-orm-panache' \
    --no-code
cd security-webauthn-quickstart</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradleプロジェクトを作成するには、 <code>--gradle</code> または <code>--gradle-kotlin-dsl</code> オプションを追加します。</p>
</div>
<div class="paragraph">
<p>Quarkus CLIのインストールと使用方法の詳細については、 <a href="cli-tooling">Quarkus CLI</a> ガイドを参照してください。</p>
</div>
</div>
</div>
<div class="sidebarblock secondary asciidoc-tabs-sync-maven">
<div class="content">
<div class="title">Maven</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn io.quarkus.platform:quarkus-maven-plugin:3.20.5:create \
    -DprojectGroupId=org.acme \
    -DprojectArtifactId=security-webauthn-quickstart \
    -Dextensions='security-webauthn,jdbc-postgresql,rest,hibernate-orm-panache' \
    -DnoCode
cd security-webauthn-quickstart</code></pre>
</div>
</div>
<div class="paragraph">
<p>Gradleプロジェクトを作成するには、 <code>-DbuildTool=gradle</code> または <code>-DbuildTool=gradle-kotlin-dsl</code> オプションを追加します。</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Windowsユーザーの場合:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>cmdを使用する場合、（バックスラッシュ <code>\</code> を使用せず、すべてを同じ行に書かないでください）。</p>
</li>
<li>
<p>Powershellを使用する場合は、 <code>-D</code> パラメータを二重引用符で囲んでください。例: <code>"-DprojectArtifactId=security-webauthn-quickstart"</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>選択したデータベースコネクタライブラリを追加することを忘れないでください。ここでは、PostgreSQLをIDストアとして使用しています。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>このコマンドは Maven プロジェクトを生成し、WebAuthn を使ってユーザー認証を行うための <code>security-webauthn</code> エクステンションをインポートします。</p>
</div>
<div class="paragraph">
<p>Quarkusプロジェクトをすでに設定している場合は、プロジェクトのベースディレクトリで次のコマンドを実行することで、 <code>security-webauthn</code> エクステンションをプロジェクトに追加できます。</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">コマンドラインインタフェース</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus extension add security-webauthn</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:add-extension -Dextensions='security-webauthn'</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew addExtension --extensions='security-webauthn'</code></pre>
</div>
</div>
<div class="paragraph">
<p>これにより、 <code>pom.xml</code> に以下が追加されます:</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-security-webauthn&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">implementation("io.quarkus:quarkus-security-webauthn")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="writing-the-application"><a class="anchor" href="#writing-the-application"></a>アプリケーションの記述</h2>
<div class="sectionbody">
<div class="paragraph">
<p>まず、 <code>/api/public</code> のエンドポイントを実装することから始めましょう。以下のソースコードからわかるように、これは通常のJakarta RESTリソースに過ぎません:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.webauthn;

import java.security.Principal;

import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;
import jakarta.ws.rs.Produces;
import jakarta.ws.rs.core.Context;
import jakarta.ws.rs.core.MediaType;
import jakarta.ws.rs.core.SecurityContext;

@Path("/api/public")
public class PublicResource {

    @GET
    @Produces(MediaType.TEXT_PLAIN)
    public String publicResource() {
        return "public";
   }

    @GET
    @Path("/me")
    @Produces(MediaType.TEXT_PLAIN)
    public String me(@Context SecurityContext securityContext) {
        Principal user = securityContext.getUserPrincipal();
        return user != null ? user.getName() : "&lt;not logged in&gt;";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>/api/admin</code> エンドポイントのソースコードも非常にシンプルです。ここでの主な違いは、 <code>admin</code> ロールで付与されたユーザーだけがエンドポイントにアクセスできるように <code>@RolesAllowed</code> アノテーションを使用していることです:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.webauthn;

import jakarta.annotation.security.RolesAllowed;
import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;
import jakarta.ws.rs.Produces;
import jakarta.ws.rs.core.MediaType;

@Path("/api/admin")
public class AdminResource {

    @GET
    @RolesAllowed("admin")
    @Produces(MediaType.TEXT_PLAIN)
    public String adminResource() {
         return "admin";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>最後に、 <code>/api/users/me</code> エンドポイントを考えてみましょう。下のソースコードを見ればわかるように、 <code>user</code> の役割を持つユーザのみを信頼しています。現在認証されているプリンシパルへのアクセスを得るために <code>SecurityContext</code> を使用しており、ユーザーの名前を返します。この情報はデータベースから読み込まれます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.webauthn;

import jakarta.annotation.security.RolesAllowed;
import jakarta.ws.rs.GET;
import jakarta.ws.rs.Path;
import jakarta.ws.rs.core.Context;
import jakarta.ws.rs.core.SecurityContext;

@Path("/api/users")
public class UserResource {

    @GET
    @RolesAllowed("user")
    @Path("/me")
    public String me(@Context SecurityContext securityContext) {
        return securityContext.getUserPrincipal().getName();
    }
}</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="storing-our-webauthn-credentials"><a class="anchor" href="#storing-our-webauthn-credentials"></a>WebAuthnのクレデンシャルの保存</h3>
<div class="paragraph">
<p>これで、WebAuthn 認証情報がデータベースにどのように保存されるかを、2 つのエンティティーで説明できるようになりました。
ユーザーごとに認証情報を 1 つしか保存しないように、モデルを簡略化した点に注意してください (ユーザーは実際には複数の WebAuthn 認証情報
とロールなどの他のデータを持つことが可能)。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.webauthn;

import java.util.List;
import java.util.UUID;

import io.quarkus.hibernate.orm.panache.PanacheEntityBase;
import io.quarkus.security.webauthn.WebAuthnCredentialRecord;
import io.quarkus.security.webauthn.WebAuthnCredentialRecord.RequiredPersistedData;
import jakarta.persistence.Entity;
import jakarta.persistence.Id;
import jakarta.persistence.OneToOne;

@Entity
public class WebAuthnCredential extends PanacheEntityBase {

	@Id
    public String credentialId;

    public byte[] publicKey;
    public long publicKeyAlgorithm;
    public long counter;
    public UUID aaguid;

    // this is the owning side
    @OneToOne
    public User user;

    public WebAuthnCredential() {
    }

    public WebAuthnCredential(WebAuthnCredentialRecord credentialRecord, User user) {
        RequiredPersistedData requiredPersistedData =
            credentialRecord.getRequiredPersistedData();
        aaguid = requiredPersistedData.aaguid();
        counter = requiredPersistedData.counter();
        credentialId = requiredPersistedData.credentialId();
        publicKey = requiredPersistedData.publicKey();
        publicKeyAlgorithm = requiredPersistedData.publicKeyAlgorithm();
        this.user = user;
        user.webAuthnCredential = this;
    }

    public WebAuthnCredentialRecord toWebAuthnCredentialRecord() {
        return WebAuthnCredentialRecord
                .fromRequiredPersistedData(
                        new RequiredPersistedData(user.username, credentialId,
                                                  aaguid, publicKey,
                                                  publicKeyAlgorithm, counter));
    }

    public static List&lt;WebAuthnCredential&gt; findByUsername(String username) {
        return list("user.username", username);
    }

    public static WebAuthnCredential findByCredentialId(String credentialId) {
        return findById(credentialId);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>ユーザーエンティティーは次のようになります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.webauthn;

import io.quarkus.hibernate.orm.panache.PanacheEntity;
import jakarta.persistence.Column;
import jakarta.persistence.Entity;
import jakarta.persistence.OneToOne;
import jakarta.persistence.Table;

@Table(name = "user_table")
@Entity
public class User extends PanacheEntity {

    @Column(unique = true)
    public String username;

    // non-owning side, so we can add more credentials later
    @OneToOne(mappedBy = "user")
    public WebAuthnCredential webAuthnCredential;

    public static User findByUsername(String username) {
        return User.find("username", username).firstResult();
    }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="a-note-about-usernames-and-credential-ids"><a class="anchor" href="#a-note-about-usernames-and-credential-ids"></a>ユーザー名とクレデンシャルIDに関する注意点</h4>
<div class="paragraph">
<p>ユーザー名はユーザーごとに一意です。作成されたすべての WebAuthn 認証情報レコードには一意の ID があります。</p>
</div>
<div class="paragraph">
<p>ユーザーが複数のオーセンティケーターデバイスを持つことを許可することもできます (必要に応じてであり、必須ではありません)。
つまり、単一のユーザー名を複数の認証情報 ID にマップすることができ、それらはすべて同じユーザーを識別します。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="exposing-your-entities-to-quarkus-webauthn"><a class="anchor" href="#exposing-your-entities-to-quarkus-webauthn"></a>Quarkus WebAuthnにエンティティを公開する</h3>
<div class="paragraph">
<p>Quarkus WebAuthn エクステンションが認証情報をロードして保存できるようにするには、<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnUserProvider.html"><code>WebAuthnUserProvider</code></a> を実装する Bean を
定義する必要があります。ここで、Quarkus に対してデータモデルを WebAuthn の
セキュリティーモデルに変換する方法を指定します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import java.util.Collections;
import java.util.List;
import java.util.Set;

import io.quarkus.security.webauthn.WebAuthnCredentialRecord;
import io.quarkus.security.webauthn.WebAuthnUserProvider;
import io.smallrye.common.annotation.Blocking;
import io.smallrye.mutiny.Uni;
import jakarta.enterprise.context.ApplicationScoped;
import jakarta.transaction.Transactional;

@Blocking
@ApplicationScoped
public class MyWebAuthnSetup implements WebAuthnUserProvider {

    @Transactional
    @Override
    public Uni&lt;List&lt;WebAuthnCredentialRecord&gt;&gt; findByUsername(String userId) {
        return Uni.createFrom().item(
            WebAuthnCredential.findByUsername(userId)
                              .stream()
                              .map(WebAuthnCredential::toWebAuthnCredentialRecord)
                              .toList());
    }

    @Transactional
    @Override
    public Uni&lt;WebAuthnCredentialRecord&gt; findByCredentialId(String credId) {
        WebAuthnCredential creds = WebAuthnCredential.findByCredentialId(credId);
        if(creds == null)
            return Uni.createFrom()
                      .failure(new RuntimeException("No such credential ID"));
        return Uni.createFrom().item(creds.toWebAuthnCredentialRecord());
    }

    @Transactional
    @Override
    public Uni&lt;Void&gt; store(WebAuthnCredentialRecord credentialRecord) {
        User newUser = new User();
        // We can only store one credential per username thanks to the unicity constraint
        // which will cause this transaction to fail and throw if the username already exists
        newUser.username = credentialRecord.getUsername();
        WebAuthnCredential credential = new WebAuthnCredential(credentialRecord, newUser);
        credential.persist();
        newUser.persist();
        return Uni.createFrom().voidItem();
    }

    @Transactional
    @Override
    public Uni&lt;Void&gt; update(String credentialId, long counter) {
        WebAuthnCredential credential =
            WebAuthnCredential.findByCredentialId(credentialId);
        credential.counter = counter;
        return Uni.createFrom().voidItem();
    }

    @Override
    public Set&lt;String&gt; getRoles(String userId) {
        if(userId.equals("admin")) {
            return Set.of("user", "admin");
        }
        return Collections.singleton("user");
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>警告: 独自の <code>WebAuthnUserProvider.store</code> メソッドを実装する際は、既に存在する <code>username</code> に対して新しい認証情報の作成を
許可しないようにします。そうしないと、サードパーティーが既存ユーザーになりすまし、
自分の認証情報を既存のアカウントに追加できてしまうリスクがあります。
既存ユーザーが複数の WebAuthn 認証情報を登録できるようにしたい場合は、新しい認証情報を追加する際に、そのユーザーが現在同じ <code>username</code> でログインしていることを 
<code>WebAuthnUserProvider.store</code> 内で確認する必要があります。それ以外の場合は、このメソッドから失敗した <code>Uni</code> を必ず返してください。
この具体的な例では、ユーザー名に対する一意性制約を設けることでチェックを行っており、
すでに存在するユーザーに対して処理が実行されるとトランザクションが失敗するようになっています。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a>設定</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ログインと登録をデフォルトの Quarkus WebAuthn エンドポイントに委譲したいため、設定内 (<code>src/main/resources/application.properties</code>) でそれらを
有効にする必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.webauthn.enable-login-endpoint=true
quarkus.webauthn.enable-registration-endpoint=true</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="writing-the-html-application"><a class="anchor" href="#writing-the-html-application"></a>HTMLアプリケーションの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>次に、すべてのAPIへのリンクと、新規ユーザー登録、ログイン、ログアウトを行うためのWebページを <code>src/main/resources/META-INF/resources/index.html</code> に記述する必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-html hljs" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Login&lt;/title&gt;
    &lt;script src="/q/webauthn/webauthn.js" type="text/javascript" charset="UTF-8"&gt;&lt;/script&gt;
    &lt;style&gt;
     .container {
      display: grid;
      grid-template-columns: auto auto auto;
     }
     button, input {
      margin: 5px 0;
     }
     .item {
      padding: 20px;
     }
     nav &gt; ul {
       list-style-type: none;
       margin: 0;
       padding: 0;
       overflow: hidden;
       background-color: #333;
     }

     nav &gt; ul &gt; li {
       float: left;
     }

     nav &gt; ul &gt; li &gt; a {
       display: block;
       color: white;
       text-align: center;
       padding: 14px 16px;
       text-decoration: none;
     }

     nav &gt; ul &gt; li &gt; a:hover {
       background-color: #111;
     }
    &lt;/style&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;nav&gt;
     &lt;ul&gt;
      &lt;li&gt;&lt;a href="/api/public"&gt;Public API&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href="/api/users/me"&gt;User API&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href="/api/admin"&gt;Admin API&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href="/q/webauthn/logout"&gt;Logout&lt;/a&gt;&lt;/li&gt;
     &lt;/ul&gt;
    &lt;/nav&gt;
    &lt;div class="container"&gt;
     &lt;div class="item"&gt;
      &lt;h1&gt;Status&lt;/h1&gt;
      &lt;div id="result"&gt;&lt;/div&gt;
     &lt;/div&gt;
     &lt;div class="item"&gt;
      &lt;h1&gt;Login&lt;/h1&gt;
      &lt;p&gt;
       &lt;button id="login"&gt;Login&lt;/button&gt;
      &lt;/p&gt;
     &lt;/div&gt;
     &lt;div class="item"&gt;
      &lt;h1&gt;Register&lt;/h1&gt;
      &lt;p&gt;
       &lt;input id="usernameRegister" placeholder="User name"/&gt;&lt;br/&gt;
       &lt;input id="firstName" placeholder="First name"/&gt;&lt;br/&gt;
       &lt;input id="lastName" placeholder="Last name"/&gt;&lt;br/&gt;
       &lt;button id="register"&gt;Register&lt;/button&gt;
      &lt;/p&gt;
     &lt;/div&gt;
    &lt;/div&gt;
    &lt;script type="text/javascript"&gt;
      const webAuthn = new WebAuthn();

      const result = document.getElementById('result');

      fetch('/api/public/me')
        .then(response =&gt; response.text())
        .then(username =&gt; result.append("User: "+username));

      const loginButton = document.getElementById('login');

      loginButton.addEventListener("click", (e) =&gt; {
        result.replaceChildren();
        webAuthn.login()
          .then(x =&gt; fetch('/api/public/me'))
          .then(response =&gt; response.text())
          .then(username =&gt; {
            result.append("User: "+username);
          })
          .catch(err =&gt; {
            result.append("Login failed: "+err);
          });
        return false;
      });

      const registerButton = document.getElementById('register');

      registerButton.addEventListener("click", (e) =&gt; {
        var username = document.getElementById('usernameRegister').value;
        var firstName = document.getElementById('firstName').value;
        var lastName = document.getElementById('lastName').value;
        result.replaceChildren();
        webAuthn.register({ username: username, displayName: firstName + " " + lastName })
          .then(body =&gt; {
            result.append("User: "+username);
          })
          .catch(err =&gt; {
            result.append("Registration failed: "+err);
          });
        return false;
      });
    &lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trying-the-application"><a class="anchor" href="#trying-the-application"></a>アプリケーションを試す</h2>
<div class="sectionbody">
<div class="paragraph">
<p>アプリケーションは保護され、IDは私たちのデータベースから提供されるようになりました。</p>
</div>
<div class="paragraph">
<p>次のようにdevモードでアプリケーションを実行します:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">コマンドラインインタフェース</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus dev</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew --console=plain quarkusDev</code></pre>
</div>
</div>
<div class="paragraph">
<p>これで、PostgreSQL Dev Service コンテナが起動します。ブラウザで <a href="http://localhost:8080" class="bare">http://localhost:8080</a> を開いてください。</p>
</div>
<div class="paragraph">
<p>初期状態では、クレデンシャルが登録されておらず、現在のユーザーもいない状態です。</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="./images/webauthn-1.png" alt="webauthn 1">
</div>
</div>
<div class="paragraph">
<p>左側に現在のユーザーが表示され、上部メニューで公開APIにアクセスしてみると、うまくいくはずですが、ユーザーAPIとadmin APIは失敗して現在のページにリダイレクトされます。</p>
</div>
<div class="paragraph">
<p>まず、右側の <code>Register</code> フォームにユーザー名、氏名を入力し、 <code>Register</code> ボタンを押して、WebAuthn のクレデンシャルを登録します:</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="./images/webauthn-2.png" alt="webauthn 2">
</div>
</div>
<div class="paragraph">
<p>ブラウザーが WebAuthn オーセンティケーターを有効化するよう求めてきます (WebAuthn 対応のブラウザーと、
場合によってはデバイスが必要です。または、 <a href="https://developer.chrome.com/docs/devtools/webauthn/">それらのエミュレーター</a> を使用することもできます）。</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="./images/webauthn-3.png" alt="webauthn 3">
</div>
</div>
<div class="paragraph">
<p>その後、ログインし、ユーザーAPIにアクセスできるようになったことを確認できます。</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="./images/webauthn-4.png" alt="webauthn 4">
</div>
</div>
<div class="paragraph">
<p>この段階で <code>Logout</code> できます。</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="./images/webauthn-5.png" alt="webauthn 5">
</div>
</div>
<div class="paragraph">
<p>その後、 <code>Login</code> ボタンを押せば、ログイン状態になります:</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="./images/webauthn-4.png" alt="webauthn 4">
</div>
</div>
<div class="paragraph">
<p>admin APIは、 <code>admin</code> のユーザー名で登録した場合のみアクセス可能です。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="explanation-of-the-flow-for-webauthn-authentication"><a class="anchor" href="#explanation-of-the-flow-for-webauthn-authentication"></a>WebAuthn 認証のフローの説明</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ユーザーと認証情報の作成を処理する方法には、次の 2 つの操作モードがあります。</p>
</div>
<div class="paragraph">
<p>デフォルトでは、これまでに見てきたソリューションは、このエクステンションが標準で提供する <a href="#WebAuthn endpoints">[WebAuthn endpoints]</a> を通じて、
ユーザーおよび認証情報の作成とログインを自動的に処理します。</p>
</div>
<div class="paragraph">
<p>このシナリオでは、Quarkus に認証情報の検索、保存、および更新方法を伝えるために、
<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnUserProvider.html"><code>WebAuthnUserProvider</code></a> の提供のみを実行します (詳細は 
<a href="#Exposing your entities to Quarkus WebAuthn">[Exposing your entities to Quarkus WebAuthn]</a> を参照)。</p>
</div>
<div class="paragraph">
<p>したがって、クライアントで登録をトリガーするには、サーバーからチャレンジを取得する必要があります (<a href="#Obtain a registration challenge">[Obtain a registration challenge]</a> 
を参照)。取得したチャレンジはクライアントに返され、クライアントはそれを使用して
新しい認証情報を作成し、それをサーバーに送信します (<a href="#Trigger a registration">[Trigger a registration]</a> を参照)。
サーバーは、認証情報を保存し、ユーザーをログインさせます。</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="./images/webauthn-register.svg" alt="webauthn register">
</div>
</div>
<div class="paragraph">
<p>その後、クライアントでログインをトリガーするには、サーバーからチャレンジを取得する必要があります (<a href="#Obtain a login challenge">[Obtain a login challenge]</a> を参照）。
取得したチャレンジはクライアントに返され、
クライアントはそれを使用して必要な認証情報を取得し、それらの証明をサーバーに送信します (<a href="#Trigger a login">[Trigger a login]</a> を参照）。
サーバーは認証情報を更新し、ユーザーをログインさせます。</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="./images/webauthn-login.svg" alt="webauthn login">
</div>
</div>
<div class="paragraph">
<p>登録とログインフローをカスタマイズしたい場合は、独自のロジックを使用して、
ユーザーと認証情報の作成およびログインも自身で処理できます (<a href="#Handling login and registration endpoints yourself">[Handling login and registration endpoints yourself]</a> を参照)。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="webauthn-endpoints"><a class="anchor" href="#webauthn-endpoints"></a>WebAuthnのエンドポイント</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus WebAuthnエクステンションには、これらのRESTエンドポイントがあらかじめ定義されています:</p>
</div>
<div class="sect2">
<h3 id="obtain-a-registration-challenge"><a class="anchor" href="#obtain-a-registration-challenge"></a>登録チャレンジの取得</h3>
<div class="paragraph">
<p><code>GET /q/webauthn/register-options-challenge?username=&lt;username&gt;&amp;displayName=&lt;displayName&gt;</code>: 登録チャレンジをセットアップして取得する</p>
</div>
<div class="paragraph">
<p>クエリーパラメーター</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>username</code> はユーザー名です。必須です。</p>
</li>
<li>
<p><code>displayName</code> は、判読しやすいユーザーアカウントの名前です。オプションです。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>これにより、チャレンジ用の Cookie が設定され、後で登録手順で使用されます。</p>
</div>
<div class="listingblock">
<div class="title">レスポンス</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
 "rp": {
   "name": "Quarkus server"
  },
 "user": {
   "id": "ryPi43NJSx6LFYNitrOvHg",
   "name": "FroMage",
   "displayName": "Mr Nice Guy"
  },
  "challenge": "6tkVLgYzp5yJz_MtnzCy6VRMkHuN4f4C-_hukRmsuQ_MQl7uxJweiqH8gaFkm_mEbKzlUbOabJM3nLbi08i1Uw",
  "pubKeyCredParams": [
    {
     "alg": -7,
     "type":"public-key"
    },
    {
     "alg": -257,
     "type": "public-key"
    }
  ],
  "authenticatorSelection": {
    "requireResidentKey": true,
    "residentKey": "required",
    "userVerification": "required"
  },
  "timeout": 300000,
  "attestation": "none",
  "extensions": {
   "txAuthSimple": ""
  }
 }</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trigger-a-registration"><a class="anchor" href="#trigger-a-registration"></a>登録をトリガーする</h3>
<div class="paragraph">
<p><code>POST /q/webauthn/register?username=&lt;username&gt;</code>: 登録をトリガーする</p>
</div>
<div class="paragraph">
<p>クエリーパラメーター</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>username</code> はユーザー名です。必須です。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>これは、登録チャレンジによって設定されたチャレンジ Cookie を使用し、それをクリアします。
また、<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnUserProvider.html"><code>WebAuthnUserProvider</code></a> を使用して新しい認証情報を保存し、
<a href="#configuration-reference">session cookie</a> をセットアップしてログインできるようにします。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
これは、 <code>quarkus.webauthn.enable-registration-endpoint</code> 設定が <code>true</code> に設定されている場合にのみ有効になります。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">リクエスト</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
 "id": "boMwU-QwZ_RsToPTG3iC50g8-yiKbLc3A53tgWMhzbNEQAJIlbWgchmwbt5m0ssqQNR0IM_WxCmcfKWlEao7Fg",
 "rawId": "boMwU-QwZ_RsToPTG3iC50g8-yiKbLc3A53tgWMhzbNEQAJIlbWgchmwbt5m0ssqQNR0IM_WxCmcfKWlEao7Fg",
 "response": {
  "attestationObject": "&lt;DATA&gt;",
  "clientDataJSON":"&lt;DATA&gt;"
 },
 "type": "public-key"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>これは、ボディを持たない204を返却します</p>
</div>
</div>
<div class="sect2">
<h3 id="obtain-a-login-challenge"><a class="anchor" href="#obtain-a-login-challenge"></a>ログインチャレンジの取得</h3>
<div class="paragraph">
<p><code>GET /q/webauthn/login-options-challenge?username=&lt;username&gt;</code>: ログインチャレンジをセットアップして取得する</p>
</div>
<div class="paragraph">
<p>クエリーパラメーター</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>username</code> はユーザー名です。 <a href="https://www.w3.org/TR/webauthn-3/#discoverable-credential">Discoverable Credentials</a> (PassKeys 付き) の場合はオプションです。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>これにより、チャレンジ用の Cookie が設定され、後でログイン手順で使用されます。</p>
</div>
<div class="listingblock">
<div class="title">レスポンス</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
 "challenge": "RV4hqKHezkWSxpOICBkpx16yPJFGMZrkPlJP-Wp8w4rVl34VIzCT7AP0Q5Rv-3JCU3jwu-j3VlOgyNMDk2AqDg",
 "timeout": 300000,
 "userVerification": "required",
 "extensions": {
  "txAuthSimple": ""
 },
 "allowCredentials": [
  {
   "type": "public-key",
   "id": "boMwU-QwZ_RsToPTG3iC50g8-yiKbLc3A53tgWMhzbNEQAJIlbWgchmwbt5m0ssqQNR0IM_WxCmcfKWlEao7Fg",
   "transports": [
    "usb",
    "nfc",
    "ble",
    "internal"
   ]
  }
 ]
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trigger-a-login"><a class="anchor" href="#trigger-a-login"></a>ログインをトリガーする</h3>
<div class="paragraph">
<p>これは、ログインチャレンジによって設定されたチャレンジ Cookie を使用し、
それをクリアします。また、<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnUserProvider.html"><code>WebAuthnUserProvider</code></a> を使用して認証情報を探して保存し、
<a href="#configuration-reference">session cookie</a> をセットアップしてログインできるようにします。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
これは、 <code>quarkus.webauthn.enable-login-endpoint</code> 設定が <code>true</code> に設定されている場合にのみ有効になります。
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">リクエスト</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
 "id": "boMwU-QwZ_RsToPTG3iC50g8-yiKbLc3A53tgWMhzbNEQAJIlbWgchmwbt5m0ssqQNR0IM_WxCmcfKWlEao7Fg",
 "rawId": "boMwU-QwZ_RsToPTG3iC50g8-yiKbLc3A53tgWMhzbNEQAJIlbWgchmwbt5m0ssqQNR0IM_WxCmcfKWlEao7Fg",
 "response": {
  "clientDataJSON": "&lt;DATA&gt;",
  "authenticatorData": "&lt;DATA&gt;",
  "signature": "&lt;DATA&gt;",
  "userHandle": ""
 },
 "type": "public-key"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>これは、ボディを持たない204を返却します</p>
</div>
</div>
<div class="sect2">
<h3 id="logout"><a class="anchor" href="#logout"></a>ログアウト</h3>
<div class="paragraph">
<p><code>GET /q/webauthn/logout</code> :ログアウトします。</p>
</div>
<div class="paragraph">
<p>これにより、<a href="#configuration-reference">session cookie</a> がクリアされ、ログアウトできます。</p>
</div>
<div class="paragraph">
<p>これは、アプリケーションのルートURIへの302リダイレクトを返します。</p>
</div>
</div>
<div class="sect2">
<h3 id="related-origins"><a class="anchor" href="#related-origins"></a>Related Origins</h3>
<div class="paragraph">
<p><code>GET /.well-known/webauthn</code>: <a href="https://passkeys.dev/docs/advanced/related-origins/">related origins</a> のリストを取得する</p>
</div>
<div class="paragraph">
<p>これは Quarkus がデプロイされている現在のオリジンにデフォルト設定されますが、<a href="#quarkus-security-webauthn_quarkus-webauthn-origins">設定</a> することができます。</p>
</div>
<div class="listingblock">
<div class="title">レスポンス</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "origins": [
    "https://shopping.com",
    "https://shopping.co.uk",
    "https://shopping.co.jp",
    "https://shopping.ie",
    "https://shopping.ca",
    "https://shopping.net",
    "https://shopping.org",
    "https://shopping.github.io"
  ]
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="webauthn-javascript-library"><a class="anchor" href="#webauthn-javascript-library"></a>WebAuthn JavaScript ライブラリ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ブラウザでWebAuthnを設定するには多くのJavaScriptが必要なため、Quarkus WebAuthnエクステンションには、WebAuthnのエンドポイントとの対話を支援するJavaScriptライブラリが同梱されています（ <code>/q/webauthn/webauthn.js</code> ）。このように設定することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">&lt;script src="/q/webauthn/webauthn.js" type="text/javascript" charset="UTF-8"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
  // keep the default /q/webauthn endpoints
  const webAuthn = new WebAuthn();
  // use the webAuthn APIs here
&lt;/script&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>または、エンドポイントをカスタマイズする必要がある場合は、以下のようになります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">&lt;script src="/q/webauthn/webauthn.js" type="text/javascript" charset="UTF-8"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
  // configure where our endpoints are
  const webAuthn = new WebAuthn({
    registerOptionsChallengePath: '/q/webauthn/register-options-challenge',
    loginOptionsChallengePath: '/q/webauthn/login-options-challenge',
    registerPath: '/q/webauthn/register',
    loginPath: '/q/webauthn/login'
  });
  // use the webAuthn APIs here
&lt;/script&gt;</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="csrf-considerations"><a class="anchor" href="#csrf-considerations"></a>CSRF に関する考慮事項</h3>
<div class="paragraph">
<p>Quarkus が提供するエンドポイントを使用する場合、xdoc:security-csrf-prevention.adoc[CSRF] によって保護されませんが、
独自のエンドポイントを定義し、この JavaScript ライブラリーを使用してそれらにアクセスする場合は、ヘッダー経由で CSRF を設定する必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">&lt;script src="/q/webauthn/webauthn.js" type="text/javascript" charset="UTF-8"&gt;&lt;/script&gt;
&lt;script type="text/javascript"&gt;
  // configure where our endpoints are
  const webAuthn = new WebAuthn({
    'csrf': {
      'header': '{inject:csrf.headerName}',
      'value': '{inject:csrf.token}'
	}
  });
  // use the webAuthn APIs here
&lt;/script&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="invoke-registration"><a class="anchor" href="#invoke-registration"></a>登録の呼出</h3>
<div class="paragraph">
<p><code>webAuthn.register</code> メソッドは、登録チャレンジエンドポイントを呼び出し、次にオーセンティケーターを呼び出してその登録のための登録エンドポイントを呼び出し、
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise オブジェクト</a> を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">webAuthn.register({ username: username, displayName: firstName + " " + lastName })
  .then(body =&gt; {
    // do something now that the user is registered
  })
  .catch(err =&gt; {
    // registration failed
  });</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="invoke-login"><a class="anchor" href="#invoke-login"></a>ログインの呼出</h3>
<div class="paragraph">
<p><code>webAuthn.login</code> メソッドは、ログインチャレンジエンドポイントを呼び出し、次にオーセンティケーターを呼び出してそのログインのためのログインエンドポイントを呼び出し、
<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise オブジェクト</a> を返します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">webAuthn.login({ username: username }) <i class="conum" data-value="1"></i><b>(1)</b>
  .then(body =&gt; {
    // do something now that the user is logged in
  })
  .catch(err =&gt; {
    // login failed
  });</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://www.w3.org/TR/webauthn-3/#discoverable-credential">Discoverable Credentials</a> (PassKeys 付き) の場合、ユーザー名はオプションです。</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="only-invoke-the-registration-challenge-and-authenticator"><a class="anchor" href="#only-invoke-the-registration-challenge-and-authenticator"></a>登録チャレンジと認証デバイスのみを呼出</h3>
<div class="paragraph">
<p><code>webAuthn.registerClientSteps</code> メソッドは、登録チャレンジエンドポイントを呼び出し、次にオーセンティケーターを呼び出して、
登録エンドポイントへの送信に適した JSON オブジェクトを含む
 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise オブジェクト</a> を返します。この JSON オブジェクトを使用して、たとえば、認証情報を非表示フォームの <code>input</code> に保存し、
通常の HTML フォームの一部として送信できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">webAuthn.registerClientSteps({ username: username, displayName: firstName + " " + lastName })
  .then(body =&gt; {
    // store the registration JSON in form elements
    document.getElementById('webAuthnId').value = body.id;
    document.getElementById('webAuthnRawId').value = body.rawId;
    document.getElementById('webAuthnResponseAttestationObject').value = body.response.attestationObject;
    document.getElementById('webAuthnResponseClientDataJSON').value = body.response.clientDataJSON;
    document.getElementById('webAuthnType').value = body.type;
  })
  .catch(err =&gt; {
    // registration failed
  });</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="only-invoke-the-login-challenge-and-authenticator"><a class="anchor" href="#only-invoke-the-login-challenge-and-authenticator"></a>ログインチャレンジと認証デバイスのみを呼出</h3>
<div class="paragraph">
<p><code>webAuthn.loginClientSteps</code> メソッドはログインチャレンジのエンドポイントを呼び出し、次にオーセンティケーターを呼び出して、
ログインエンドポイントへの送信に適した JSON オブジェクトを
含む <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise オブジェクト</a> を返します。この JSON オブジェクトを使用して、たとえば、認証情報を非表示フォームの <code>input</code> に保存し、
通常の HTML フォームの一部として送信できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">webAuthn.loginClientSteps({ username: username }) <i class="conum" data-value="1"></i><b>(1)</b>
  .then(body =&gt; {
    // store the login JSON in form elements
    document.getElementById('webAuthnId').value = body.id;
    document.getElementById('webAuthnRawId').value = body.rawId;
    document.getElementById('webAuthnResponseClientDataJSON').value = body.response.clientDataJSON;
    document.getElementById('webAuthnResponseAuthenticatorData').value = body.response.authenticatorData;
    document.getElementById('webAuthnResponseSignature').value = body.response.signature;
    document.getElementById('webAuthnResponseUserHandle').value = body.response.userHandle;
    document.getElementById('webAuthnType').value = body.type;
  })
  .catch(err =&gt; {
    // login failed
  });</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="https://www.w3.org/TR/webauthn-3/#discoverable-credential">Discoverable Credentials</a> (PassKeys 付き) の場合、ユーザー名はオプションです。</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="handling-login-and-registration-endpoints-yourself"><a class="anchor" href="#handling-login-and-registration-endpoints-yourself"></a>ログインと登録のエンドポイントを自分でハンドリングする</h2>
<div class="sectionbody">
<div class="paragraph">
<p>ユーザーを登録するために、ユーザー名だけでなく、追加のデータを要求したり、カスタムバリデーションでログインや登録を
処理したりする必要がある場合があります。そのため、デフォルトの WebAuthn ログインおよび登録エンドポイントでは
十分でないことがあります。</p>
</div>
<div class="paragraph">
<p>この場合、JavaScript ライブラリーの <code>WebAuthn.loginClientSteps</code> と <code>WebAuthn.registerClientSteps</code> メソッドを使用して、
オーセンティケーターデータを非表示フォーム要素に保存し、
それらをフォームのペイロードの一部としてサーバーのカスタムログインまたは登録エンドポイントに送信できます。</p>
</div>
<div class="paragraph">
<p>フォーム入力要素に保存する場合、<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnLoginResponse.html"><code>WebAuthnLoginResponse</code></a> および
<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnRegistrationResponse.html"><code>WebAuthnRegistrationResponse</code></a> クラスを使用し、
それらに <code>@BeanParam</code> を付与することで
<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnSecurity.html#login(io.quarkus.security.webauthn.WebAuthnLoginResponse,io.vertx.ext.web.RoutingContext)"><code>WebAuthnSecurity.login</code></a>
および <a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnSecurity.html#register(io.quarkus.security.webauthn.WebAuthnRegisterResponse,io.vertx.ext.web.RoutingContext)"><code>WebAuthnSecurity.register</code></a> メソッドを使用して、
<code>/q/webauthn/login</code> および <code>/q/webauthn/register</code> エンドポイントを置き換えることができます。</p>
</div>
<div class="paragraph">
<p>ほとんどの場合、 <code>/q/webauthn/login-options-challenge</code> と <code>/q/webauthn/register-options-challenge</code> のチャレンジ開始エンドポイントを使い続けることができます。
ここでは、カスタムロジックが必要ないためです。</p>
</div>
<div class="paragraph">
<p>この場合、登録フローは少し異なります。認証情報の保存とセッション Cookie のセットアップを処理する
独自の登録エンドポイントを作成するためです。</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="./images/webauthn-custom-register.svg" alt="webauthn custom register">
</div>
</div>
<div class="paragraph">
<p>同様に、ログインフローも少し異なります。独自のログインエンドポイントを作成するためです。
このログインエンドポイントは、認証情報の更新とセッション Cookie のセットアップを処理します。</p>
</div>
<div class="imageblock thumb">
<div class="content">
<img src="./images/webauthn-custom-login.svg" alt="webauthn custom login">
</div>
</div>
<div class="paragraph">
<p>ユーザーおよび認証情報の作成やログインを自身でエンドポイントで処理する場合、
<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnUserProvider.html"><code>WebAuthnUserProvider</code></a> にエンティティーの読み取り専用ビューを提供することのみが必要です。そのため、 <code>store</code> および `update`メソッド
は省略できます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.webauthn;

import java.util.List;

import io.quarkus.security.webauthn.WebAuthnCredentialRecord;
import io.quarkus.security.webauthn.WebAuthnUserProvider;
import io.smallrye.common.annotation.Blocking;
import io.smallrye.mutiny.Uni;
import jakarta.enterprise.context.ApplicationScoped;
import jakarta.transaction.Transactional;
import model.WebAuthnCredential;

@Blocking
@ApplicationScoped
public class MyWebAuthnSetup implements WebAuthnUserProvider {

    @Transactional
    @Override
    public Uni&lt;List&lt;WebAuthnCredentialRecord&gt;&gt; findByUsername(String username) {
        return Uni.createFrom().item(
            WebAuthnCredential.findByUsername(username)
                              .stream()
                              .map(WebAuthnCredential::toWebAuthnCredentialRecord)
                              .toList());
    }

    @Transactional
    @Override
    public Uni&lt;WebAuthnCredentialRecord&gt; findByCredentialId(String credentialId) {
        WebAuthnCredential creds = WebAuthnCredential.findByCredentialId(credentialId);
        if(creds == null)
            return Uni.createFrom()
                      .failure(new RuntimeException("No such credential ID"));
        return Uni.createFrom().item(creds.toWebAuthnCredentialRecord());
    }

    @Override
    public Set&lt;String&gt; getRoles(String userId) {
        if(userId.equals("admin")) {
            return Set.of("user", "admin");
        }
        return Collections.singleton("user");
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
独自のログインおよび登録エンドポイントを設定する場合、デフォルトのエンドポイントを有効にする必要はありません。これにより、
<code>quarkus.webauthn.enable-login-endpoint</code> および <code>quarkus.webauthn.enable-registration-endpoint</code> 設定を削除できます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ありがたいことに、次のリンクを使用できます:https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnSecurity.html[<code>WebAuthnSecurity</code>] Bean は WebAuthn 固有の部分を処理します
登録とログインのエンドポイントを分離し、独自のロジックに集中します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.webauthn;

import jakarta.inject.Inject;
import jakarta.transaction.Transactional;
import jakarta.ws.rs.BeanParam;
import jakarta.ws.rs.POST;
import jakarta.ws.rs.Path;
import jakarta.ws.rs.core.Response;
import jakarta.ws.rs.core.Response.Status;

import org.jboss.resteasy.reactive.RestForm;

import io.quarkus.security.webauthn.WebAuthnCredentialRecord;
import io.quarkus.security.webauthn.WebAuthnLoginResponse;
import io.quarkus.security.webauthn.WebAuthnRegisterResponse;
import io.quarkus.security.webauthn.WebAuthnSecurity;
import io.vertx.ext.web.RoutingContext;

@Path("")
public class LoginResource {

    @Inject
    WebAuthnSecurity webAuthnSecurity;

    // Provide an alternative implementation of the /q/webauthn/login endpoint
    @Path("/login")
    @POST
    @Transactional
    public Response login(@BeanParam WebAuthnLoginResponse webAuthnResponse,
                          RoutingContext ctx) {
        // Input validation
        if(!webAuthnResponse.isSet() || !webAuthnResponse.isValid()) {
            return Response.status(Status.BAD_REQUEST).build();
        }

        try {
            WebAuthnCredentialRecord credentialRecord = this.webAuthnSecurity.login(webAuthnResponse, ctx).await().indefinitely();
            User user = User.findByUsername(credentialRecord.getUsername());
            if(user == null) {
                // Invalid user
                return Response.status(Status.BAD_REQUEST).build();
            }
            // bump the auth counter
            user.webAuthnCredential.counter = credentialRecord.getCounter();
            // make a login cookie
            this.webAuthnSecurity.rememberUser(credentialRecord.getUsername(), ctx);
            return Response.ok().build();
        } catch (Exception exception) {
            // handle login failure - make a proper error response
            return Response.status(Status.BAD_REQUEST).build();
        }
    }

    // Provide an alternative implementation of the /q/webauthn/register endpoint
    @Path("/register")
    @POST
    @Transactional
    public Response register(@RestForm String username,
                             @BeanParam WebAuthnRegisterResponse webAuthnResponse,
                             RoutingContext ctx) {
        // Input validation
        if(username == null || username.isEmpty()
           || !webAuthnResponse.isSet() || !webAuthnResponse.isValid()) {
            return Response.status(Status.BAD_REQUEST).build();
        }

        User user = User.findByUsername(username);
        if(user != null) {
            // Duplicate user
            return Response.status(Status.BAD_REQUEST).build();
        }
        try {
            // store the user
            WebAuthnCredentialRecord credentialRecord =
                webAuthnSecurity.register(username, webAuthnResponse, ctx).await().indefinitely();
            User newUser = new User();
            newUser.username = credentialRecord.getUsername();
            WebAuthnCredential credential =
                new WebAuthnCredential(credentialRecord, newUser);
            credential.persist();
            newUser.persist();
            // make a login cookie
            this.webAuthnSecurity.rememberUser(newUser.username, ctx);
            return Response.ok().build();
        } catch (Exception ignored) {
            // handle login failure
            // make a proper error response
            return Response.status(Status.BAD_REQUEST).build();
        }
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnSecurity.html"><code>WebAuthnSecurity</code></a> メソッドは、
<a href="#configuration-reference">session cookie</a> の設定や読み取りを行わないため、それは自身で管理する必要がありますが、
JWT など他の方法を使用してユーザーを保存できます。ログイン Cookie を手動で設定したい場合は、
同じ <a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnSecurity.html"><code>WebAuthnSecurity</code></a> クラスの
 <a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnSecurity.html#rememberUser(java.lang.String,io.vertx.ext.web.RoutingContext)"><code>WebAuthnSecurity.rememberUser</code></a> および <a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnSecurity.html#logout(io.vertx.ext.web.RoutingContext)"><code>WebAuthnSecurity.logout</code></a> 
メソッドを使用できます。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="blocking-version"><a class="anchor" href="#blocking-version"></a>ブロッキング版</h2>
<div class="sectionbody">
<div class="paragraph">
<p>データベースへのブロッキングデータアクセスを使用している場合、
<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnSecurity.html"><code>WebAuthnSecurity</code></a> メソッドは、
<code>.await().indefinitely()</code> で安全にブロックできます。なぜなら、 <code>register</code> および <code>login</code> メソッドでは、<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnUserProvider.html"><code>WebAuthnUserProvider</code></a> を介した
データアクセス以外は非同期処理が行われないからです。</p>
</div>
<div class="paragraph">
<p>Quarkus WebAuthn エンドポイントがその呼び出しをワーカープールに委任するには、<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnUserProvider.html"><code>WebAuthnUserProvider</code></a> クラス
に <code>@Blocking</code> アノテーションを追加する必要があります。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="virtual-threads-version"><a class="anchor" href="#virtual-threads-version"></a>仮想スレッドバージョン</h2>
<div class="sectionbody">
<div class="paragraph">
<p>データベースへのブロッキングデータアクセスを使用している場合、
<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnSecurity.html"><code>WebAuthnSecurity</code></a> メソッドは、
<code>.await().indefinitely()</code> で安全にブロックできます。なぜなら、 <code>register</code> および <code>login</code> メソッドでは、<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnUserProvider.html"><code>WebAuthnUserProvider</code></a> を介した
データアクセス以外は非同期処理が行われないからです。</p>
</div>
<div class="paragraph">
<p>Quarkus WebAuthn エンドポイントがその呼び出しをワーカープールに委任するには、<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnUserProvider.html"><code>WebAuthnUserProvider</code></a> クラス
に <code>@RunOnVirtualThread</code> アノテーションを追加する必要があります。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing-webauthn"><a class="anchor" href="#testing-webauthn"></a>WebAuthnのテスト</h2>
<div class="sectionbody">
<div class="paragraph">
<p>通常、ハードウェアトークンが必要なため、WebAuthn のテストは複雑です。そのため、私たちは <code>quarkus-test-security-webauthn</code> というヘルパーライブラリを作りました。</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-test-security-webauthn&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">testImplementation("io.quarkus:quarkus-test-security-webauthn")</code></pre>
</div>
</div>
<div class="paragraph">
<p>これにより、<a href="https://javadoc.io/doc/io.quarkus/quarkus-test-security-webauthn/3.20.5/io/quarkus/test/security/webauthn/WebAuthnHardware.html"><code>WebAuthnHardware</code></a> を使用して、
認証トークンをエミュレートしたり、
<a href="https://javadoc.io/doc/io.quarkus/quarkus-test-security-webauthn/3.20.5/io/quarkus/test/security/webauthn/WebAuthnEndpointHelper.html"><code>WebAuthnEndpointHelper</code></a> ヘルパーメソッドを
使用して WebAuthn エンドポイントを呼び出したり、カスタムエンドポイント用に
フォームデータを埋めることができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.webauthn.test;

import static io.restassured.RestAssured.given;

import java.net.URL;
import java.util.function.Consumer;

import org.hamcrest.Matchers;
import org.junit.jupiter.api.Test;

import io.quarkus.test.common.http.TestHTTPResource;
import io.quarkus.test.junit.QuarkusTest;
import io.quarkus.test.security.webauthn.WebAuthnEndpointHelper;
import io.quarkus.test.security.webauthn.WebAuthnHardware;
import io.restassured.RestAssured;
import io.restassured.filter.Filter;
import io.restassured.filter.cookie.CookieFilter;
import io.restassured.specification.RequestSpecification;
import io.vertx.core.json.JsonObject;

@QuarkusTest
public class WebAuthnResourceTest {

    enum User {
        USER, ADMIN;
    }
    enum Endpoint {
        DEFAULT, MANUAL;
    }

    @TestHTTPResource
    URL url;

    @Test
    public void testWebAuthnUser() {
        testWebAuthn("FroMage", User.USER, Endpoint.DEFAULT);
        testWebAuthn("scooby", User.USER, Endpoint.MANUAL);
    }

    @Test
    public void testWebAuthnAdmin() {
        testWebAuthn("admin", User.ADMIN, Endpoint.DEFAULT);
    }

    private void testWebAuthn(String username, User user, Endpoint endpoint) {
        Filter cookieFilter = new CookieFilter();
        WebAuthnHardware token = new WebAuthnHardware(url);

        verifyLoggedOut(cookieFilter);

        // two-step registration
        String challenge = WebAuthnEndpointHelper.obtainRegistrationChallenge(username, cookieFilter);
        JsonObject registrationJson = token.makeRegistrationJson(challenge);
        if(endpoint == Endpoint.DEFAULT)
            WebAuthnEndpointHelper.invokeRegistration(username, registrationJson, cookieFilter);
        else {
            invokeCustomEndpoint("/register", cookieFilter, request -&gt; {
                WebAuthnEndpointHelper.addWebAuthnRegistrationFormParameters(request, registrationJson);
                request.formParam("username", username);
            });
        }

        // verify that we can access logged-in endpoints
        verifyLoggedIn(cookieFilter, username, user);

        // logout
        WebAuthnEndpointHelper.invokeLogout(cookieFilter);

        verifyLoggedOut(cookieFilter);

        // two-step login
        challenge = WebAuthnEndpointHelper.obtainLoginChallenge(null, cookieFilter);
        JsonObject loginJson = token.makeLoginJson(challenge);
        if(endpoint == Endpoint.DEFAULT)
            WebAuthnEndpointHelper.invokeLogin(loginJson, cookieFilter);
        else {
            invokeCustomEndpoint("/login", cookieFilter, request -&gt; {
                WebAuthnEndpointHelper.addWebAuthnLoginFormParameters(request, loginJson);
            });
        }

        // verify that we can access logged-in endpoints
        verifyLoggedIn(cookieFilter, username, user);

        // logout
        WebAuthnEndpointHelper.invokeLogout(cookieFilter);

        verifyLoggedOut(cookieFilter);
    }

    private void invokeCustomEndpoint(String uri, Filter cookieFilter, Consumer&lt;RequestSpecification&gt; requestCustomiser) {
        RequestSpecification request = given()
        .when();
        requestCustomiser.accept(request);
        request
        .filter(cookieFilter)
        .redirects().follow(false)
        .log().ifValidationFails()
        .post(uri)
        .then()
        .statusCode(200)
        .log().ifValidationFails()
        .cookie(WebAuthnEndpointHelper.getChallengeCookie(), Matchers.is(""))
        .cookie(WebAuthnEndpointHelper.getMainCookie(), Matchers.notNullValue());
    }

    private void verifyLoggedIn(Filter cookieFilter, String username, User user) {
        // public API still good
        RestAssured.given().filter(cookieFilter)
        .when()
        .get("/api/public")
        .then()
        .statusCode(200)
        .body(Matchers.is("public"));
        // public API user name
        RestAssured.given().filter(cookieFilter)
        .when()
        .get("/api/public/me")
        .then()
        .statusCode(200)
        .body(Matchers.is(username));

        // user API accessible
        RestAssured.given().filter(cookieFilter)
        .when()
        .get("/api/users/me")
        .then()
        .statusCode(200)
        .body(Matchers.is(username));

        // admin API?
        if(user == User.ADMIN) {
            RestAssured.given().filter(cookieFilter)
            .when()
            .get("/api/admin")
            .then()
            .statusCode(200)
            .body(Matchers.is("admin"));
        } else {
            RestAssured.given().filter(cookieFilter)
            .when()
            .get("/api/admin")
            .then()
            .statusCode(403);
        }
    }

    private void verifyLoggedOut(Filter cookieFilter) {
        // public API still good
        RestAssured.given().filter(cookieFilter)
        .when()
        .get("/api/public")
        .then()
        .statusCode(200)
        .body(Matchers.is("public"));
        // public API user name
        RestAssured.given().filter(cookieFilter)
        .when()
        .get("/api/public/me")
        .then()
        .statusCode(200)
        .body(Matchers.is("&lt;not logged in&gt;"));

        // user API not accessible
        RestAssured.given()
        .filter(cookieFilter)
        .redirects().follow(false)
        .when()
        .get("/api/users/me")
        .then()
        .statusCode(302)
        .header("Location", Matchers.is("http://localhost:8081/"));

        // admin API not accessible
        RestAssured.given()
        .filter(cookieFilter)
        .redirects().follow(false)
        .when()
        .get("/api/admin")
        .then()
        .statusCode(302)
        .header("Location", Matchers.is("http://localhost:8081/"));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>このテストでは、提供されたコールバックエンドポイント (<a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnUserProvider.html"><code>WebAuthnUserProvider</code></a> 内でユーザーを更新) と、
ユーザーを手動で処理する手動の <code>LoginResource</code> エンドポイントの両方をテストするため、
<code>scooby</code> ユーザーを更新しない <a href="https://javadoc.io/doc/io.quarkus/quarkus-security-webauthn/3.20.5/io/quarkus/security/webauthn/WebAuthnUserProvider.html"><code>WebAuthnUserProvider</code></a> に
オーバーライドする必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.security.webauthn.test;

import org.acme.security.webauthn.MyWebAuthnSetup;
import org.acme.security.webauthn.WebAuthnCredential;

import io.quarkus.security.webauthn.WebAuthnCredentialRecord;
import io.quarkus.test.Mock;
import io.smallrye.mutiny.Uni;
import jakarta.enterprise.context.ApplicationScoped;
import jakarta.transaction.Transactional;

@Mock
@ApplicationScoped
public class TestUserProvider extends MyWebAuthnSetup {
    @Transactional
    @Override
    public Uni&lt;Void&gt; store(WebAuthnCredentialRecord credentialRecord) {
        // this user is handled in the LoginResource endpoint manually
        if (credentialRecord.getUsername().equals("scooby")) {
            return Uni.createFrom().voidItem();
        }
        return super.store(credentialRecord);
    }

    @Transactional
    @Override
    public Uni&lt;Void&gt; update(String credentialId, long counter) {
        WebAuthnCredential credential = WebAuthnCredential.findByCredentialId(credentialId);
        // this user is handled in the LoginResource endpoint manually
        if (credential.user.username.equals("scooby")) {
        	return Uni.createFrom().voidItem();
        }
        return super.update(credentialId, counter);
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration-reference"><a class="anchor" href="#configuration-reference"></a>設定リファレンス</h2>
<div class="sectionbody">
<div class="paragraph">
<p>セキュリティー暗号鍵は、<a href="security-authentication-mechanisms#form-auth">セキュリティーガイド</a> で
説明されているように、<a href="all-config#quarkus-vertx-http_quarkus.http.auth.session.encryption-key"><code>quarkus.http.auth.session.encryption-key</code></a> 設定オプションで
設定できます。</p>
</div>
<div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="ビルド時に固定"></i></span>ビルド時に固定される設定プロパティ - 他のすべての設定プロパティは実行時にオーバーライド可能 <input type="search" id="config-search-0" placeholder="FILTER CONFIGURATION" disabled></p>
</div>
<table class="tableblock frame-all grid-all stretch configuration-reference searchable configuration-reference-all-rows">
<colgroup>
<col style="width: 80%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><span class="header-title">Configuration property</span></p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">タイプ</p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">デフォルト</p></th>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-security-webauthn_quarkus-webauthn-enabled"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-enabled"><code>quarkus.webauthn.enabled</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.enabled' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-1" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>If the WebAuthn extension is enabled.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48022">QUARKUS_WEBAUTHN_ENABLED</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48022" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-origins"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-origins"><code>quarkus.webauthn.origins</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.origins' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-2" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The origins of the application. The origin is basically protocol, host and port. If you are calling WebAuthn API while your application is located at <code><a href="https://example.com/login" class="bare">https://example.com/login</a></code>, then origin will be <code><a href="https://example.com" class="bare">https://example.com</a></code>. If you are calling from <code><a href="http://localhost:2823/test" class="bare">http://localhost:2823/test</a></code>, then the origin will be <code><a href="http://localhost:2823" class="bare">http://localhost:2823</a></code>. Please note that WebAuthn API will not work on pages loaded over HTTP, unless it is localhost, which is considered secure context. If unspecified, this defaults to whatever URI this application is deployed on. This allows more than one value if you want to allow multiple origins. See <a href="https://w3c.github.io/webauthn/#sctn-related-origins" class="bare">https://w3c.github.io/webauthn/#sctn-related-origins</a></p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48023">QUARKUS_WEBAUTHN_ORIGINS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48023" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">list of string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>The URI this application is deployed on</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-transports"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-transports"><code>quarkus.webauthn.transports</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.transports' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-3" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Authenticator Transports allowed by the application. Authenticators can interact with the user web browser through several transports. Applications may want to restrict the transport protocols for extra security hardening reasons. By default, all transports should be allowed. If your application is to be used by mobile phone users, you may want to restrict only the <code>INTERNAL</code> authenticator to be allowed. Permitted values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>USB</code> - USB connected authenticators (e.g.: Yubikey&#8217;s)</p>
</li>
<li>
<p><code>NFC</code> - NFC connected authenticators (e.g.: Yubikey&#8217;s)</p>
</li>
<li>
<p><code>BLE</code> - Bluetooth LE connected authenticators</p>
</li>
<li>
<p><code>INTERNAL</code> - Hardware security chips (e.g.: Intel TPM2.0)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48024">QUARKUS_WEBAUTHN_TRANSPORTS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48024" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p>list of <code>usb</code>, <code>nfc</code>, <code>ble</code>, <code>hybrid</code>, <code>internal</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>USB,NFC,BLE,INTERNAL</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-relying-party-id"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-relying-party-id"><code>quarkus.webauthn.relying-party.id</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.relying-party.id' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-4" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The id (or domain name of your server, as obtained from the first entry of <code>origins</code> or looking at where this request is being served from)</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48025">QUARKUS_WEBAUTHN_RELYING_PARTY_ID</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48025" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>The host name of the first allowed origin, or the host where this application is deployed</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-relying-party-name"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-relying-party-name"><code>quarkus.webauthn.relying-party.name</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.relying-party.name' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-5" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>A user friendly name for your server</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48026">QUARKUS_WEBAUTHN_RELYING_PARTY_NAME</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48026" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>Quarkus server</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-authenticator-attachment"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-authenticator-attachment"><code>quarkus.webauthn.authenticator-attachment</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.authenticator-attachment' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-6" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Kind of Authenticator Attachment allowed. Authenticators can connect to your device in two forms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PLATFORM</code> - The Authenticator is built-in to your device (e.g.: Security chip)</p>
</li>
<li>
<p><code>CROSS_PLATFORM</code> - The Authenticator can roam across devices (e.g.: USB Authenticator)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For security reasons your application may choose to restrict to a specific attachment mode. If omitted, then any mode is permitted.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48027">QUARKUS_WEBAUTHN_AUTHENTICATOR_ATTACHMENT</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48027" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>platform</code>, <code>cross-platform</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-load-metadata"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-load-metadata"><code>quarkus.webauthn.load-metadata</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.load-metadata' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-7" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Load the FIDO metadata for verification. See <a href="https://fidoalliance.org/metadata/" class="bare">https://fidoalliance.org/metadata/</a>. Only useful for attestations different from <code>Attestation.NONE</code>.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48028">QUARKUS_WEBAUTHN_LOAD_METADATA</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48028" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-resident-key"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-resident-key"><code>quarkus.webauthn.resident-key</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.resident-key' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-8" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Resident key required. A resident (private) key, is a key that cannot leave your authenticator device, this means that you cannot reuse the authenticator to log into a second computer.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48029">QUARKUS_WEBAUTHN_RESIDENT_KEY</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48029" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>discouraged</code>, <code>preferred</code>, <code>required</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>REQUIRED</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-user-verification"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-user-verification"><code>quarkus.webauthn.user-verification</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.user-verification' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-9" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>User Verification requirements. Webauthn applications may choose <code>REQUIRED</code> verification to assert that the user is present during the authentication ceremonies, but in some cases, applications may want to reduce the interactions with the user, i.e.: prevent the use of pop-ups. Valid values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>REQUIRED</code> - User must always interact with the browser</p>
</li>
<li>
<p><code>PREFERRED</code> - User should always interact with the browser</p>
</li>
<li>
<p><code>DISCOURAGED</code> - User should avoid interact with the browser</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48030">QUARKUS_WEBAUTHN_USER_VERIFICATION</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48030" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>required</code>, <code>preferred</code>, <code>discouraged</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>REQUIRED</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-user-presence-required"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-user-presence-required"><code>quarkus.webauthn.user-presence-required</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.user-presence-required' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-10" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>User presence requirements.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48031">QUARKUS_WEBAUTHN_USER_PRESENCE_REQUIRED</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48031" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>true</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-timeout"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-timeout"><code>quarkus.webauthn.timeout</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.timeout' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-11" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Non-negative User Verification timeout. Authentication must occur within the timeout, this will prevent the user browser from being blocked with a pop-up required user verification, and the whole ceremony must be completed within the timeout period. After the timeout, any previously issued challenge is automatically invalidated.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48032">QUARKUS_WEBAUTHN_TIMEOUT</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48032" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/Duration.html">Duration</a> <a href="#duration-note-anchor-quarkus-security-webauthn_quarkus-webauthn"><span class="icon"><i class="fa fa-question-circle" title="More information about the Duration format"></i></span></a></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>5m</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-attestation"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-attestation"><code>quarkus.webauthn.attestation</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.attestation' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-12" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Device Attestation Preference. During registration, applications may want to attest the device. Attestation is a cryptographic verification of the authenticator hardware. Attestation implies that the privacy of the users may be exposed and browsers might override the desired configuration on the user&#8217;s behalf. Valid values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NONE</code> - no attestation data is sent with registration</p>
</li>
<li>
<p><code>INDIRECT</code> - attestation data is sent with registration, yielding anonymized data by a trusted CA</p>
</li>
<li>
<p><code>DIRECT</code> - attestation data is sent with registration</p>
</li>
<li>
<p><code>ENTERPRISE</code> - no attestation data is sent with registration. The device AAGUID is returned unaltered.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48033">QUARKUS_WEBAUTHN_ATTESTATION</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48033" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>none</code>, <code>indirect</code>, <code>direct</code>, <code>enterprise</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>NONE</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-public-key-credential-parameters"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-public-key-credential-parameters"><code>quarkus.webauthn.public-key-credential-parameters</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.public-key-credential-parameters' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-13" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Allowed Public Key Credential algorithms by preference order. Webauthn mandates that all authenticators must support at least the following 2 algorithms: <code>ES256</code> and <code>RS256</code>. Applications may require stronger keys and algorithms, for example: <code>ES512</code> or <code>EdDSA</code>. Note that the use of stronger algorithms, e.g.: <code>EdDSA</code> may require Java 15 or a cryptographic <code>JCE</code> provider that implements the algorithms. See <a href="https://www.w3.org/TR/webauthn-1/#dictdef-publickeycredentialparameters" class="bare">https://www.w3.org/TR/webauthn-1/#dictdef-publickeycredentialparameters</a></p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48034">QUARKUS_WEBAUTHN_PUBLIC_KEY_CREDENTIAL_PARAMETERS</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48034" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p>list of <code>es256</code>, <code>es384</code>, <code>es512</code>, <code>ps256</code>, <code>ps384</code>, <code>ps512</code>, <code>es256k</code>, <code>rs256</code>, <code>rs384</code>, <code>rs512</code>, <code>rs1</code>, <code>ed-dsa</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>ES256,RS256</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-challenge-length"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-challenge-length"><code>quarkus.webauthn.challenge-length</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.challenge-length' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-14" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Length of the challenges exchanged between the application and the browser. Challenges must be at least 32 bytes.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48035">QUARKUS_WEBAUTHN_CHALLENGE_LENGTH</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48035" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>64</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-login-page"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-login-page"><code>quarkus.webauthn.login-page</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.login-page' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-15" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The login page</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48036">QUARKUS_WEBAUTHN_LOGIN_PAGE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48036" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>/login.html</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-session-timeout"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-session-timeout"><code>quarkus.webauthn.session-timeout</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.session-timeout' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-16" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The inactivity (idle) timeout When inactivity timeout is reached, cookie is not renewed and a new login is enforced.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48037">QUARKUS_WEBAUTHN_SESSION_TIMEOUT</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48037" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/Duration.html">Duration</a> <a href="#duration-note-anchor-quarkus-security-webauthn_quarkus-webauthn"><span class="icon"><i class="fa fa-question-circle" title="More information about the Duration format"></i></span></a></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>PT30M</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-new-cookie-interval"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-new-cookie-interval"><code>quarkus.webauthn.new-cookie-interval</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.new-cookie-interval' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-17" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>How old a cookie can get before it will be replaced with a new cookie with an updated timeout, also referred to as "renewal-timeout". Note that smaller values will result in slightly more server load (as new encrypted cookies will be generated more often); however, larger values affect the inactivity timeout because the timeout is set when a cookie is generated. For example if this is set to 10 minutes, and the inactivity timeout is 30m, if a user&#8217;s last request is when the cookie is 9m old then the actual timeout will happen 21m after the last request because the timeout is only refreshed when a new cookie is generated. That is, no timeout is tracked on the server side; the timestamp is encoded and encrypted in the cookie itself, and it is decrypted and parsed with each request.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48038">QUARKUS_WEBAUTHN_NEW_COOKIE_INTERVAL</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48038" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/Duration.html">Duration</a> <a href="#duration-note-anchor-quarkus-security-webauthn_quarkus-webauthn"><span class="icon"><i class="fa fa-question-circle" title="More information about the Duration format"></i></span></a></p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>PT1M</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-cookie-name"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-cookie-name"><code>quarkus.webauthn.cookie-name</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.cookie-name' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-18" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The cookie that is used to store the persistent session</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48039">QUARKUS_WEBAUTHN_COOKIE_NAME</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48039" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>quarkus-credential</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-challenge-cookie-name"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-challenge-cookie-name"><code>quarkus.webauthn.challenge-cookie-name</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.challenge-cookie-name' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-19" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The cookie that is used to store the challenge data during login/registration</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48040">QUARKUS_WEBAUTHN_CHALLENGE_COOKIE_NAME</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48040" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>_quarkus_webauthn_challenge</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-cookie-same-site"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-cookie-same-site"><code>quarkus.webauthn.cookie-same-site</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.cookie-same-site' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-20" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>SameSite attribute for the session cookie.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48041">QUARKUS_WEBAUTHN_COOKIE_SAME_SITE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48041" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><div class="content"><div class="paragraph">
<p><code>strict</code>, <code>lax</code>, <code>none</code></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>strict</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-cookie-path"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-cookie-path"><code>quarkus.webauthn.cookie-path</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.cookie-path' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-21" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>The cookie path for the session cookies.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48042">QUARKUS_WEBAUTHN_COOKIE_PATH</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48042" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">string</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>/</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-cookie-max-age"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-cookie-max-age"><code>quarkus.webauthn.cookie-max-age</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.cookie-max-age' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-22" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Max-Age attribute for the session cookie. This is the amount of time the browser will keep the cookie. The default value is empty, which means the cookie will be kept until the browser is closed.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48043">QUARKUS_WEBAUTHN_COOKIE_MAX_AGE</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48043" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/Duration.html">Duration</a> <a href="#duration-note-anchor-quarkus-security-webauthn_quarkus-webauthn"><span class="icon"><i class="fa fa-question-circle" title="More information about the Duration format"></i></span></a></p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc odd">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-enable-registration-endpoint"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-enable-registration-endpoint"><code>quarkus.webauthn.enable-registration-endpoint</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.enable-registration-endpoint' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-23" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Set to <code>true</code> if you want to enable the default registration endpoint at <code>/q/webauthn/register</code>, in which case you should also implement the <code>WebAuthnUserProvider.store</code> method.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48044">QUARKUS_WEBAUTHN_ENABLE_REGISTRATION_ENDPOINT</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48044" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
<tr class="row-collapsible row-collapsed row-with-desc">
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a id="quarkus-security-webauthn_quarkus-webauthn-enable-login-endpoint"></a> <span class="property-path"><a href="#quarkus-security-webauthn_quarkus-webauthn-enable-login-endpoint"><code>quarkus.webauthn.enable-login-endpoint</code></a></span>
<button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-text='quarkus.webauthn.enable-login-endpoint' title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
<div id="conf-collapsible-desc-24" class="openblock description description-collapsed">
<div class="content">
<div class="paragraph">
<p>Set to <code>true</code> if you want to enable the default login endpoint at <code>/q/webauthn/login</code>, in which case you should also implement the <code>WebAuthnUserProvider.update</code> method.</p>
</div>
<div class="paragraph">
<p>Environment variable: <code id="env-var-48045">QUARKUS_WEBAUTHN_ENABLE_LOGIN_ENDPOINT</code><button class="btn-copy fa fa-clipboard inline-btn-copy" data-clipboard-action="copy" data-clipboard-target="#env-var-48045" title="Copy to clipboard" do-not-collapse="true"></button></p>
</div>
</div>
</div>
<div class="paragraph description-decoration">
<p><i class="fa fa-chevron-down"></i><span>Show more</span></p>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
</tbody>
</table>
<div id="duration-note-anchor-quarkus-security-webauthn_quarkus-webauthn" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">期間フォーマットについて</div>
<div class="paragraph">
<p>期間の値を書くには、標準の <code>java.time.Duration</code> フォーマットを使います。
詳細は <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/time/Duration.html#parse(java.lang.CharSequence)">Duration#parse() Java API documentation</a> を参照してください。</p>
</div>
<div class="paragraph">
<p>数字で始まる簡略化した書式を使うこともできます:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>数値のみの場合は、秒単位の時間を表します。</p>
</li>
<li>
<p>数値の後に <code>ms</code> が続く場合は、ミリ秒単位の時間を表します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>その他の場合は、簡略化されたフォーマットが解析のために <code>java.time.Duration</code> フォーマットに変換されます：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>数値の後に <code>h</code> 、 <code>m</code> 、 <code>s</code> が続く場合は、その前に <code>PT</code> が付けられます。</p>
</li>
<li>
<p>数値の後に <code>d</code> が続く場合は、その前に <code>P</code> が付けられます。</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="references"><a class="anchor" href="#references"></a>参照</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="security-overview">Quarkus Securityの概要</a></p>
</li>
</ul>
</div>
</div>
</div>
    </div>
    <div class="grid__item width-4-12 width-12-12-m tocwrapper">
      <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#prerequisites">前提条件</a></li>
<li><a href="#introduction-to-webauthn">WebAuthnの紹介</a></li>
<li><a href="#architecture">アーキテクチャ</a></li>
<li><a href="#solution">ソリューション</a></li>
<li><a href="#creating-the-maven-project">Mavenプロジェクトの作成</a></li>
<li><a href="#writing-the-application">アプリケーションの記述</a>
<ul class="sectlevel2">
<li><a href="#storing-our-webauthn-credentials">WebAuthnのクレデンシャルの保存</a></li>
<li><a href="#exposing-your-entities-to-quarkus-webauthn">Quarkus WebAuthnにエンティティを公開する</a></li>
</ul>
</li>
<li><a href="#configuration">設定</a></li>
<li><a href="#writing-the-html-application">HTMLアプリケーションの作成</a></li>
<li><a href="#trying-the-application">アプリケーションを試す</a></li>
<li><a href="#explanation-of-the-flow-for-webauthn-authentication">WebAuthn 認証のフローの説明</a></li>
<li><a href="#webauthn-endpoints">WebAuthnのエンドポイント</a>
<ul class="sectlevel2">
<li><a href="#obtain-a-registration-challenge">登録チャレンジの取得</a></li>
<li><a href="#trigger-a-registration">登録をトリガーする</a></li>
<li><a href="#obtain-a-login-challenge">ログインチャレンジの取得</a></li>
<li><a href="#trigger-a-login">ログインをトリガーする</a></li>
<li><a href="#logout">ログアウト</a></li>
<li><a href="#related-origins">Related Origins</a></li>
</ul>
</li>
<li><a href="#webauthn-javascript-library">WebAuthn JavaScript ライブラリ</a>
<ul class="sectlevel2">
<li><a href="#csrf-considerations">CSRF に関する考慮事項</a></li>
<li><a href="#invoke-registration">登録の呼出</a></li>
<li><a href="#invoke-login">ログインの呼出</a></li>
<li><a href="#only-invoke-the-registration-challenge-and-authenticator">登録チャレンジと認証デバイスのみを呼出</a></li>
<li><a href="#only-invoke-the-login-challenge-and-authenticator">ログインチャレンジと認証デバイスのみを呼出</a></li>
</ul>
</li>
<li><a href="#handling-login-and-registration-endpoints-yourself">ログインと登録のエンドポイントを自分でハンドリングする</a></li>
<li><a href="#blocking-version">ブロッキング版</a></li>
<li><a href="#virtual-threads-version">仮想スレッドバージョン</a></li>
<li><a href="#testing-webauthn">WebAuthnのテスト</a></li>
<li><a href="#configuration-reference">設定リファレンス</a></li>
<li><a href="#references">参照</a></li>
</ul></div>
    </div>
  </div>
  <h2>関連コンテンツ</h2>
  <div class="grid-wrapper relations">
    <div class="grid__item width-6-12 width-12-12-m">
      <h3>同じトピックについて</h3>
      <ul class="related-content">
      
        
        <li class="reference"><a href="/version/3.20/guides/security-authorize-web-endpoints-reference">ウェブエンドポイントの認可</a></li>
      
        
        <li class="tutorial"><a href="/version/3.20/guides/security-oidc-code-flow-authentication-tutorial">Quarkus - 認可コードフローのOpenID Connectを使用してWebアプリケーションを保護</a></li>
      
        
        <li class="guide"><a href="/version/3.20/guides/security-keycloak-admin-client">Keycloak Admin Clientの使用</a></li>
      
        
        <li class="howto"><a href="/version/3.20/guides/security-keycloak-authorization">OpenID Connect (OIDC)とKeycloakを使用した認可の一元化</a></li>
      
        
        <li class="concepts"><a href="/version/3.20/guides/security-authentication-mechanisms">Quarkusの認証メカニズム</a></li>
      
        
        <li class="concepts"><a href="/version/3.20/guides/security-basic-authentication">Basic認証</a></li>
      
        
        <li class="guide"><a href="/version/3.20/guides/security-jwt-build">JSON Web トークン (JWT) のビルド、署名、暗号化</a></li>
      
        
        <li class="concepts"><a href="/version/3.20/guides/security-openid-connect-providers">よく知られたOpenID Connect プロバイダーの設定</a></li>
      
        
        <li class="guide"><a href="/version/3.20/guides/security-csrf-prevention">クロスサイトリクエストフォージェリー対策</a></li>
      
        
        <li class="howto"><a href="/version/3.20/guides/security-openid-connect-dev-services">OpenID Connect (OIDC)のDev ServicesとDev UI</a></li>
      
        
        <li class="howto"><a href="/version/3.20/guides/security-basic-authentication-howto">ベーシック認証の有効化</a></li>
      
        
        <li class="tutorial"><a href="/version/3.20/guides/security-getting-started-tutorial">Basic認証とJakarta Persistenceを使用したセキュリティの入門</a></li>
      
        
        <li class="concepts"><a href="/version/3.20/guides/security-identity-providers">アイデンティティ・プロバイダー</a></li>
      
        
        <li class="reference"><a href="/version/3.20/guides/security-openid-connect-client-reference">OpenID Connect (OIDC) と OAuth2 クライアントおよびフィルター</a></li>
      
        
        <li class="reference"><a href="/version/3.20/guides/security-openid-connect-client-registration">OpenID Connect (OIDC) と OAuth2 の動的クライアント登録</a></li>
      
        
        <li class="concepts"><a href="/version/3.20/guides/security-oidc-bearer-token-authentication">OpenID Connect (OIDC) ベアラートークン認証</a></li>
      
        
        <li class="reference"><a href="/version/3.20/guides/security-oidc-configuration-properties-reference">OpenID Connect (OIDC) 設定プロパティ</a></li>
      
        
        <li class="concepts"><a href="/version/3.20/guides/security-oidc-code-flow-authentication">Web アプリケーションを保護するための OpenID Connect 認可コードフローメカニズム</a></li>
      
        
        <li class="tutorial"><a href="/version/3.20/guides/security-openid-connect-client">OpenID Connectクライアントとトークン伝搬クイックスタート</a></li>
      
        
        <li class="concepts"><a href="/version/3.20/guides/security-proactive-authentication">プロアクティブ認証</a></li>
      </ul>
    </div>
    </div>
  </div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus is open. All dependencies of this project are available under the <a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a> or compatible license. <i class='fab fa-creative-commons'></i><i class='fab fa-creative-commons-by'></i> <a href='https://creativecommons.org/licenses/by/3.0/' target='_blank'>CC by 3.0</a><br /><br />This website was built with <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a>, is hosted on <a href='https://pages.github.com/' target='_blank'>GitHub Pages</a> and is completely open source. If you want to make it better, <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>fork the website</a> and show us what you’ve got.</p>

    
      <div class="width-1-12 project-links">
        <span>ナビゲーション</span>
        <ul class="footer-links">
          
          
            <li><a href="/" target="_blank">ホーム</a></li>
          
          
          
            <li><a href="/about" target="_blank">Quarkusについて</a></li>
          
          
          
            <li><a href="/blog" target="_blank">ブログ</a></li>
          
          
          
            <li><a href="/insights" target="_blank">ポッドキャスト</a></li>
          
          
          
            <li><a href="/events" target="_blank">イベント</a></li>
          
          
          
            <li><a href="/newsletter" target="_blank">ニュースレター</a></li>
          
          
          
            <li><a href="/userstories" target="_blank">ユーザーストーリー</a></li>
          
          
          
            <li><a href="https://github.com/orgs/quarkusio/projects/13/views/1" target="_blank">ロードマップ</a></li>
          
          
          
            <li><a href="/security" target="_blank">セキュリティ&nbsp;ポリシー</a></li>
          
          
          
            <li><a href="/usage" target="_blank">使用方法</a></li>
          
          
          
            <li><a href="https://github.com/commonhaus/artwork/tree/main/projects/quarkus" target="_blank">Brand</a></li>
          
          
          
            <li><a href="/desktopwallpapers" target="_blank">Wallpapers</a></li>
          
          
          
            <li><a href="https://www.redhat.com/en/about/privacy-policy" target="_blank">Privacy Policy</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>フォローする</span>
        <ul class="footer-links">
          
          
            <li><a href="https://x.com/quarkusio" target="_blank">X</a></li>
          
          
          
            <li><a href="https://bsky.app/profile/quarkus.io" target="_blank">Bluesky</a></li>
          
          
          
            <li><a rel="me" href="https://fosstodon.org/@quarkusio" target="_blank">Mastodon</a></li>
            
          
          
            <li><a href="https://www.threads.com/@quarkusio" target="_blank">Threads</a></li>
          
          
          
            <li><a href="https://www.facebook.com/quarkusio" target="_blank">Facebook</a></li>
          
          
          
            <li><a href="https://www.linkedin.com/company/quarkusio/" target="_blank">Linkedin</a></li>
          
          
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg" target="_blank">Youtube</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio" target="_blank">GitHub</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>ヘルプ</span>
        <ul class="footer-links">
          
          
            <li><a href="/support" target="_blank">サポート</a></li>
          
          
          
            <li><a href="/guides" target="_blank">ガイド</a></li>
          
          
          
            <li><a href="/faq" target="_blank">FAQ</a></li>
          
          
          
            <li><a href="/get-started" target="_blank">入門</a></li>
          
          
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus" target="_blank">Stack Overflow</a></li>
          
          
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions" target="_blank">ディスカッション</a></li>
          
          
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev" target="_blank">開発メーリングリスト</a></li>
          
          
          
            <li><a href="https://stats.uptimerobot.com/ze1PfweT2p" target="_blank">Quarkus Service Status</a></li>
          
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>言語</span>
        <ul class="footer-links">
          
          
            <li><a href=" https://quarkus.io/ " target="_blank">English</a></li>
          
          
          
            <li><a href="https://pt.quarkus.io/" target="_blank">Português&nbsp;(Brasileiro)</a></li>
          
          
          
            <li><a href=" https://es.quarkus.io/ " target="_blank">Español</a></li>
          
          
          
            <li><a href="https://cn.quarkus.io/" target="_blank">简体中文</a></li>
          
          
          
            <li><a href=" https://ja.quarkus.io/ " target="_blank">日本語</a></li>
          
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkusはコミュニティプロジェクトで構成されています</span>
        <ul class="footer-links">
          
            <li><a blah href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a blah href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a blah href="https://hibernate.org" target="_blank">Hibernate ORM</a></li>
          
            <li><a blah href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a blah href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a blah href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a blah href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a blah href="https://code.quarkus.io/" target="_blank">その他多数...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content cf-footer">
  <div class="flexcontainer">
    <div class="cf-logo">
      <a class="cf-logo" href="https://www.commonhaus.org/" target="_blank"><img src="https://raw.githubusercontent.com/commonhaus/artwork/main/foundation/brand/svg/CF_logo_horizontal_single_reverse.svg"/></a>
    </div>
    <div class="license">
      Copyright © Quarkus. All rights reserved. For details on our trademarks, please visit our <a href="https://www.commonhaus.org/policies/trademark-policy/">Trademark Policy</a> and <a href="https://www.commonhaus.org/trademarks/">Trademark List</a>. Trademarks of third parties are owned by their respective holders and their mention here does not suggest any endorsement or association.
    </div>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
  <script src="/assets/javascript/future-date.js" type="text/javascript"></script>
  <script src="/assets/javascript/randomize.js" type="text/javascript"></script>
  <script src="/assets/javascript/time.js" type="text/javascript"></script>
</body>

</html>
